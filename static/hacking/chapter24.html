<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 2 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:2 4 5 3 5 2 3 3 2 2;}
@font-face
	{font-family:Latha;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Raavi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Shruti;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tunga;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:3 8 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Another Typewriter";}
@font-face
	{font-family:MonospaceTypewriter;}
@font-face
	{font-family:"MS Shell Dlg 2";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Rounded MT Bold";
	panose-1:2 15 7 4 3 5 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:"Adobe Caslon Pro Bold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Caslon Pro";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Fangsong Std R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Adobe Fangsong Std R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Fan Heiti Std B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Adobe Fan Heiti Std B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Gothic Std B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Adobe Gothic Std B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Heiti Std R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Adobe Heiti Std R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Kaiti Std R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Adobe Kaiti Std R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Naskh Medium";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Garamond Pro Bold";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Garamond Pro";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Birch Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Blackoak Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Brush Script Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Chaparral Pro";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Chaparral Pro Light";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Charlemagne Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cooper Std Black";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Giddyup Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Hobo Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pro B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pro B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pro EL";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pro EL";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pro H";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pro H";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pro L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pro L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pro M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pro M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pro R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pro R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pro B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pro B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pro EL";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pro EL";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pro H";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pro H";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pro L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pro L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pro M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pro M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pro R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pro R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Lithos Pro Regular";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Mesquite Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Minion Pro Cond";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Minion Pro Med";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Minion Pro SmBd";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Myriad Arabic";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Nueva Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Nueva Std Cond";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"OCR A Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Orator Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Poplar Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Prestige Elite Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Rosewood Std Regular";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Stencil Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Tekton Pro";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Tekton Pro Cond";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Tekton Pro Ext";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Trajan Pro";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Arabic";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Devanagari";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Hebrew";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Ming Std L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Adobe Ming Std L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Myungjo Std M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Adobe Myungjo Std M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Adobe Song Std L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Adobe Song Std L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pr6N B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pr6N B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pr6N EL";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pr6N EL";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pr6N H";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pr6N H";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pr6N L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pr6N L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pr6N M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pr6N M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Gothic Pr6N R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Gothic Pr6N R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pr6N B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pr6N B";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pr6N EL";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pr6N EL";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pr6N H";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pr6N H";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pr6N L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pr6N L";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pr6N M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pr6N M";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Kozuka Mincho Pr6N R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Kozuka Mincho Pr6N R";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Letter Gothic Std";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Minion Pro";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Myriad Hebrew";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Myriad Pro";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Myriad Pro Cond";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Myriad Pro Light";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Tattoo Shop";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:TeamViewer10;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Biko;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Bebas Neue";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Gandhi Sans";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Marlett;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Batang";
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:BatangChe;
	panose-1:2 3 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:"\@BatangChe";
	panose-1:2 3 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Gungsuh;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:"\@Gungsuh";
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:GungsuhChe;
	panose-1:2 3 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:"\@GungsuhChe";
	panose-1:2 3 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:DaunPenh;
	panose-1:1 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:DokChampa;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Euphemia;
	panose-1:2 11 5 3 4 1 2 2 1 4;}
@font-face
	{font-family:Vani;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Gulim";
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:GulimChe;
	panose-1:2 11 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:"\@GulimChe";
	panose-1:2 11 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:"\@Dotum";
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:DotumChe;
	panose-1:2 11 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:"\@DotumChe";
	panose-1:2 11 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;}
@font-face
	{font-family:"Iskoola Pota";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Kalinga;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Kartika;
	panose-1:2 2 5 3 3 4 4 6 2 3;}
@font-face
	{font-family:"Khmer UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Lao UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:"\@Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:Meiryo;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Meiryo";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Meiryo UI";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Meiryo UI";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Microsoft Himalaya";
	panose-1:1 1 1 0 1 1 1 1 1 1;}
@font-face
	{font-family:"Microsoft JhengHei";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Microsoft YaHei";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@Microsoft YaHei";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@MingLiU";
	panose-1:2 2 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:"\@PMingLiU";
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:MingLiU_HKSCS;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU_HKSCS";
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:MingLiU-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU-ExtB";
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:PMingLiU-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@PMingLiU-ExtB";
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:MingLiU_HKSCS-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU_HKSCS-ExtB";
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Mongolian Baiti";
	panose-1:3 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:"MS PGothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:"\@MS PGothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:"MS UI Gothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:"\@MS UI Gothic";
	panose-1:2 11 6 0 7 2 5 8 2 4;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:"MS PMincho";
	panose-1:2 2 6 0 4 2 5 8 3 4;}
@font-face
	{font-family:"\@MS PMincho";
	panose-1:2 2 6 0 4 2 5 8 3 4;}
@font-face
	{font-family:"MV Boli";
	panose-1:2 0 5 0 3 2 0 9 0 0;}
@font-face
	{font-family:"Microsoft New Tai Lue";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Nyala;
	panose-1:2 0 5 4 7 3 0 2 0 3;}
@font-face
	{font-family:"Microsoft PhagsPa";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Plantagenet Cherokee";
	panose-1:2 2 6 2 7 1 0 0 0 0;}
@font-face
	{font-family:"Segoe Script";
	panose-1:2 11 5 4 2 0 0 0 0 3;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Semibold";
	panose-1:2 11 7 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Symbol";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:NSimSun;
	panose-1:2 1 6 9 3 1 1 1 1 1;}
@font-face
	{font-family:"\@NSimSun";
	panose-1:2 1 6 9 3 1 1 1 1 1;}
@font-face
	{font-family:SimSun-ExtB;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun-ExtB";
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"Microsoft Tai Le";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Shonar Bangla";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft Yi Baiti";
	panose-1:3 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Microsoft Sans Serif";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Aparajita;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Ebrima;
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gisha;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Kokila;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Leelawadee;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft Uighur";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:MoolBoran;
	panose-1:2 11 1 0 1 1 1 1 1 1;}
@font-face
	{font-family:Utsaah;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Vijaya;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Andalus;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Arabic Typesetting";
	panose-1:3 2 4 2 4 4 6 3 2 3;}
@font-face
	{font-family:"Simplified Arabic";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Simplified Arabic Fixed";
	panose-1:2 7 3 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Sakkal Majalla";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Traditional Arabic";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:Aharoni;
	panose-1:2 1 8 3 2 1 4 3 2 3;}
@font-face
	{font-family:David;
	panose-1:2 14 5 2 6 4 1 1 1 1;}
@font-face
	{font-family:FrankRuehl;
	panose-1:2 14 5 3 6 1 1 1 1 1;}
@font-face
	{font-family:"Levenim MT";
	panose-1:2 1 5 2 6 1 1 1 1 1;}
@font-face
	{font-family:Miriam;
	panose-1:2 11 5 2 5 1 1 1 1 1;}
@font-face
	{font-family:"Miriam Fixed";
	panose-1:2 11 5 9 5 1 1 1 1 1;}
@font-face
	{font-family:Narkisim;
	panose-1:2 14 5 2 5 1 1 1 1 1;}
@font-face
	{font-family:Rod;
	panose-1:2 3 5 9 5 1 1 1 1 1;}
@font-face
	{font-family:FangSong;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@FangSong";
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@SimHei";
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:KaiTi;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@KaiTi";
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:AngsanaUPC;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Browallia New";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:BrowalliaUPC;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:CordiaUPC;
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:DilleniaUPC;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:EucrosiaUPC;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:FreesiaUPC;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:IrisUPC;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:JasmineUPC;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:KodchiangUPC;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:LilyUPC;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:DFKai-SB;
	panose-1:3 0 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:"\@DFKai-SB";
	panose-1:3 0 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:"Lucida Sans Unicode";
	panose-1:2 11 6 2 3 5 4 2 2 4;}
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;}
@font-face
	{font-family:Candara;
	panose-1:2 14 5 2 3 3 3 2 2 4;}
@font-face
	{font-family:"Comic Sans MS";
	panose-1:3 15 7 2 3 3 2 2 2 4;}
@font-face
	{font-family:Constantia;
	panose-1:2 3 6 2 5 3 6 3 3 3;}
@font-face
	{font-family:Corbel;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Medium";
	panose-1:2 11 6 3 2 1 2 2 2 4;}
@font-face
	{font-family:Gabriola;
	panose-1:4 4 6 5 5 16 2 2 13 2;}
@font-face
	{font-family:Georgia;
	panose-1:2 4 5 2 5 4 5 2 3 3;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:"Segoe Print";
	panose-1:2 0 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Webdings;
	panose-1:5 3 1 2 1 5 9 6 7 3;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"AR BERKLEY";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR BLANCA";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR BONNIE";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR CARTER";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR CENA";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR CHRISTY";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR DARLING";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR DECODE";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR DELANEY";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR DESTINE";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR ESSENCE";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR HERMANN";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR JULIAN";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MT Extra";
	panose-1:5 5 1 2 1 2 5 2 2 2;}
@font-face
	{font-family:"\@Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Wingdings 2";
	panose-1:5 2 1 2 1 5 7 7 7 7;}
@font-face
	{font-family:"Wingdings 3";
	panose-1:5 4 1 2 1 8 7 7 7 7;}
@font-face
	{font-family:"Book Antiqua";
	panose-1:2 4 6 2 5 3 5 3 3 4;}
@font-face
	{font-family:"Century Gothic";
	panose-1:2 11 5 2 2 2 2 2 2 4;}
@font-face
	{font-family:Haettenschweiler;
	panose-1:2 11 7 6 4 9 2 6 2 4;}
@font-face
	{font-family:"MS Outlook";
	panose-1:5 1 1 0 1 0 0 0 0 0;}
@font-face
	{font-family:"Tempus Sans ITC";
	panose-1:4 2 4 4 3 13 7 2 2 2;}
@font-face
	{font-family:Pristina;
	panose-1:3 6 4 2 4 4 6 8 2 4;}
@font-face
	{font-family:Papyrus;
	panose-1:3 7 5 2 6 5 2 3 2 5;}
@font-face
	{font-family:Mistral;
	panose-1:3 9 7 2 3 4 7 2 4 3;}
@font-face
	{font-family:"Lucida Handwriting";
	panose-1:3 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"Kristen ITC";
	panose-1:3 5 5 2 4 2 2 3 2 2;}
@font-face
	{font-family:"Juice ITC";
	panose-1:4 4 4 3 4 10 2 2 2 2;}
@font-face
	{font-family:"French Script MT";
	panose-1:3 2 4 2 4 6 7 4 6 5;}
@font-face
	{font-family:"Freestyle Script";
	panose-1:3 8 4 2 3 2 5 11 4 4;}
@font-face
	{font-family:"Bradley Hand ITC";
	panose-1:3 7 4 2 5 3 2 3 2 3;}
@font-face
	{font-family:Garamond;
	panose-1:2 2 4 4 3 3 1 1 8 3;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;}
@font-face
	{font-family:Algerian;
	panose-1:4 2 7 5 4 10 2 6 7 2;}
@font-face
	{font-family:"Baskerville Old Face";
	panose-1:2 2 6 2 8 5 5 2 3 3;}
@font-face
	{font-family:"Bauhaus 93";
	panose-1:4 3 9 5 2 11 2 2 12 2;}
@font-face
	{font-family:"Bell MT";
	panose-1:2 2 5 3 6 3 5 2 3 3;}
@font-face
	{font-family:"Berlin Sans FB";
	panose-1:2 14 6 2 2 5 2 2 3 6;}
@font-face
	{font-family:"Bernard MT Condensed";
	panose-1:2 5 8 6 6 9 5 2 4 4;}
@font-face
	{font-family:"Bodoni MT Poster Compressed";
	panose-1:2 7 7 6 8 6 1 5 2 4;}
@font-face
	{font-family:"Britannic Bold";
	panose-1:2 11 9 3 6 7 3 2 2 4;}
@font-face
	{font-family:Broadway;
	panose-1:4 4 9 5 8 11 2 2 5 2;}
@font-face
	{font-family:"Brush Script MT";
	panose-1:3 6 8 2 4 4 6 7 3 4;}
@font-face
	{font-family:"Californian FB";
	panose-1:2 7 4 3 6 8 11 3 2 4;}
@font-face
	{font-family:Centaur;
	panose-1:2 3 5 4 5 2 5 2 3 4;}
@font-face
	{font-family:Chiller;
	panose-1:4 2 4 4 3 16 7 2 6 2;}
@font-face
	{font-family:"Colonna MT";
	panose-1:4 2 8 5 6 2 2 3 2 3;}
@font-face
	{font-family:"Cooper Black";
	panose-1:2 8 9 4 4 3 11 2 4 4;}
@font-face
	{font-family:"Footlight MT Light";
	panose-1:2 4 6 2 6 3 10 2 3 4;}
@font-face
	{font-family:"Harlow Solid Italic";
	panose-1:4 3 6 4 2 15 2 2 13 2;}
@font-face
	{font-family:Harrington;
	panose-1:4 4 5 5 5 10 2 2 7 2;}
@font-face
	{font-family:"High Tower Text";
	panose-1:2 4 5 2 5 5 6 3 3 3;}
@font-face
	{font-family:Jokerman;
	panose-1:4 9 6 5 6 13 6 2 7 2;}
@font-face
	{font-family:"Kunstler Script";
	panose-1:3 3 4 2 2 6 7 13 13 6;}
@font-face
	{font-family:"Lucida Bright";
	panose-1:2 4 6 2 5 5 5 2 3 4;}
@font-face
	{font-family:"Lucida Calligraphy";
	panose-1:3 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"Lucida Fax";
	panose-1:2 6 6 2 5 5 5 2 2 4;}
@font-face
	{font-family:Magneto;
	panose-1:4 3 8 5 5 8 2 2 13 2;}
@font-face
	{font-family:"Matura MT Script Capitals";
	panose-1:3 2 8 2 6 6 2 7 2 2;}
@font-face
	{font-family:"Modern No\. 20";
	panose-1:2 7 7 4 7 5 5 2 3 3;}
@font-face
	{font-family:"Niagara Engraved";
	panose-1:4 2 5 2 7 7 3 3 2 2;}
@font-face
	{font-family:"Niagara Solid";
	panose-1:4 2 5 2 7 7 2 2 2 2;}
@font-face
	{font-family:"Old English Text MT";
	panose-1:3 4 9 2 4 5 8 3 8 6;}
@font-face
	{font-family:Onyx;
	panose-1:4 5 6 2 8 7 2 2 2 3;}
@font-face
	{font-family:Parchment;
	panose-1:3 4 6 2 4 7 8 4 8 4;}
@font-face
	{font-family:Playbill;
	panose-1:4 5 6 3 10 6 2 2 2 2;}
@font-face
	{font-family:"Poor Richard";
	panose-1:2 8 5 2 5 5 5 2 7 2;}
@font-face
	{font-family:Ravie;
	panose-1:4 4 8 5 5 8 9 2 6 2;}
@font-face
	{font-family:"Informal Roman";
	panose-1:3 6 4 2 3 4 6 11 2 4;}
@font-face
	{font-family:"Showcard Gothic";
	panose-1:4 2 9 4 2 1 2 2 6 4;}
@font-face
	{font-family:"Snap ITC";
	panose-1:4 4 10 7 6 10 2 2 2 2;}
@font-face
	{font-family:Stencil;
	panose-1:4 4 9 5 13 8 2 2 4 4;}
@font-face
	{font-family:"Viner Hand ITC";
	panose-1:3 7 5 2 3 5 2 2 2 3;}
@font-face
	{font-family:Vivaldi;
	panose-1:3 2 6 2 5 5 6 9 8 4;}
@font-face
	{font-family:"Vladimir Script";
	panose-1:3 5 4 2 4 4 7 7 3 5;}
@font-face
	{font-family:"Wide Latin";
	panose-1:2 10 10 7 5 5 5 2 4 4;}
@font-face
	{font-family:"Tw Cen MT";
	panose-1:2 11 6 2 2 1 4 2 6 3;}
@font-face
	{font-family:"Tw Cen MT Condensed";
	panose-1:2 11 6 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Script MT Bold";
	panose-1:3 4 6 2 4 6 7 8 9 4;}
@font-face
	{font-family:"Rockwell Extra Bold";
	panose-1:2 6 9 3 4 5 5 2 4 3;}
@font-face
	{font-family:"Rockwell Condensed";
	panose-1:2 6 6 3 5 4 5 2 1 4;}
@font-face
	{font-family:Rockwell;
	panose-1:2 6 6 3 2 2 5 2 4 3;}
@font-face
	{font-family:"Rage Italic";
	panose-1:3 7 5 2 4 5 7 7 3 4;}
@font-face
	{font-family:"Perpetua Titling MT";
	panose-1:2 2 5 2 6 5 5 2 8 4;}
@font-face
	{font-family:Perpetua;
	panose-1:2 2 5 2 6 4 1 2 3 3;}
@font-face
	{font-family:"Palace Script MT";
	panose-1:3 3 3 2 2 6 7 12 11 5;}
@font-face
	{font-family:"OCR A Extended";
	panose-1:2 1 5 9 2 1 2 1 3 3;}
@font-face
	{font-family:"Maiandra GD";
	panose-1:2 14 5 2 3 3 8 2 2 4;}
@font-face
	{font-family:"Lucida Sans";
	panose-1:2 11 6 2 3 5 4 2 2 4;}
@font-face
	{font-family:"Imprint MT Shadow";
	panose-1:4 2 6 5 6 3 3 3 2 2;}
@font-face
	{font-family:"Goudy Stout";
	panose-1:2 2 9 4 7 3 11 2 4 1;}
@font-face
	{font-family:"Goudy Old Style";
	panose-1:2 2 5 2 5 3 5 2 3 3;}
@font-face
	{font-family:"Gloucester MT Extra Condensed";
	panose-1:2 3 8 8 2 6 1 1 1 1;}
@font-face
	{font-family:"Gill Sans Ultra Bold Condensed";
	panose-1:2 11 10 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans Ultra Bold";
	panose-1:2 11 10 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans MT Condensed";
	panose-1:2 11 5 6 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans MT";
	panose-1:2 11 5 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Gill Sans MT Ext Condensed Bold";
	panose-1:2 11 9 2 2 1 4 2 2 3;}
@font-face
	{font-family:Gigi;
	panose-1:4 4 5 4 6 16 7 2 13 2;}
@font-face
	{font-family:"Franklin Gothic Medium Cond";
	panose-1:2 11 6 6 3 4 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Heavy";
	panose-1:2 11 9 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi Cond";
	panose-1:2 11 7 6 3 4 2 2 2 4;}
@font-face
	{font-family:"Franklin Gothic Book";
	panose-1:2 11 5 3 2 1 2 2 2 4;}
@font-face
	{font-family:Forte;
	panose-1:3 6 9 2 4 5 2 7 2 3;}
@font-face
	{font-family:"Felix Titling";
	panose-1:4 6 5 5 6 2 2 2 10 4;}
@font-face
	{font-family:"Eras Medium ITC";
	panose-1:2 11 6 2 3 5 4 2 8 4;}
@font-face
	{font-family:"Eras Light ITC";
	panose-1:2 11 4 2 3 5 4 2 8 4;}
@font-face
	{font-family:"Eras Demi ITC";
	panose-1:2 11 8 5 3 5 4 2 8 4;}
@font-face
	{font-family:"Eras Bold ITC";
	panose-1:2 11 9 7 3 5 4 2 2 4;}
@font-face
	{font-family:"Engravers MT";
	panose-1:2 9 7 7 8 5 5 2 3 4;}
@font-face
	{font-family:Elephant;
	panose-1:2 2 9 4 9 5 5 2 3 3;}
@font-face
	{font-family:"Edwardian Script ITC";
	panose-1:3 3 3 2 4 7 7 13 8 4;}
@font-face
	{font-family:"Curlz MT";
	panose-1:4 4 4 4 5 7 2 2 2 2;}
@font-face
	{font-family:"Copperplate Gothic Light";
	panose-1:2 14 5 7 2 2 6 2 4 4;}
@font-face
	{font-family:"Copperplate Gothic Bold";
	panose-1:2 14 7 5 2 2 6 2 4 4;}
@font-face
	{font-family:"Century Schoolbook";
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:Castellar;
	panose-1:2 10 4 2 6 4 6 1 3 1;}
@font-face
	{font-family:"Calisto MT";
	panose-1:2 4 6 3 5 5 5 3 3 4;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;}
@font-face
	{font-family:"Bodoni MT Condensed";
	panose-1:2 7 6 6 8 6 6 2 2 3;}
@font-face
	{font-family:"Bodoni MT Black";
	panose-1:2 7 10 3 8 6 6 2 2 3;}
@font-face
	{font-family:"Bodoni MT";
	panose-1:2 7 6 3 8 6 6 2 2 3;}
@font-face
	{font-family:"Blackadder ITC";
	panose-1:4 2 5 5 5 16 7 2 13 2;}
@font-face
	{font-family:"Agency FB";
	panose-1:2 11 5 3 2 2 2 2 2 4;}
@font-face
	{font-family:"Bookshelf Symbol 7";
	panose-1:5 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"MS Reference Sans Serif";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"MS Reference Specialty";
	panose-1:5 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Berlin Sans FB Demi";
	panose-1:2 14 8 2 2 5 2 2 3 6;}
@font-face
	{font-family:"Tw Cen MT Condensed Extra Bold";
	panose-1:2 11 8 3 2 2 2 2 2 4;}
@font-face
	{font-family:"Buxton Sketch";
	panose-1:3 8 5 0 0 5 0 0 0 4;}
@font-face
	{font-family:"Segoe Marker";
	panose-1:3 8 6 2 4 3 2 2 2 4;}
@font-face
	{font-family:"SketchFlow Print";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"English Towne";
	panose-1:2 0 6 6 2 0 0 2 0 3;}
@font-face
	{font-family:"Effortless Tattoo";
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:ZDingbats;
	panose-1:5 0 6 0 2 0 0 2 0 4;}
@font-face
	{font-family:"DejaVu Sans Condensed";
	panose-1:2 11 6 6 3 8 4 2 2 4;}
@font-face
	{font-family:Arimo;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Gentium Basic";
	panose-1:2 0 5 3 6 0 0 2 0 4;}
@font-face
	{font-family:"Gentium Book Basic";
	panose-1:2 0 5 3 6 0 0 2 0 4;}
@font-face
	{font-family:"DejaVu Sans";
	panose-1:2 11 6 3 3 8 4 2 2 4;}
@font-face
	{font-family:"DejaVu Sans Mono";
	panose-1:2 11 6 9 3 8 4 2 2 4;}
@font-face
	{font-family:"DejaVu Serif Condensed";
	panose-1:2 6 6 6 5 6 5 2 2 4;}
@font-face
	{font-family:"DejaVu Serif";
	panose-1:2 6 6 3 5 6 5 2 2 4;}
@font-face
	{font-family:"DejaVu Sans Light";
	panose-1:2 11 2 3 3 8 4 2 2 4;}
@font-face
	{font-family:"Open Sans";
	panose-1:2 11 6 6 3 5 4 2 2 4;}
@font-face
	{font-family:OpenSymbol;
	panose-1:5 1 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Source Sans Pro";
	panose-1:2 11 5 3 3 4 3 2 2 4;}
@font-face
	{font-family:"Source Code Pro";
	panose-1:2 11 5 9 3 4 3 2 2 4;}
@font-face
	{font-family:"Linux Biolinum G";
	panose-1:2 0 5 3 0 0 0 0 0 0;}
@font-face
	{font-family:"PT Serif";
	panose-1:2 10 6 3 4 5 5 2 2 4;}
@font-face
	{font-family:"Liberation Mono";
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Liberation Sans Narrow";
	panose-1:2 11 6 6 2 2 2 3 2 4;}
@font-face
	{font-family:"Liberation Sans";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Liberation Serif";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Linux Libertine Display G";
	panose-1:2 0 5 3 0 0 0 0 0 0;}
@font-face
	{font-family:"Linux Libertine G";
	panose-1:2 0 5 3 0 0 0 0 0 0;}
@font-face
	{font-family:"Ammys Handwriting";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Monaco;
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Swansea;
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Futura LT";
	panose-1:2 0 3 6 0 0 0 0 0 0;}
@font-face
	{font-family:Assassin$;
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Comic Neue Angular";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Comic Neue";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Visitor TT2 BRK";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Visitor TT1 BRK";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Arial Narrow";
	panose-1:2 11 6 6 2 2 2 3 2 4;}
@font-face
	{font-family:"Good Times Rg";
	panose-1:2 11 6 5 2 0 0 2 0 1;}
@font-face
	{font-family:"Bitstream Vera Sans";
	panose-1:2 11 6 3 3 8 4 2 2 4;}
@font-face
	{font-family:"Bitstream Vera Serif";
	panose-1:2 6 6 3 5 6 5 2 2 4;}
@font-face
	{font-family:"Bitstream Vera Sans Mono";
	panose-1:2 11 6 9 3 8 4 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:33.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:44.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:66.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:77.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:88.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.Definition
	{mso-style-name:Definition;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Times New Roman","serif";}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Times New Roman","serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
p.TableListing, li.TableListing, div.TableListing
	{mso-style-name:"Table Listing";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TableHeader, li.TableHeader, div.TableHeader
	{mso-style-name:"Table Header";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpFirst, li.ChapterTitleCxSpFirst, div.ChapterTitleCxSpFirst
	{mso-style-name:"Chapter TitleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpMiddle, li.ChapterTitleCxSpMiddle, div.ChapterTitleCxSpMiddle
	{mso-style-name:"Chapter TitleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpLast, li.ChapterTitleCxSpLast, div.ChapterTitleCxSpLast
	{mso-style-name:"Chapter TitleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.URL
	{mso-style-name:URL;
	color:windowtext;
	text-decoration:underline;}
p.SourceCodeExcerpt, li.SourceCodeExcerpt, div.SourceCodeExcerpt
	{mso-style-name:"Source Code Excerpt";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpFirst, li.SourceCodeExcerptCxSpFirst, div.SourceCodeExcerptCxSpFirst
	{mso-style-name:"Source Code ExcerptCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpMiddle, li.SourceCodeExcerptCxSpMiddle, div.SourceCodeExcerptCxSpMiddle
	{mso-style-name:"Source Code ExcerptCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpLast, li.SourceCodeExcerptCxSpLast, div.SourceCodeExcerptCxSpLast
	{mso-style-name:"Source Code ExcerptCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.SourceCode
	{mso-style-name:"Source Code";
	font-family:"Lucida Console";}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
span.SampleRunResponse
	{mso-style-name:"Sample Run Response";
	color:black;}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.MessageText, li.MessageText, div.MessageText
	{mso-style-name:"Message Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Lucida Sans Typewriter";}
p.TopicsCoveredbox, li.TopicsCoveredbox, div.TopicsCoveredbox
	{mso-style-name:"Topics Covered box";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpFirst, li.TopicsCoveredboxCxSpFirst, div.TopicsCoveredboxCxSpFirst
	{mso-style-name:"Topics Covered boxCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpMiddle, li.TopicsCoveredboxCxSpMiddle, div.TopicsCoveredboxCxSpMiddle
	{mso-style-name:"Topics Covered boxCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpLast, li.TopicsCoveredboxCxSpLast, div.TopicsCoveredboxCxSpLast
	{mso-style-name:"Topics Covered boxCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
p.FigureCaption, li.FigureCaption, div.FigureCaption
	{mso-style-name:"Figure Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpFirst, li.FigureCaptionCxSpFirst, div.FigureCaptionCxSpFirst
	{mso-style-name:"Figure CaptionCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpMiddle, li.FigureCaptionCxSpMiddle, div.FigureCaptionCxSpMiddle
	{mso-style-name:"Figure CaptionCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpLast, li.FigureCaptionCxSpLast, div.FigureCaptionCxSpLast
	{mso-style-name:"Figure CaptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.SourceCodeFilename
	{mso-style-name:"Source Code Filename";
	font-family:"Lucida Sans Typewriter";}
p.TableCaption, li.TableCaption, div.TableCaption
	{mso-style-name:"Table Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	text-align:center;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.Filename
	{mso-style-name:Filename;
	font-style:italic;}
p.CipherInfoBox, li.CipherInfoBox, div.CipherInfoBox
	{mso-style-name:"Cipher Info Box";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	background:#FFFF99;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Another Typewriter";
	letter-spacing:1.4pt;}
p.ChapterQuotes, li.ChapterQuotes, div.ChapterQuotes
	{mso-style-name:"Chapter Quotes";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpFirst, li.ChapterQuotesCxSpFirst, div.ChapterQuotesCxSpFirst
	{mso-style-name:"Chapter QuotesCxSpFirst";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpMiddle, li.ChapterQuotesCxSpMiddle, div.ChapterQuotesCxSpMiddle
	{mso-style-name:"Chapter QuotesCxSpMiddle";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpLast, li.ChapterQuotesCxSpLast, div.ChapterQuotesCxSpLast
	{mso-style-name:"Chapter QuotesCxSpLast";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.CodeExample, li.CodeExample, div.CodeExample
	{mso-style-name:"Code Example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpFirst, li.CodeExampleCxSpFirst, div.CodeExampleCxSpFirst
	{mso-style-name:"Code ExampleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpMiddle, li.CodeExampleCxSpMiddle, div.CodeExampleCxSpMiddle
	{mso-style-name:"Code ExampleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpLast, li.CodeExampleCxSpLast, div.CodeExampleCxSpLast
	{mso-style-name:"Code ExampleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SmallerText, li.SmallerText, div.SmallerText
	{mso-style-name:"Smaller Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code \(Headline\)";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code \(Headline\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code \(Headline\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code \(Headline\)CxSpLast";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1, li.Style1, div.Style1
	{mso-style-name:Style1;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpFirst, li.Style1CxSpFirst, div.Style1CxSpFirst
	{mso-style-name:Style1CxSpFirst;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpMiddle, li.Style1CxSpMiddle, div.Style1CxSpMiddle
	{mso-style-name:Style1CxSpMiddle;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpLast, li.Style1CxSpLast, div.Style1CxSpLast
	{mso-style-name:Style1CxSpLast;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>
<div style='float: right; height: 310px; font-family: sans-serif;'>Ad: Programming books by Al Sweigart<br />
    <a href='http://www.nostarch.com/automatestuff' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src='/images/cover_automate_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/gp/product/0982106017?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src='/images/cover_inventwithpython_thumb.jpg' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src='/images/cover_makinggames_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='https://www.amazon.com/gp/product/1593278225/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593278225&linkCode=as2&tag=playwithpyth-20&linkId=bf3b22819f0886d277e88b8a653b81ad' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src='/images/cover_crackingcodes_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
</div>

<div class=WordSection1><p><strong>Note: The second edition of this book is available under the title <em><a href="https://inventwithpython.com/cracking">Cracking Codes with Python</a></em></strong></p>

<p class=MsoNormal align=center style='text-align:center'><img width=409
height=225 id="Picture 45" src="chapter24_files/image001.jpg"> </p>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc353630947"><span style='font-variant:normal !important;
text-transform:uppercase'>Public Key Cryptography and the RSA Cipher</span></a></h1>

</div>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#DBE5F1'>

<p class=TopicsCoveredboxCxSpFirst style='background:#DBE5F1;border:none;
padding:0in'>Topics Covered In This Chapter:</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Public key cryptography</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Man-in-the-middle attacks</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>ASCII</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>chr()</span> and <span class=Literal>ord()</span>
functions</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The bytes data type and <span class=Literal>bytes()</span>
function</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>encode()</span> string and <span
class=Literal>decode()</span> bytes method</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>min()</span> and <span class=Literal>max()</span>
functions</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>insert()</span> list method</p>

<p class=TopicsCoveredboxCxSpLast style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>pow()</span> function</p>

</div>

<p class=ChapterQuotesCxSpFirst style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>“Why shouldn’t I work for the NSA? That’s a tough one, but
I’ll take a shot. Say I’m working at the NSA and somebody puts a code on my
desk, something no one else can break. Maybe I take a shot at it, and maybe I
break it. I’m real happy with myself, ‘cause I did my job well. But maybe that
code was the location of some rebel army in North Africa or the Middle East and
once they have that location they bomb the village where the rebels are hiding.
Fifteen hundred people that I never met, never had no problem with, get killed.</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>&nbsp;</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>Now the politicians are saying ‘Oh, send in the Marines to
secure the area,’ ‘cause they don’t give a shit. It won’t be their kid over
there getting shot just like it wasn’t them when their number got called ‘cause
they were pulling a tour in the National Guard. It’ll be some kid from Southie
over there taking shrapnel in the ass. He comes back to find that the plant he
used to work at got exported to the country he just got back from, and the guy
that put the shrapnel in his ass got his old job, ‘cause he’ll work for fifteen
cents a day and no bathroom breaks.</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>&nbsp;</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>Meanwhile he realizes that the only reason he was over there
in the first place was so we could install a government that would sell us oil
at a good price. And of course the oil companies use the little skirmish to
scare up domestic oil prices, a cute little ancillary benefit for them, but it
ain’t helping my buddy at two-fifty a gallon. They’re taking their sweet time
bringing the oil back, of course, and maybe they took the liberty of hiring an
alcoholic skipper who likes to drink martinis and fucking play slalom with the
icebergs. It ain’t too long until he hits one, spills the oil, and kills all
the sea life in the North Atlantic.</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>&nbsp;</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>So now my buddy’s out of work, he can’t afford to drive, so
he’s walking to the fucking job interviews which sucks because the shrapnel in
his ass is giving him chronic hemorrhoids. And meanwhile he’s starving ‘cause
any time he tries to get a bite to eat the only Blue Plate Special they’re
serving is North Atlantic Scrod with Quaker State.</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>&nbsp;</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>So what did I think? I’m holding out for something better.”</span></p>

<p class=ChapterQuotesCxSpMiddle style='margin-top:30.0pt;margin-right:.5in;
margin-bottom:30.0pt;margin-left:.5in'><span style='font-size:12.0pt;
line-height:115%'>&nbsp;</span></p>

<p class=ChapterQuotesCxSpLast align=right style='margin-top:30.0pt;margin-right:
.5in;margin-bottom:30.0pt;margin-left:.5in;text-align:right'><span
style='font-size:11.0pt;line-height:115%'>“Good Will Hunting”</span></p>

<h2><a name="_Toc353630948">Public Key Cryptography</a></h2>

<p class=MsoNormal>All of the ciphers in this book so far have one thing in
common: the key used for encryption is the same key used for decryption. This
leads to a tricky problem: How do you share encrypted messages with someone
you’ve never talked to before?</p>

<p class=MsoNormal>Say someone on the other side of the world wants to
communicate with you. But you both know that spy agencies are monitoring all emails,
letters, texts, and calls that you send. You could send them encrypted
messages, however you would both have to agree on a secret key to use. But if
one of you emailed the other a secret key to use, then the spy agency would be
able to see this key and then decrypt any future messages you send with that
key. Normally you would both secretly meet in person and exchange the key then.
But you can’t do this if the person is on the other side of the world. You
could try encrypting the key before you send it, but then you would have to
send the secret key for <em><span style='font-family:"Calibri","sans-serif"'>that</span></em>
message to the other person and it would also be intercepted.</p>

<p class=MsoNormal>This is a problem solved by public key cryptography. <span
class=Definition><span style='font-size:12.0pt;line-height:115%'>Public key
cryptography</span></span> ciphers have two keys, one used for encryption and
one used for decryption. A cipher that uses different keys for encryption and
decryption is called an <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>asymmetric cipher</span></span>, while the ciphers that use
the same key for encryption and decryption (like all the previous ciphers in
this book) are called <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>symmetric ciphers</span></span>.</p>

<p class=MsoNormal>The important thing to know is that <strong><span
style='font-family:"Calibri","sans-serif"'>a message encrypted with one key can
only be decrypted with the other key</span></strong>. So even if someone got
their hands on the encryption key, they would not be able to read an encrypted
message because the encryption key can only encrypt; it cannot be used to
decrypt messages that it encrypted.</p>

<p class=MsoNormal>So when we have these two keys, we call one the public key
and one the private key. The <span class=Definition><span style='font-size:
12.0pt;line-height:115%'>public key</span></span> is shared with the entire
world. However, the <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>private key</span></span> must be kept secret.</p>

<p class=MsoNormal>If Alice wants to send Bob a message, Alice finds Bob’s
public key (or Bob can give it to her). Then Alice encrypts her message to Bob
with Bob’s public key. Since the public key cannot decrypt a message that was
encrypted with it, it doesn’t matter that everyone else has Bob’s public key.</p>

<p class=MsoNormal>When Bob receives the encrypted message, he uses his private
key to decrypt it. If Bob wants to reply to Alice, he finds her public key and
encrypts his reply with it. Since only Alice knows her own private key, Alice
will be the only person who can decrypt the encrypted message.</p>

<p class=MsoNormal>Remember that when sending encrypted messages using a public
key cipher:</p>

<p class=MsoListParagraphCxSpFirst style='margin-left:81.0pt;text-indent:-9.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>The public key is used for encrypting.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:81.0pt;text-indent:-9.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>The private key is used for decrypting.</p>

<p class=MsoNormal>To go back to the example of communicating with someone
across the world, now it doesn’t matter if you send them your public key. Even
if the spy agency has your public key, they cannot read messages that were
encrypted with the public key. Only your private key can decrypt those
messages, and you keep that key a secret.</p>

<p class=MsoNormal>The particular public key cipher that we will implement is
called the RSA cipher, which was invented in 1977 and named after its
inventors: Ron Rivest, Adi Shamir and Leonard Adleman.</p>

<h2><a name="_Toc353630949">The Dangers of “Textbook” RSA</a></h2>

<p class=MsoNormal>While we don’t write a hacking program for the RSA cipher
program in this book, don’t make the mistake of thinking the <span
class=Filename>rsaCipher.py</span> program featured in this chapter is secure.
Getting cryptography right is very hard and requires a lot of experience to
know if a cipher (and a program that implements it) is truly secure.</p>

<p class=MsoNormal>The RSA program in this chapter is known as <span
class=Definition><span style='font-size:12.0pt;line-height:115%'>textbook RSA</span></span>
because, while it does implement the RSA algorithm correctly using large prime
numbers, there are several subtle faults with it that can lead to its encrypted
messages being hacked. The difference between pseudorandom and truly random
number generation functions is one such fault. But there are many others.</p>

<p class=MsoNormal>So while you might not be able to hack the ciphertext
created by <span class=Filename>rsaCipher.py</span>, don’t think that no one
else can. The highly accomplished cryptographer Bruce Schneier once said, “Anyone,
from the most clueless amateur to the best cryptographer, can create an
algorithm that he himself can’t break. It’s not even hard. What is hard is
creating an algorithm that no one else can break, even after years of analysis.
And the only way to prove that is to subject the algorithm to years of analysis
by the best cryptographers around.”</p>

<p class=MsoNormal>The program in this book is a fun example, but stick to
professional encryption software to secure your files. You can find a list of
(usually free) encryption software here: <span class=URL><u>http://invpy.com/realcrypto</u></span>.</p>

<h2><a name="_Toc353630950">A Note About Authentication</a></h2>

<p class=MsoNormal>There is a slight problem with public key ciphers. Imagine
you got an email that said this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.0in;margin-bottom:10.0pt;
margin-left:.75in'>“Hello. I am Emmanuel Goldstein, leader of the resistance. I
would like to communicate secretly with you about very important matters.
Attached is my public key.”</p>

<p class=MsoNormal>Using the public key, you can be sure that the messages you
send cannot be read by anyone other than “Emmanuel Goldstein”. But how do you
know the person who sent you this is actually Emmanuel Goldstein? Maybe it is
Emmanuel Goldstein that you are sending encrypted messages to, or maybe it is a
spy agency that is pretending to be Emmanuel Goldstein to lure you into a trap.</p>

<p class=MsoNormal>So while public key ciphers (and, in fact, all the ciphers
in this book) can provide <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>confidentiality</span></span> (that is, keeping the message a
secret), they don’t provide <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>authentication</span></span> (that is, proof that who you are
communicating with really is who they say they are).</p>

<p class=MsoNormal>Normally this isn’t a problem with symmetric ciphers,
because when you exchange keys with the person you can see them for yourself.
However, you don’t need to see a person in order to get their public key and
begin sending them encrypted messages. This is something to keep in mind when
using public key cryptography.</p>

<p class=MsoNormal>There is an entire field called PKI (Public Key
Infrastructure) that deals with authentication so that you can match public
keys to people with some level of security; however, PKI is beyond the scope of
this book.</p>

<h2><a name="_Toc353630951">The Man-In-The-Middle Attack</a></h2>

<p class=MsoNormal>Even more insidious than hacking our encrypted messages is a
man-in-the-middle attack. Say Emmanuel Goldstein really did want to communicate
with you and sent you the above message, but the spy agency intercepted it.
They could then replace the public key Emmanuel attached to the email with
their own public key, and then send it on to you. You would think the spy
agency’s key was Emmanuel’s key!</p>

<p class=MsoNormal>Now when you encrypt a reply to Emmanuel, they intercept
that message, decrypt it (since you really encrypted the message with the spy
agency’s public key, not Emmanuel’s public key) and read it, and then they
re-encrypt it with Emmanuel’s actual public key and send it to him. They do the
same thing with any messages that Emmanuel sends to you.</p>

<p class=MsoNormal align=center style='text-align:center'><img width=294
height=323 id="Picture 18" src="chapter24_files/image002.jpg"></p>

<p class=FigureCaption>Figure 24-1. A man-in-the-middle attack.</p>

<p class=MsoNormal>To both you and Emmanuel, it looks like you are
communicating secretly with each other. But actually, the spy agency is doing a
<span class=Definition><span style='font-size:12.0pt;line-height:115%'>man-in-the-middle
attack</span></span> and reading all of your messages. You and Emmanuel are
actually encrypting your messages public keys generated by the spy agency! Again,
this problem is caused by the fact that the public key cipher only provides <em><span
style='font-family:"Calibri","sans-serif"'>confidentiality</span></em>, but
does not provide <em><span style='font-family:"Calibri","sans-serif"'>authentication</span></em>.</p>

<h2><a name="_Toc353630952">Generating Public and Private Keys</a></h2>

<p class=MsoNormal>A key in the RSA scheme is made of two numbers. There are
three steps to creating the keys:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Create
two random, distinct, very large prime numbers. These numbers will be called p and q.
Multiply these numbers to get a number which we will call n.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Create
a random number, called e, which is relatively prime with (p – 1) × (q – 1).</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Calculate
the modular inverse of e. This number will be called d.</p>

<p class=MsoNormal>The public key will be the two numbers n and e. The private
key will be the two numbers n and d. (Notice that both keys have the number n
in them.) We will cover how to encrypt and decrypt with these numbers when the
RSA cipher program is explained. First let’s write a program to generate these
keys.</p>

<h2><a name="_Toc353630953">Source Code for the RSA Key Generation Program</a></h2>

<p class=MsoNormal>Open a new file editor window by clicking on <strong><span
style='font-family:"Calibri","sans-serif"'>File</span></strong> &#9658; <strong><span
style='font-family:"Calibri","sans-serif"'>New Window</span></strong>. Type in
the following code into the file editor, and then save it as <span
class=Filename>makeRsaKeys.py</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for makeRsaKeys.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 1.</span> <span
class=SourceCodeComment># RSA Key Generator</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 4.</span>
import random, sys, os, rabinMiller, cryptomath</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 6. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 7.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>    
<span class=SourceCodeComment># create a public/private keypair with 1024 bit
keys</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9.</span>    
print('Making key files...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>    
makeKeyFiles('al_sweigart', 1024)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.     </span>print('Key
files made.')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>12. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>13.</span>
def generateKey(keySize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span>    
<span class=SourceCodeComment># Creates a public/private key pair with keys
that are keySize bits in</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15.</span>    
<span class=SourceCodeComment># size. This function may take a while to run.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17.</span>    
<span class=SourceCodeComment># Step 1: Create two prime numbers, p and q.
Calculate n = p * q.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18.</span>    
print('Generating p prime...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>    
p = rabinMiller.generateLargePrime(keySize)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>    
print('Generating q prime...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21.</span>    
q = rabinMiller.generateLargePrime(keySize)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22.</span>    
n = p * q</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>23. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>24.</span>    
<span class=SourceCodeComment># Step 2: Create a number e that is relatively
prime to (p-1)*(q-1).</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>25.</span>    
print('Generating e that is relatively prime to (p-1)*(q-1)...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>26.</span>    
while True:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>27.</span>        
<span class=SourceCodeComment># Keep trying random numbers for e until one is
valid.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>28.</span>        
e = random.randrange(2 ** (keySize - 1), 2 ** (keySize))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>29.</span>        
if cryptomath.gcd(e, (p - 1) * (q - 1)) == 1:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>30.</span>            
break</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>31. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>32.</span>    
<span class=SourceCodeComment># Step 3: Calculate d, the mod inverse of e.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>33.</span>    
print('Calculating d that is mod inverse of e...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>34.</span>    
d = cryptomath.findModInverse(e, (p - 1) * (q - 1))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>35. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>36.</span>    
publicKey = (n, e)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>37.</span>    
privateKey = (n, d)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>38. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>39.</span>    
print('Public key:', publicKey)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>40.</span>    
print('Private key:', privateKey)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>41. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>42.</span>    
return (publicKey, privateKey)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>43. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>44. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>45.</span>
def makeKeyFiles(name, keySize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>46.</span>    
<span class=SourceCodeComment># Creates two files 'x_pubkey.txt' and
'x_privkey.txt' (where x is the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>47.</span>    
<span class=SourceCodeComment># value in name) with the the n,e and d,e
integers written in them,</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>48.</span>    
<span class=SourceCodeComment># delimited by a comma.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>49. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>50.</span>    
<span class=SourceCodeComment># Our safety check will prevent us from
overwriting our old key files:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>51.</span>    
if os.path.exists('%s_pubkey.txt' % (name)) or os.path.exists('%s_privkey.txt'
% (name)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>52.</span>        
sys.exit('WARNING: The file %s_pubkey.txt or %s_privkey.txt already exists! Use
a different name or delete these files and re-run this program.' % (name,
name))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>53. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>54.</span>    
publicKey, privateKey = generateKey(keySize)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>55. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>56.</span>    
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>57.</span>    
print('The public key is a %s and a %s digit number.' <span lang=DE>%
(len(str(publicKey[0])), len(str(publicKey[1]))))</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>58.</span>    
print('Writing public key to file %s_pubkey.txt...' % (name))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>59.</span>    
fo = open('%s_pubkey.txt' % (name), 'w')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>60.</span>    
fo.write('%s,%s,%s' % (keySize, publicKey[0], publicKey[1]))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>61.</span>    
fo.close()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>62. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>63.</span>    
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>64.</span>    
print('The private key is a %s and a %s digit number.' <span lang=DE>%
(len(str(publicKey[0])), len(str(publicKey[1]))))</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>65.</span>    
print('Writing private key to file %s_privkey.txt...' % (name))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>66.</span>    
fo = open('%s_privkey.txt' % (name), 'w')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>67.</span>    
fo.write('%s,%s,%s' % (keySize, privateKey[0], privateKey[1]))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>68.</span>    
fo.close()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>69. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>70. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>71.</span> <span
class=SourceCodeComment># If makeRsaKeys.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>72.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>73.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>74.</span>    
main()</p>

</div>

<h2><a name="_Toc353630954">Sample Run of the RSA Key Generation Program</a></h2>

<p class=MsoNormal>When you run the <span class=Filename>makeRsaKeys.py</span>
program, the output will look something like this (of course, the numbers for
your keys will be different since they are random numbers):</p>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Making key files...</p>

<p class=SampleRunCxSpMiddle>Generating p prime...</p>

<p class=SampleRunCxSpMiddle>Generating q prime...</p>

<p class=SampleRunCxSpMiddle>Generating e that is relatively prime to
(p-1)*(q-1)...</p>

<p class=SampleRunCxSpMiddle>Calculating d that is mod inverse of e...</p>

<p class=SampleRunCxSpMiddle>Public key:
(21090240631670050240196849140657941740509039675461692613581062121611619133808656784074598753554688979280723862705107204438273246714358932748583937496850624116776147241821152026946322876869404394483922202407821672864242478920813182699000847352671174429654856386676845425140495196080522468242549897523048895590808649185211634877784953627068508544697095291564005052221220422180374449406588101033148646830531744960702788478777031572995978999471326531132766377616771007701834003666830661266575941720784582347990344057272406812521100232929833871861585954209372109725826359561748245019920074018549204468791300114315056117093,
174602307691751610217318454592368335538324039108691290549542003736785809352476066222657643882357521766547378058490230065447328963086855136695099174511958226113980989513066766009588891895645995814564600702703936932776834043548115756816059906591453170741270845572335375041024799371425300216777273298110097435989)</p>

<p class=SampleRunCxSpMiddle>Private key:
(21090240631670050240196849140657941740509039675461692613581062121611619133808656784074598753554688979280723862705107204438273246714358932748583937496850624116776147241821152026946322876869404394483922202407821672864242478920813182699000847352671174429654856386676845425140495196080522468242549897523048895590808649185211634877784953627068508544697095291564005052221220422180374449406588101033148646830531744960702788478777031572995978999471326531132766377616771007701834003666830661266575941720784582347990344057272406812521100232929833871861585954209372109725826359561748245019920074018549204468791300114315056117093,
4767673579813771041216688491698376504317312028941690434129597155228687099187466609993337100807594854900855122476069594266696246596816899540499393450839901428305371067676083594890231288863993840268618707505236077306236416266427614496565255854533116668173598098138449334931305875025941768372702963348445191139635826000818122373486213256488077192893119257248107794256818846036400286732731352928311701786142068171658028122915283195622006250825572616804708456070635960183391931797437503163601143217769616471700002543036826990539739057474642785416933878499897014777481407371328053001838085314443545845219087249544663398589)</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>The public key is a 617 and a 309 digit number.</p>

<p class=SampleRunCxSpMiddle>Writing public key to file
al_sweigart_pubkey.txt...</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>The private key is a 617 and a 309 digit number.</p>

<p class=SampleRunCxSpLast>Writing private key to file
al_sweigart_privkey.txt...</p>

</div>

<p class=MsoNormal>These two keys are written out to two different files, <span
class=Filename>al_sweigart_pubkey.txt</span> and <span class=Filename>al_sweigart_privkey.txt</span>.
These filenames are used because the string <span class=Literal>'al_sweigart'</span>
was passed to the <span class=Literal>makeKeyFiles()</span> function. You can specify
a different filenames by passing a different string. These key files will be
used by the RSA cipher program to encrypt and decrypt messages.</p>

<p class=MsoNormal>If you try to run <span class=Filename>makeRsaKeys.py</span>
again with the same string being passed to <span class=Literal>makeKeyFiles()</span>,
the output of the program will look like this:</p>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Making key files...</p>

<p class=SampleRunCxSpLast>WARNING: The file al_sweigart_pubkey.txt or
al_sweigart_privkey.txt already exists! Use a different name or delete these
files and re-run this program.</p>

</div>

<p class=MsoNormal>This warning is here so you don’t accidentally overwrite
your key files, making any files you encrypted with them impossible to recover.
Keep your keys safe!</p>

<h2><a name="_Toc353630955">How the Key Generation Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment> 1.</span> <span
class=SourceCodeComment># RSA Key Generator</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 3. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment> 4.</span>
import random, sys, os, rabinMiller, cryptomath</p>

</div>

<p class=MsoNormal>The program imports the <span class=Literal>rabinMiller</span>
and <span class=Literal>cryptomath</span> modules that we created in the last
chapter, along with a few others.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 7.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>    
<span class=SourceCodeComment># create a public/private keypair with 1024 bit
keys</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9.</span>    
print('Making key files...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>    
makeKeyFiles('al_sweigart', 1024)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>11.     </span>print('Key
files made.')</p>

</div>

<p class=MsoNormal>When <span class=Filename>makeRsaKeys.py</span> is run, the <span
class=Literal>main()</span> function is called, which will create the key
files. Since the keys might take a while for the computer to generate, we print
a message on line 9 before the <span class=Literal>makeKeyFiles()</span> call
so the user knows what the program is doing.</p>

<p class=MsoNormal>The <span class=Literal>makeKeyFiles()</span> call on line 10
passes the string <span class=Literal>'al_sweigart'</span> and the integer <span
class=Literal>1024</span>. This will generate keys with a size of 1024 bits and
store them in files named <span class=Filename>al_sweigart_pubkey.txt</span>
and <span class=Filename>al_sweigart_privkey.txt</span>.</p>

<h2><a name="_Toc353630956">The Program’s </a><span class=Literal>generateKey()</span>
Function</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>13.</span>
def generateKey(keySize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span>    
<span class=SourceCodeComment># Creates a public/private key pair with keys
that are keySize bits in</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15.</span>    
<span class=SourceCodeComment># size. This function may take a while to run.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17.</span>    
<span class=SourceCodeComment># Step 1: Create two prime numbers, p and q.
Calculate n = p * q.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18.</span>    
print('Generating p prime...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>    
p = rabinMiller.generateLargePrime(keySize)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>    
print('Generating q prime...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21.</span>    
q = rabinMiller.generateLargePrime(keySize)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>22.</span>    
n = p * q</p>

</div>

<p class=MsoNormal>The first step of creating keys is coming up with two random
prime numbers which are called p and q. The <span class=Literal>generateLargePrime()</span>
function we wrote in the last chapter’s <span class=Filename>rabinMiller.py</span>
program will return a prime number (as an integer value) of the size determined
by the value in <span class=Literal>keySize</span> on line 19 and line 21.
These integer values are stored in variables named <span class=Literal>p</span>
<<<<<<< HEAD
and <span class=Literal>q</span>. Make sure that <span class=Literal>p</span>
and <span class=Literal>q</span> are not the same number.</p>
=======
and <span class=Literal>q</span>.</p>
>>>>>>> 23da471aa4d8b7af4ca17689e75270d654c60320

<p class=MsoNormal>On line 22, the number n is calculated by multiplying <span
class=Literal>p</span> and <span class=Literal>q</span>, and stored in <span
class=Literal>n</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>24.</span>    
<span class=SourceCodeComment># Step 2: Create a number e that is relatively
prime to (p-1)*(q-1).</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>25.</span>    
print('Generating e that is relatively prime to (p-1)*(q-1)...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>26.</span>    
while True:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>27.</span>        
<span class=SourceCodeComment># Keep trying random numbers for e until one is
valid.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>28.</span>        
e = random.randrange(2 ** (keySize - 1), 2 ** (keySize))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>29.</span>        
if cryptomath.gcd(e, (p - 1) * (q - 1)) == 1:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>30.</span>            
break</p>

</div>

<p class=MsoNormal>The second step is calculating a number e which is
relatively prime to the product of <span class=Literal>p – 1</span> and <span
class=Literal>q – 1</span>. The <span class=Literal>while</span> loop on line
26 is an infinite loop. The <span class=Literal>random.randrange()</span> call
on line 28 returns a random integer (stored in the <span class=Literal>e</span>
variable) and line 29 tests if this random number is relatively prime to <span
class=Literal>(p - 1) * (q - 1)</span>. If it is, the <span class=Literal>break</span>
statement on line 30 breaks out of the infinite loop. Otherwise, the program
execution jumps back to line 26 and will keep trying different random numbers
until it finds one that is relatively prime with <span class=Literal>(p</span> <span
class=Literal>-</span> <span class=Literal>1)</span> <span class=Literal>*</span>
<span class=Literal>(q</span> <span class=Literal>-</span> <span class=Literal>1)</span>.</p>

<p class=MsoNormal>This way we can guarantee that when the program execution
gets past this <span class=Literal>while</span> loop, the variable <span
class=Literal>e</span> will contain a number that is relatively prime to <span
class=Literal>(p</span> <span class=Literal>-</span> <span class=Literal>1)</span>
<span class=Literal>*</span> <span class=Literal>(q</span> <span class=Literal>-</span>
<span class=Literal>1)</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>32.</span>    
<span class=SourceCodeComment># Step 3: Calculate d, the mod inverse of e.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>33.</span>    
print('Calculating d that is mod inverse of e...')</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>34.</span>    
d = cryptomath.findModInverse(e, (p - 1) * (q - 1))</p>

</div>

<p class=MsoNormal>The third step is to find the mod inverse of <span
class=Literal>e</span>. The <span class=Literal>findModInverse()</span>
function that we wrote for our <span class=Literal>cryptomath</span> module in
Chapter 14 will do this calculation for us. The mod inverse of <span
class=Literal>e</span> is stored in a variable named <span class=Literal>d</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>36.</span>    
publicKey = (n, e)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>37.</span>    
privateKey = (n, d)</p>

</div>

<p class=MsoNormal>In the RSA cipher, each key is made up of two numbers. The
public key will be the integers stored in <span class=Literal>n</span> and <span
class=Literal>e</span>, and the private key will be the integers stored in <span
class=Literal>n</span> and <span class=Literal>d</span>. Lines 36 and 37 store
these integers as tuples in the variables <span class=Literal>publicKey</span>
and <span class=Literal>privateKey</span>.</p>

<p class=MsoNormal>There’s no reason <span class=Literal>e</span> has to be in
the public key and <span class=Literal>d</span> in the private key, and you
could swap them. However, once you make the public key public, you must keep
the private key a secret.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>39.</span>    
print('Public key:', publicKey)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>40.</span>    
print('Private key:', privateKey)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>41. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>42.</span>    
return (publicKey, privateKey)</p>

</div>

<p class=MsoNormal>The remaining lines in the <span class=Literal>generateKey()</span>
function print the keys on the screen with <span class=Literal>print()</span>
calls on lines 39 and 40. Then line 42’s <span class=Literal>generateKey()</span>
call returns a tuple with <span class=Literal>publicKey</span> and <span
class=Literal>privateKey</span>.</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>45.</span>
def makeKeyFiles(name, keySize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>46.</span>    
<span class=SourceCodeComment># Creates two files 'x_pubkey.txt' and
'x_privkey.txt' (where x is the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>47.</span>    
<span class=SourceCodeComment># value in name) with the the n,e and d,e
integers written in them,</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>48.</span>    
<span class=SourceCodeComment># delimited by a comma.</span></p>

</div>

<p class=MsoNormal>While the <span class=Literal>generateKey()</span> function
will generate the actual integers for the public and private keys, we need to
store these numbers in a file so that our RSA cipher program can use them later
to encrypt and decrypt. Each of the keys are made of two integers that are
hundreds of digits long; that’s too many to memorize or conveniently write down.
The easiest way to store them is as text files on your computer.</p>

<p class=MsoNormal>This means that you have to be sure that nobody hacks your
computer and copies these key files. It might be a good idea to store these
files on a USB thumb drive instead of on your computer. However, this is also
risky. If someone borrows the thumb drive then they could copy the key files,
or if you accidentally break or lose the thumb drive then you will lose your
own private key!</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>50.</span>    
<span class=SourceCodeComment># Our safety check will prevent us from
overwriting our old key files:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>51.</span>    
if os.path.exists('%s_pubkey.txt' % (name)) or os.path.exists('%s_privkey.txt'
% (name)):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>52.</span>        
sys.exit('WARNING: The file %s_pubkey.txt or %s_privkey.txt already exists! Use
a different name or delete these files and re-run this program.' % (name,
name))</p>

</div>

<p class=MsoNormal>To prevent us from accidentally deleting our key files by
running the program again, line 51 checks to see if the public or private key
files with the given name already exist. If they do, the program will exit with
a warning message.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>54.</span>    
publicKey, privateKey = generateKey(keySize)</p>

</div>

<p class=MsoNormal>After the check, line 54 has a call to <span class=Literal>generateKey()</span>
to get the public and private keys using the multiple assignment trick. The <span
class=Literal>generateKey()</span> function returns a tuple of two tuples. The
first tuple has two integers for the public key and the second tuple has two
integers for the private key. These are stored in the variables <span
class=Literal>publicKey</span> and <span class=Literal>privateKey</span>.</p>

<h2><a name="_Toc353630957">RSA Key File Format</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>56.</span>    
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>57.</span>    
print('The public key is a %s and a %s digit number.' <span lang=DE>%
(len(str(publicKey[0])), len(str(publicKey[1]))))</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>58.</span>    
print('Writing public key to file %s_pubkey.txt...' % (name))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>59.</span>    
fo = open('%s_pubkey.txt' % (name), 'w')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>60.</span>    
fo.write('%s,%s,%s' % (keySize, publicKey[0], publicKey[1]))</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>61.</span>    
fo.close()</p>

</div>

<p class=MsoNormal>Line 57 prints some information about the public key. It can
tell how many digits are in the integer in <span class=Literal>publicKey[0]</span>
and <span class=Literal>publicKey[1]</span> by converting those values to
strings with the <span class=Literal>str()</span> function, and then finding
the length of the string with the <span class=Literal>len()</span> function.</p>

<p class=MsoNormal>The key file’s contents will be the key size, a comma, the n
integer, another comma, and the e (or d) integer. The file’s contents will look
like: &lt;key size integer&gt;,&lt;n integer&gt;,&lt;e or d integer&gt;</p>

<p class=MsoNormal>Lines 59 to 61 open a file in write mode, as you can tell
from the <span class=Literal>'w'</span> string passed to <span class=Literal>open()</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>63.</span>    
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>64.</span>    
print('The private key is a %s and a %s digit number.' <span lang=DE>%
(len(str(publicKey[0])), len(str(publicKey[1]))))</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>65.</span>    
print('Writing private key to file %s_privkey.txt...' % (name))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>66.</span>    
fo = open('%s_privkey.txt' % (name), 'w')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>67.</span>    
fo.write('%s,%s,%s' % (keySize, privateKey[0], privateKey[1]))</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>68.</span>    
fo.close()</p>

</div>

<p class=MsoNormal>Lines 63 to 68 do the exact same thing as lines 56 and 61,
except for writing the private key out to a file.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>makeRsaKeys.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>71.</span> <span
class=SourceCodeComment># If makeRsaKeys.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>72.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>73.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>74.</span>    
main()</p>

</div>

<p class=MsoNormal>Lines 73 and 74 are at the bottom of the program, and call <span
class=Literal>main()</span> if <span class=Filename>makeRsaKeys.py</span> is
being run as a program instead of imported as a module by another program.</p>

<h2><a name="_Toc353630958">Hybrid Cryptosystems</a></h2>

<p class=MsoNormal>In real life, the complicated mathematics make RSA and
public-key encryption slow to compute. This is especially true for servers that
need to make hundreds or thousands of encrypted connections a second. Instead,
the RSA cipher is often used to encrypt the key for a symmetric key cipher. The
encrypted key is then sent to the other person, and that key is used to pass
messages that are encrypted using the (faster) symmetric cipher. Using a
symmetric key cipher and an asymmetric key cipher to securely communicate like
this is called a <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>hybrid cryptosystem</span></span>. More information about
hybrid cryptosystems can be found at <span class=URL><u>https://en.wikipedia.org/wiki/Hybrid_cryptosystem</u></span>.</p>

<p class=MsoNormal>It’s not recommended to use the <span class=Filename>rsaCipher.py</span>
program to encrypt the keys for, say, the <span class=Filename>vigenereCipher.py</span>
program. We’ve already proven that the Vigenère cipher is hackable. A strong
symmetric key cipher isn’t covered in this book, but you can still use <span
class=Filename>rsaCipher.py</span> to encrypt your files anyway.</p>

<h2><a name="_Toc353630959">Source Code for the RSA Cipher Program</a></h2>

<p class=MsoNormal>Now that you can create key files, let’s write the program
that does encryption and decryption with the RSA cipher. Open a new file editor
window by clicking on <strong><span style='font-family:"Calibri","sans-serif"'>File</span></strong>
&#9658; <strong><span style='font-family:"Calibri","sans-serif"'>New Window</span></strong>.
Type in the following code into the file editor, and then save it as <span
class=Filename>rsaCipher.py</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for rsaCipher.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  1.</span> <span
class=SourceCodeComment># RSA Cipher</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  4.</span>
import sys</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  6.</span> <span
class=SourceCodeComment># IMPORTANT: The block size MUST be less than or equal to
the key size!</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  7.</span> <span
class=SourceCodeComment># (Note: The block size is in bytes, the key size is in
bits. There</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  8.</span> <span
class=SourceCodeComment># are 8 bits in 1 byte.)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  9.</span> DEFAULT_BLOCK_SIZE
= 128 <span class=SourceCodeComment># 128 bytes</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 10.</span> BYTE_SIZE
= 256 <span class=SourceCodeComment># One byte has 256 different values.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 11. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 12.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 13.</span>    
<span class=SourceCodeComment># Runs a test that encrypts a message to a file
or decrypts a message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 14.</span>    
<span class=SourceCodeComment># from a file.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 15.</span>    
filename = 'encrypted_file.txt' <span class=SourceCodeComment># the file to
write to/read from</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 16.</span>    
mode = 'encrypt' <span class=SourceCodeComment># set to 'encrypt' or 'decrypt'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 17. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 18.</span>    
if mode == 'encrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 19.</span>        
message = '''&quot;Journalists belong in the gutter because that is where the
ruling classes throw their guilty secrets.&quot; -Gerald Priestland &quot;The
Founding Fathers gave the free press the protection it must have to bare the
secrets of government and inform the people.&quot; -Hugo Black'''</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 20.</span>        
pubKeyFilename = 'al_sweigart_pubkey.txt'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 21.</span>        
print('Encrypting and writing to %s...' % (filename))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 22.</span>        
encryptedText = encryptAndWriteToFile(filename, pubKeyFilename, message)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 23. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 24.</span>        
print('Encrypted text:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 25.</span>        
print(encryptedText)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 26. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 27.</span>    
elif mode == 'decrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 28.</span>        
privKeyFilename = 'al_sweigart_privkey.txt'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 29.</span>        
print('Reading from %s and decrypting...' % (filename))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 30.</span>        
decryptedText = readFromFileAndDecrypt(filename, privKeyFilename)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 31. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 32.</span>        
print('Decrypted text:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 33.</span>        
print(decryptedText)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 34. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 35. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 36.</span>
def getBlocksFromText(message, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 37.</span>    
<span class=SourceCodeComment># Converts a string message to a list of block
integers. Each integer</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 38.</span>    
<span class=SourceCodeComment># represents 128 (or whatever blockSize is set
to) string characters.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 39.</span><span
class=SourceCodeComment> </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 40.</span><span
class=SourceCodeComment><span style='color:windowtext'>     messageBytes =
message.encode('ascii') </span># convert the string to bytes</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 41.</span><span
class=SourceCodeComment><span style='color:windowtext'> </span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 42.</span><span
class=SourceCodeComment><span style='color:windowtext'>     blockInts = []</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 43.</span><span
class=SourceCodeComment><span style='color:windowtext'>     for blockStart in
range(0, len(messageBytes), blockSize):</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 44.</span><span
class=SourceCodeComment><span style='color:windowtext'>         </span>#
Calculate the block integer for this block of text</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 45.</span><span
class=SourceCodeComment><span style='color:windowtext'>         blockInt = 0</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 46.</span><span
class=SourceCodeComment><span style='color:windowtext'>         for i in
range(blockStart, min(blockStart + blockSize, </span></span>len(<span
class=SourceCodeComment><span style='color:windowtext'>messageBytes))):</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 47.</span><span
class=SourceCodeComment><span style='color:windowtext'>             blockInt +=
messageBytes[i] * (BYTE_SIZE ** (i % blockSize))</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 48.</span><span
class=SourceCodeComment><span style='color:windowtext'>        
blockInts.append(blockInt)</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 49.</span><span
class=SourceCodeComment><span style='color:windowtext'>     return blockInts</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 50.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 51. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 52.</span>
def getTextFromBlocks(blockInts, messageLength, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 53.</span>    
<span class=SourceCodeComment># Converts a list of block integers to the
original message string.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 54.</span>    
<span class=SourceCodeComment># The original message length is needed to
properly convert the last</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 55.</span>    
<span class=SourceCodeComment># block integer.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 56.</span>    
message = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 57.</span>    
for blockInt in blockInts:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 58.</span>        
blockMessage = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 59.</span>        
for i in range(blockSize - 1, -1, -1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 60.</span>            
if len(message) + i &lt; messageLength:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 61.</span>                
<span class=SourceCodeComment># Decode the message string for the 128 (or
whatever</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 62.</span>                
<span class=SourceCodeComment># blockSize is set to) characters from this block
integer.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 63.</span>                
asciiNumber = blockInt // (BYTE_SIZE ** i)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 64.</span>                
blockInt = blockInt % (BYTE_SIZE ** i)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 65.</span>                
blockMessage.insert(0, chr(asciiNumber))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 66.</span>        
message.extend(blockMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 67.</span>    
return ''.join(message)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 68. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 69. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 70.</span>
def encryptMessage(message, key, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 71.</span>    
<span class=SourceCodeComment># Converts the message string into a list of
block integers, and then</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 72.</span>    
<span class=SourceCodeComment># encrypts each block integer. Pass the PUBLIC
key to encrypt.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 73.</span>    
encryptedBlocks = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 74.</span>    
n, e = key</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 75. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 76.</span>    
for block in getBlocksFromText(message, blockSize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 77.</span>        
<span class=SourceCodeComment># ciphertext = plaintext ^ e mod n</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 78.</span>        
encryptedBlocks.append(pow(block, e, n))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 79.</span>    
return encryptedBlocks</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 80. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 81. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 82.</span>
def decryptMessage(encryptedBlocks, messageLength, key, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 83.</span>    
<span class=SourceCodeComment># Decrypts a list of encrypted block ints into
the original message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 84.</span>    
<span class=SourceCodeComment># string. The original message length is required
to properly decrypt</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 85.</span>    
<span class=SourceCodeComment># the last block. Be sure to pass the PRIVATE key
to decrypt.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 86.</span>    
decryptedBlocks = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 87.</span>    
n, d = key</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 88.</span>    
for block in encryptedBlocks:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 89.</span>        
<span class=SourceCodeComment># plaintext = ciphertext ^ d mod n</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 90.</span>        
decryptedBlocks.append(pow(block, d, n))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 91.</span>    
return getTextFromBlocks(decryptedBlocks, messageLength, blockSize)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 92. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 93. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 94.</span>
def readKeyFile(keyFilename):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 95.</span>    
<span class=SourceCodeComment># Given the filename of a file that contains a
public or private key,</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 96.</span>    
<span class=SourceCodeComment># return the key as a (n,e) or (n,d) tuple value.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 97.</span>    
fo = open(keyFilename)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 98.</span>    
content = fo.read()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 99.</span>    
fo.close()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>100.</span>    
keySize, n, EorD = content.split(',')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>101.</span>    
return (int(keySize), int(n), int(EorD))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>102. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>103. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>104.</span>
def encryptAndWriteToFile(messageFilename, keyFilename, message, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>105.</span>    
<span class=SourceCodeComment># Using a key from a key file, encrypt the
message and save it to a</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>106.</span>    
<span class=SourceCodeComment># file. Returns the encrypted message string.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>107.</span>    
keySize, n, e = readKeyFile(keyFilename)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>108. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>109.</span>    
<span class=SourceCodeComment># Check that key size is greater than block size.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>110.</span>    
if keySize &lt; blockSize * 8: <span class=SourceCodeComment># * 8 to convert
bytes to bits</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>111.</span>        
sys.exit('ERROR: Block size is %s bits and key size is %s bits. The RSA cipher
requires the block size to be equal to or less than the key size. Either increase
the block size or use different keys.' % (blockSize * 8, keySize))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>112.</span>    
</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>113. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>114.</span>    
<span class=SourceCodeComment># Encrypt the message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>115.</span>    
encryptedBlocks = encryptMessage(message, (n, e), blockSize)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>116. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>117.</span>    
<span class=SourceCodeComment># Convert the large int values to one string
value.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>118.</span>    
for i in range(len(encryptedBlocks)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>119.</span>        
encryptedBlocks[i] = str(encryptedBlocks[i])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>120.</span>    
encryptedContent = ','.join(encryptedBlocks)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>121. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>122.</span>    
<span class=SourceCodeComment># Write out the encrypted string to the output
file.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>123.     </span>encryptedContent
= '%s_%s_%s' % (len(message), blockSize, encryptedContent)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>124.</span>    
fo = open(messageFilename, 'w')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>125.</span>    
fo.write(encryptedContent)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>126.</span>    
fo.close()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>127.</span>    
<span class=SourceCodeComment># Also return the encrypted string.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>128.</span>    
return encryptedContent</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>129. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>130. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>131.</span>
def readFromFileAndDecrypt(messageFilename, keyFilename):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>132.</span>    
<span class=SourceCodeComment># Using a key from a key file, read an encrypted
message from a file</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>133.</span>    
<span class=SourceCodeComment># and then decrypt it. Returns the decrypted
message string.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>134.</span>    
keySize, n, d = readKeyFile(keyFilename)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>135.</span>    
</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>136. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>137.</span>    
<span class=SourceCodeComment># Read in the message length and the encrypted
message from the file.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>138.</span>    
fo = open(messageFilename)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>139.</span>    
content = fo.read()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>140.</span>    
messageLength, blockSize, encryptedMessage = content.split('_')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>141.</span>    
messageLength = int(messageLength)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>142.</span>    
blockSize = int(blockSize)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>143. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>144.</span>    
<span class=SourceCodeComment># Check that key size is greater than block size.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>145.</span>    
if keySize &lt; blockSize * 8: <span class=SourceCodeComment># * 8 to convert
bytes to bits</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>146.</span>        
sys.exit('ERROR: Block size is %s bits and key size is %s bits. The RSA cipher
requires the block size to be equal to or less than the key size. Did you
specify the correct key file and encrypted file?' % (blockSize * 8, keySize))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>147. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>148.</span>    
<span class=SourceCodeComment># Convert the encrypted message into large int
values.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>149.</span>  
  encryptedBlocks = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>150.</span>    
for block in encryptedMessage.split(','):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>151.</span>        
encryptedBlocks.append(int(block))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>152. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>153.</span>    
<span class=SourceCodeComment># Decrypt the large int values.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>154.</span>    
return decryptMessage(encryptedBlocks, messageLength, (n, d), blockSize)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>155. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>156. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>157.</span> <span
class=SourceCodeComment># If rsaCipher.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>158.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>159.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>160.</span>    
main()</p>

</div>

<h2><a name="_Toc353630960">Sample Run of the RSA Cipher Program</a></h2>

<p class=MsoNormal>Once you have a public and private key file, you can send
anyone your public file (or post it somewhere online) so others can send you
messages. If you want to send a secret message to someone, first get their
public key file and place it in the same directory as the <span class=Filename>rsaCipher.py</span>
program. Set the <span class=Literal>message</span> variable on line 19 to the
string of the message to encrypt.</p>

<p class=MsoNormal>Make sure the <span class=Literal>mode</span> variable is
set to the string <span class=Literal>'encrypt'</span> on line 16, and set the <span
class=Literal>pubKeyFilename</span> variable to the public key file’s filename
on line 20. The <span class=Literal>filename</span> variable holds a string of
the file that the ciphertext will be written to.</p>

<p class=MsoNormal>When you run the program, the output will look like this:</p>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Encrypting and writing to encrypted_file.txt...</p>

<p class=SampleRunCxSpMiddle>Encrypted text:</p>

<p class=SampleRunCxSpLast>262_128_9926158891891412924886952141356136142542943862695072991250598006600270898300155338706636681856461575090075284572263362618218739769545313477249608401485234147843064609273929706353514554444810285427183303767133366827434264155196422091782649929928244535021903927052585385716925680743931745588143336997344189661596414349468058963048024948132923217849247276941269579027325396701709129191510084539012275457327046892059514600198713235394985023008043572425418307615110483262279656839322893000061931573893934153492056320331481641996204470201622784975235041470244964996075123464854629954207517620745550909143567815440815430367,6684261355384175628979536129678576912290902989264360857554803434400959272554726558432523319331127651229226379236001569105754247234449664301393066887072563919911914664504822721492217530056774346964092597494522555496959638903763181124233744530745204194891726109468870800424574799803024463576184984561160905385692143883155534327512132834866466005840402451465709012175029417109925035724824080741967623225446680099823178790059243202224297039960462494558200472899766913932921695002362188199621771371349477094464441789497029364384034674419241261434600801973782901186703144271104078294839144290043228508639879193883889311384,7277016624458973047704080668015657545528557043555314379029981553323365606133331342297139093317529026058177734586887567745897370142270546218412444852855142060252694055284415945350850536174716382559790627193026256934316461174349640238168693204610463496242533658473621140628689617878612045411645907503868803711923465905950382446525719000159190942639677572746105141288262702033570490198413350331921834181220670294175801373024013553583624428117568253845170657841567369678118510784447456725765265002966285445904361732332706663086388760638687504068870937711285114415078149377285832325922978358897651126143551277531003851780</p>

</div>

<p class=MsoNormal>At the start of the text is 262 (which is the original
message length), followed by an underscore and then 128 (which is the “block
size”; block sizes are explained later). If you look carefully at the long
string of digits after that, you will find two commas. The message is encrypted
into three very large integers, separated by commas. These integers are the
encrypted form of the string in the <span class=Literal>message</span> variable
on line 19.</p>

<p class=MsoNormal>To decrypt, change the <span class=Literal>mode</span>
variable to <span class=Literal>'decrypt'</span> and run the program again.
Make sure <span class=Literal>privKeyFilename</span> on line 28 is set to the
filename of the private key file and that this file is in the same folder as <span
class=Filename>rsaCipher.py</span>. When you run the program, the output on the
screen will look like this:</p>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Reading from encrypted_file.txt and decrypting...</p>

<p class=SampleRunCxSpMiddle>Decrypted text:</p>

<p class=SampleRunCxSpLast>&quot;Journalists belong in the gutter because that
is where the ruling classes throw their guilty secrets.&quot; -Gerald
Priestland &quot;The Founding Fathers gave the free press the protection it
must have to bare the secrets of government and inform the people.&quot; -Hugo
Black</p>

</div>

<p class=MsoNormal>Note that the way the RSA cipher program is implemented, it
can only encrypt and decrypt <span class=Definition><span style='font-size:
12.0pt;line-height:115%'>plaintext files</span></span>. A plaintext file (not
to be confused with “plaintext” in the cryptography sense) is a file that only
contains text characters (like the kind that you can type on your keyboard).
For example, the .py files that you type for your Python programs are plaintext
files. Plaintext files are the type created with text editor software such as
Notepad (on Windows), TextMate (on OS X), or Gedit (on Ubuntu). Specifically,
plaintext files are files that only contain ASCII values (which are described
later in this chapter).</p>

<p class=MsoNormal>Files such as images, videos, executable programs, or word
processor files are called <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>binary files</span></span>.(Word processor files are binary
files because their text has font, color, and size information bundled with the
text.) More information about plaintext files and binary files can be found at <span
class=URL><u>http://invpy.com/plainvsbinary</u></span>.</p>

<h2><a name="_Toc353630961">Practice Exercises, Chapter 24, Set A</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice24A</u></span>.</p>

<h2><a name="_Toc353630962">Digital Signatures</a></h2>

<p class=MsoNormal>Digital signatures is a very large topic of its own, but we
can cover a little of it here. Let’s say Alice sent this email to Bob:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
margin-left:1.0in;margin-right:1.0in'>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>From:
alice@inventwithpython.com</span></p>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>To:
bob@coffeeghost.net</span></p>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>Subject: Our
agreement.</span></p>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>&nbsp;</span></p>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>Dear Bob,</span></p>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>I promise to
buy your old broken laptop for one million dollars.</span></p>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>&nbsp;</span></p>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>Sincerely,</span></p>

<p class=MessageText style='margin-bottom:0in;margin-bottom:.0001pt;border:
none;padding:0in'><span style='font-size:10.0pt;line-height:115%'>Alice</span></p>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This is great news to Bob, who wants to get rid of his
worthless laptop for any price. But what if Alice later claims that she didn’t
make this promise, and that the email Bob has is a forgery that didn’t really
come from her. The email just exists as some file on Bob’s computer. Bob could
have easily created this file himself.</p>

<p class=MsoNormal>If they had met in person, Alice and Bob could have signed a
contract. The handwritten signature is not easy to forge and provides some
proof that Alice really did make this promise. But even if Alice signed such a
paper, took a photo of it with her digital camera, and sent Bob the image file,
it is still believable for Alice to say that the image was photoshopped.</p>

<p class=MsoNormal>The RSA cipher (and any public key cipher) not only provides
encryption, but it can also provide a way to <em><span style='font-family:"Calibri","sans-serif"'>digitally
sign</span></em> a file or string. Remember that RSA has a public key and a
private key, and that any string that is encrypted with one key produces
ciphertext that can only be decrypted with the other key. Normally we encrypt
with the public key, so that only the owner of the private key can decrypt this
ciphertext.</p>

<p class=MsoNormal>But we can also do the reverse. If Alice writes this
message, and then “encrypts” it with her <em><span style='font-family:"Calibri","sans-serif"'>private
key</span></em>, this will produce “ciphertext” that only Alice’s public key
can decrypt. This “ciphertext” isn’t really so secret since everyone in the
world has access to Alice’s public key to decrypt it. <strong><span
style='font-family:"Calibri","sans-serif"'>But by encrypting a message with her
own private key, Alice has digitally signed the message in a way that cannot be
forged.</span></strong> Everyone can decrypt this signed message with her
public key, and since only Alice has access to her private key, only Alice could
have produced this ciphertext. Alice has to stick to her digital signature; she
can’t say that Bob forged or photoshopped it!</p>

<p class=MsoNormal>This feature is called nonrepudiation. <span
class=Definition><span style='font-size:12.0pt;line-height:115%'>Nonrepudiation</span></span>
is where someone who has made a statement or claim cannot later refute that
they made that statement or claim. Alice could always claim that her computer
was hacked and somebody else had access to her private key, but this would mean
that any other documents she signed could be called into question. (And it
would be very suspicious if Alice’s computer kept “getting hacked” each time
she wanted to back out of a promise.)</p>

<p class=MsoNormal>Digital signatures can also provide authentication, which
allows someone to prove they are who they say they are. If Alice gets an email claiming
to be from the President but wants to be sure it really is the President, she
could always respond with, “Prove you’re the President! Encrypt the string 'SIMTAVOKXVAHXXSLBGZXVPKNMQMHOYGWFQMXEBCC'
with the President’s private key.” and Alice would be able to decrypt the reply
with the President’s public key to see if it decrypted to her random string.
This is called a <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>challenge-response authentication</span></span> system.</p>

<p class=MsoNormal>Digital signatures can be used to do many important things,
including digital cash, authentication of public keys, or anonymous web
surfing. If you’d like to find out more, go to <span class=URL><u>http://invpy.com/digitalsignatures</u></span>.</p>

<h2><a name="_Toc353630963">How the RSA Cipher Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>  1.</span> <span
class=SourceCodeComment># RSA Cipher</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  4.</span>
import sys</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  5.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  6.</span> <span
class=SourceCodeComment># IMPORTANT: The block size MUST be less than or equal to
the key size!</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  7.</span> <span
class=SourceCodeComment># (Note: The block size is in bytes, the key size is in
bits. There</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  8.</span> <span
class=SourceCodeComment># are 8 bits in 1 byte.)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  9.</span> DEFAULT_BLOCK_SIZE
= 128 <span class=SourceCodeComment># 128 bytes</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 10.</span> BYTE_SIZE
= 256 <span class=SourceCodeComment># One byte has 256 different values.</span></p>

</div>

<p class=MsoNormal>A single “byte” can hold a number between 0 and 255, that
is, 256 different numbers. We will use this fact in some of the block-related
math explained later. This is why the <span class=Literal>BYTE_SIZE</span>
constant is set to <span class=Literal>256</span>. The <span class=Literal>DEFAULT_BLOCK_SIZE</span>
constant is set to <span class=Literal>128</span> because we will be using
block sizes of 128 bytes by default in our program. (Block sizes are explained
later.)</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 12.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 13.</span>    
<span class=SourceCodeComment># Runs a test that encrypts a message to a file
or decrypts a message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 14.</span>    
<span class=SourceCodeComment># from a file.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 15.</span>    
filename = 'encrypted_file.txt' <span class=SourceCodeComment># the file to
write to/read from</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 16.</span>    
mode = 'encrypt' <span class=SourceCodeComment># set to 'encrypt' or 'decrypt'</span></p>

</div>

<p class=MsoNormal>If <span class=Literal>mode</span> is set to <span
class=Literal>'encrypt'</span> the program encrypts a message (and writes it to
the file that is named in <span class=Literal>filename</span>). If <span
class=Literal>mode</span> is set to <span class=Literal>'decrypt'</span> the
program reads the contents of an encrypted file (specified by the string in <span
class=Literal>filename</span>) to decrypt it.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 18.</span>    
if mode == 'encrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 19.</span>        
message = '''&quot;Journalists belong in the gutter because that is where the
ruling classes throw their guilty secrets.&quot; -Gerald Priestland &quot;The
Founding Fathers gave the free press the protection it must have to bare the
secrets of government and inform the people.&quot; -Hugo Black'''</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 20.</span>        
pubKeyFilename = 'al_sweigart_pubkey.txt'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 21.</span>        
print('Encrypting and writing to %s...' % (filename))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 22.</span>        
encryptedText = encryptAndWriteToFile(filename, pubKeyFilename, message)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 23. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 24.</span>        
print('Encrypted text:')</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 25.</span>        
print(encryptedText)</p>

</div>

<p class=MsoNormal>The <span class=Literal>message</span> variable contains the
text to be encrypted, and <span class=Literal>pubKeyFilename</span> contains
the filename of the public key file. Line 22 calls the <span class=Literal>encryptAndWriteToFile()</span>
function, which will encrypt <span class=Literal>message</span> using the key,
and write the encrypted message to the file named in <span class=Literal>filename</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 27.</span>    
elif mode == 'decrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 28.</span>        
privKeyFilename = 'al_sweigart_privkey.txt'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 29.</span>        
print('Reading from %s and decrypting...' % (filename))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 30.</span>        
decryptedText = readFromFileAndDecrypt(filename, privKeyFilename)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 31. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 32.</span>        
print('Decrypted text:')</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 33.</span>        
print(decryptedText)</p>

</div>

<p class=MsoNormal>The code that handles calling the decryption function is
similar to the code on lines 18 to 33. The filename of the private key file is
set in <span class=Literal>privKeyFilename</span>. The encrypted file’s
filename is stored in the <span class=Literal>filename</span> variable. These
two variables are passed to a call to <span class=Literal>readFromFileAndDecrypt()</span>.
The return value is stored in <span class=Literal>decryptedText</span> and then
printed to the screen.</p>

<h2><a name="_Toc353630964">ASCII: Using Numbers to Represent Characters</a></h2>

<p class=MsoNormal>All data is stored on your computer as numbers. A code
called the American Standard Code for Information Interchange, or ASCII
(pronounced “ask-ee”) maps numbers to characters. Table 24-1 shows how ASCII
maps numbers and characters (only numbers 32 to 126 are used):</p>

<p class=TableCaption>Table 24-1. The ASCII table.</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=67 style='width:40.2pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'>32</p>
  </td>
  <td width=71 style='width:42.6pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'>(space)</p>
  </td>
  <td width=67 style='width:40.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'>48</p>
  </td>
  <td width=57 style='width:34.0pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'><span class=Literal>0</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'>64</p>
  </td>
  <td width=59 style='width:35.1pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'><span class=Literal>@</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'>80</p>
  </td>
  <td width=63 style='width:37.55pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'><span class=Literal>P</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'>96</p>
  </td>
  <td width=66 style='width:39.3pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'><span class=Literal>`</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'>112</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-top:1.0pt'><span class=Literal>p</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>33</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>!</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>49</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>1</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>65</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>A</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>81</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>Q</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>97</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>a</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>113</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>q</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>34</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>&quot;</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>50</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>2</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>66</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>B</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>82</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>R</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>98</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>b</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>114</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>r</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>35</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>#</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>51</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>3</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>67</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>C</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>83</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>S</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>99</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>c</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>115</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>s</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>36</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>$</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>52</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>4</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>68</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>D</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>84</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>T</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>100</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>d</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>116</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>t</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>37</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>%</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>53</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>5</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>69</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>E</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>85</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>U</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>101</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>e</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>117</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>u</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>38</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>&amp;</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>54</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>6</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>70</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>F</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>86</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>V</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>102</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>f</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>118</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>v</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>39</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>'</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>55</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>7</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>71</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>G</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>87</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>W</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>103</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>g</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>119</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>w</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>40</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>(</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>56</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>8</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>72</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>H</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>88</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>X</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>104</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>h</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>120</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>x</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>41</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>)</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>57</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>9</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>73</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>I</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>89</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>Y</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>105</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>i</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>121</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>y</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>42</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>*</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>58</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>:</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>74</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>J</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>90</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>Z</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>106</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>j</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>122</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>z</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>43</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>+</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>59</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>;</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>75</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>K</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>91</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>[</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>107</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>k</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>123</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>{</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>44</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>,</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>60</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>&lt;&nbsp;</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>76</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>L</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>92</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>\</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>108</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>l</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>124</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>|</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>45</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>-</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>61</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>=</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>77</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>M</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>93</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>]</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>109</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>m</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>125</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>46</p>
  </td>
  <td width=71 style='width:42.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>.</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>62</p>
  </td>
  <td width=57 style='width:34.0pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>&gt;&nbsp;</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>78</p>
  </td>
  <td width=59 style='width:35.1pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>N</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>94</p>
  </td>
  <td width=63 style='width:37.55pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>^</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>110</p>
  </td>
  <td width=66 style='width:39.3pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>n</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>126</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing><span class=Literal>~</span></p>
  </td>
 </tr>
 <tr>
  <td width=67 style='width:40.2pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'>47</p>
  </td>
  <td width=71 style='width:42.6pt;border-top:none;border-left:none;border-bottom:
  double windowtext 1.5pt;border-right:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'><span class=Literal>/</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'>63</p>
  </td>
  <td width=57 style='width:34.0pt;border-top:none;border-left:none;border-bottom:
  double windowtext 1.5pt;border-right:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'><span class=Literal>?</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'>79</p>
  </td>
  <td width=59 style='width:35.1pt;border-top:none;border-left:none;border-bottom:
  double windowtext 1.5pt;border-right:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'><span class=Literal>O</span></p>
  </td>
  <td width=67 style='width:40.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'>95</p>
  </td>
  <td width=63 style='width:37.55pt;border-top:none;border-left:none;
  border-bottom:double windowtext 1.5pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'><span class=Literal>_</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'>111</p>
  </td>
  <td width=66 style='width:39.3pt;border-top:none;border-left:none;border-bottom:
  double windowtext 1.5pt;border-right:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'><span class=Literal>o</span></p>
  </td>
  <td width=73 style='width:44.0pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'>&nbsp;</p>
  </td>
  <td width=69 style='width:41.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing style='margin-bottom:2.0pt'><span class=Literal>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>A single ASCII character uses one byte of memory to store. A
byte is enough memory to store a number from 0 to 255 (for a total of 256
different values.) So the string <span class=Literal>'Hello'</span> is actually
stored on your computer as the numbers 72, 101, 108, 108, and 111. These
numbers take up 5 bytes. ASCII provides a standard way to convert string
characters to numbers and back.</p>

<p class=MsoNormal>ASCII works fine for English messages, but not so much for
other European languages that have special characters such as the è in
“Vigenère”, or languages such as Chinese and Arabic. ASCII doesn’t even work
well outside of America, since ASCII includes the $ dollar sign but not the €
euro or £ pound signs. If you want to learn about Unicode, the international
system of character encoding, go to <span class=URL><u>http://invpy.com/unicode</u></span>.
But this book will use ASCII for simplicity.</p>

<h2><a name="_Toc353630965">The </a><span class=Literal>chr()</span> and <span
class=Literal>ord()</span> Functions</h2>

<p class=MsoNormal>Remember from the first chapter where a code was a
publicly-known way of translating information from one format to another
format? For example, Morse code was a way of translating English letters into
electric pulses of dots and dashes. ASCII is just a code. We can encode
characters into ASCII numbers and decode ASCII numbers back to characters.</p>

<p class=MsoNormal>The <span class=Literal>chr()</span> function (pronounced
“char”, short for “character”) takes an integer ASCII number as the argument
and returns a single-character string. The <span class=Literal>ord()</span>
function (short for “ordinal”) takes a single-character string as the argument,
and returns the integer ASCII value for that character. Try typing the
following into the interactive shell:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
chr(65)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>'A'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
ord('A')</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>65</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
chr(73)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>'I'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
chr(65+8)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>'I'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
chr(52)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>'4'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
chr(ord('F'))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>'F'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
ord(chr(68))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>68</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>But if you have a string with many letters, it may be easier
to use the <span class=Literal>encode()</span> and <span class=Literal>decode()</span>
string methods explained later in this chapter.</p>

<h2><a name="_Toc353630966">Practice Exercises, Chapter 24, Set B</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice24B</u></span>.</p>

<h2><a name="_Toc353630967">Blocks</a></h2>

<p class=MsoNormal>In cryptography, a “block” is a fixed length of bits. In our
RSA cipher program, a block is represented by an integer. We’ve set the block
size to 128 bytes, or 1024 bits (since there are 8 bits in 1 byte). Our message
string value will be converted into several integer values (i.e. several
blocks).</p>

<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:
Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>It is important to note that the RSA encryption algorithm
requires that <strong>the block size be equal or less than the key size</strong>.
Otherwise, the math doesn’t work and you won’t be able to decrypt the
ciphertext the program produced.</p>

<p class=MsoNormal>So a cryptographic block is really just a very large
integer. Since our block size is 128 bytes, it can represent any integer
between 0 and up to (but not including) 256 ^ 128, which is 179,769,313,486,231,590,772,930,519,078,902,473,361,797,697,894,230,657,273,430,081,157,732,675,805,500,963,132,708,477,322,407,536,021,120,113,879,871,393,357,658,789,768,814,416,622,492,847,430,639,474,124,377,767,893,424,865,485,276,302,219,601,246,094,119,453,082,952,085,005,768,838,150,682,342,462,881,473,913,110,540,827,237,163,350,510,684,586,298,239,947,245,938,479,716,304,835,356,329,624,224,137,216.</p>

<p class=MsoNormal><span style='font-size:9.0pt;line-height:115%'>(You might
have noticed that the RSA cipher uses a lot of big numbers.)</span></p>

<p class=MsoNormal>The reason RSA needs to work on a block (which represents
multiple characters) is because if we used the RSA encryption algorithm on a
single character, the same plaintext characters would always encrypt to the
same ciphertext characters. In that case, the RSA cipher just becomes a simple
substitution cipher with fancy mathematics, kind of like the affine and Caesar ciphers.</p>

<p class=MsoNormal>The RSA cipher works by encrypting an integer that is
hundreds of digits long (that is, a block) into a new integer that is hundreds
of digits long (that is, a new block). The mathematics of encrypting a large plaintext
integer to a large ciphertext integer are simple enough. But first we will need
a way to convert between a string and a large integer (that is, a block).</p>

<p class=MsoNormal>We can use ASCII as a system to convert between a single
character and a small integer (between 0 and 255). But we will also need a way
to combine several small integers into a large integer that we perform RSA
encryption on.</p>

<p class=MsoNormal>Remember how the affine cipher in Chapter 15 had two keys,
Key A and Key B, but they were combined by multiplying Key A by the symbol set
size (which was 95) and then adding Key B? This was how we combined two small
key integers into one larger key integer.</p>

<p class=MsoNormal>This worked because the ranges of both Key A and Key B were
from 0 to 94. In the RSA program, each character’s ASCII integer ranges from 0
to 255. To combine ASCII integers together into one large number we use the
following formula:</p>

<p class=MsoNormal>Take the ASCII integer of the character at index <span
class=Literal>0</span> of the string and multiply it by 256 ^ 0 (but since 256
^ 0 is 1, and multiplying by 1 leaves you with just the original number, this
one is easy). Take the ASCII integer of the character at index <span
class=Literal>1</span> and multiply it by 256 ^ 1. Take the ASCII integer of
the character at index <span class=Literal>2</span> and multiply it by 256 ^ 2,
and so on and so on. To get the final large integer, add all of these products
together. This integer is the ciphertext’s block.</p>

<p class=MsoNormal>Table 24-2 has an example using the string, <span
class=Literal>'Hello world!'</span>:</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Calibri","sans-serif"'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=TableCaption>Table 24-2. Encoding a string into a block.</p>

<div align=center>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0 width=685
 style='width:410.85pt;margin-left:41.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=60 valign=top style='width:.5in;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Index</p>
  </td>
  <td width=90 valign=top style='width:.75in;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Character</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>ASCII Number</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Multiplied By</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Number</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>0</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>H</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>72</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 0</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 72</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>1</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>e</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>101</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 1</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 25,856</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>2</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>l</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>108</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 2</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 7,077,888</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>3</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>l</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>108</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 3</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 1,811,939,328</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>4</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>o</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>111</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 4</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 476,741,369,856</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>5</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>(space)</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>32</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 5</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 35,184,372,088,832</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>6</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>w</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>119</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 6</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 33,495,522,228,568,064</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>7</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>o</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>111</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 7</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 7,998,392,938,210,000,896</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>8</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>r</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>114</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 8</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 2,102,928,824,402,888,884,224</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>9</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>l</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>108</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 9</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 510,015,580,149,921,683,079,168</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>10</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>d</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>100</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 10</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 120,892,581,961,462,917,470,617,600</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>11</p>
  </td>
  <td width=90 valign=top style='width:.75in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>!</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>33</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>×  256 ^ 11</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>= 10,213,005,324,104,387,267,917,774,848</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:.5in;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>&nbsp;</p>
  </td>
  <td width=90 valign=top style='width:.75in;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>&nbsp;</p>
  </td>
  <td width=84 valign=top style='width:50.15pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  </td>
  <td width=106 valign=top style='width:63.7pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>SUM:</p>
  </td>
  <td width=345 valign=top style='width:207.0pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>10,334,410,032,606,748,633,331,426,632</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:9.0pt;line-height:115%'>(You might
have noticed that the RSA cipher does a lot of math with big numbers.)</span></p>

<p class=MsoNormal>So the string <span class=Literal>'Hello world!'</span> when
put into a single large integer “block” becomes the integer 10,334,410,032,606,748,633,331,426,632.
This integer uniquely refers to the string <span class=Literal>'Hello world!'</span>.
By continuing to use larger and larger powers of 256, any string possible has
exactly one large integer. For example, 2,175,540 is the integer for <span
class=Literal>'42!'</span> and 17,802,628,493,700,941 is the integer for <span
class=Literal>'Moose??'</span> and 23,071,981,395,336,227,453,293,155,570,939,985,398,502,658,016,284,755,880,397,214,576,110,064,091,578,359,739,349,325
is the integer for <span class=Literal>'My cat's breath smells like cat food.'</span>.</p>

<p class=MsoNormal>Because our block size is 128 bytes, we can only encrypt up
to 128 characters in a single block. But we can just use more blocks if the
message is longer than 128 characters. The RSA cipher program will separate the
blocks it outputs with commas so we can tell when one block ends and the next
one begins.</p>

<p class=MsoNormal>As an example, here’s a message that is split into blocks,
and the integer that represents each block (calculated using the same method in
Table 24-2.). Each block has at most 128 characters of the message.</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Calibri","sans-serif"'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=TableCaption>Table 24-3. A message split into blocks, with each
block’s integer.</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=144 valign=top style='width:1.2in;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>&nbsp;</p>
  </td>
  <td width=195 valign=top style='width:117.0pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Message</p>
  </td>
  <td width=399 valign=top style='width:239.4pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Block Integer</p>
  </td>
 </tr>
 <tr>
  <td width=144 valign=top style='width:1.2in;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>1<sup>st</sup> Block</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(128 characters)</p>
  </td>
  <td width=195 valign=top style='width:117.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Alan Mathison Turing was a British mathematician, logician,
  cryptanalyst, and computer scientist. He was highly influential in t</p>
  </td>
  <td width=399 valign=top style='width:239.4pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>81546931218178010029845817915569188970228635035880924048568611897988742463406567023883943221582747883194198801889762995126820043055718365161172430048774726604180301487686042582446510742004253320139858568955596950639178360628971132804888925435112531133886746309774148590001157056903849858716430520524535327809</p>
  </td>
 </tr>
 <tr>
  <td width=144 valign=top style='width:1.2in;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>2<sup>nd</sup> Block</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(128 characters)</p>
  </td>
  <td width=195 valign=top style='width:117.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>he development of computer science, providing a formalisation of the
  concepts of &quot;algorithm&quot; and &quot;computation&quot; with the Turing
  m</p>
  </td>
  <td width=399 valign=top style='width:239.4pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>76631289268154712859022451851447083030531656773493193435586385884713450374043199564593208509316042234996861905222506249242068799766044149679741160521638235464390814933437480918921110848346820082794989525095472576883441558434022389690224894703002514434767442075089828357797890134106785932701869224970151814504</p>
  </td>
 </tr>
 <tr>
  <td width=144 valign=top style='width:1.2in;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>3<sup>rd</sup> Block</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(128 characters)</p>
  </td>
  <td width=195 valign=top style='width:117.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>achine. Turing is widely considered to be the father of computer
  science and artificial intelligence. During World War II, Turin</p>
  </td>
  <td width=399 valign=top style='width:239.4pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>77533874832922662837221187157031815413218696656188289479237285042329317929987590255656863216170413017929282537609866464073913897327838474709028475738093888688583459781662724944601473582838586714473965254498913751782047828043527094001429567417501493130489686652467441331220556610652015232230994266943673361249</p>
  </td>
 </tr>
 <tr>
  <td width=144 valign=top style='width:1.2in;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>4<sup>th</sup> Block</p>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(107 characters)</p>
  </td>
  <td width=195 valign=top style='width:117.0pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>g worked for the Government Code and Cypher School (GCCS) at
  Bletchley Park, Britain's codebreaking centre.</p>
  </td>
  <td width=399 valign=top style='width:239.4pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>87080208891262703930798322686594857958157735191131124701299945788118904302570291378810871619692196042841627479667133454733264625727703476738415017881880631980435061770341231617044485961511191333330447714267734389115735407982254796472640732348730838206586983</p>
  </td>
 </tr>
</table>

<h2><a name="_Toc353630968">Converting Strings to Blocks with </a><span
class=Literal>getBlocksFromText()</span></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 36.</span>
def getBlocksFromText(message, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 37.</span>    
<span class=SourceCodeComment># Converts a string message to a list of block
integers. Each integer</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 38.</span>    
<span class=SourceCodeComment># represents 128 (or whatever blockSize is set
to) string characters.</span></p>

</div>

<p class=MsoNormal>The <span class=Literal>getBlocksFromText()</span> function takes
the message and returns a list of blocks (that is, a list of very large integer
values) that represents the message. It is trivially easy to convert between
strings to blocks and blocks to strings, so this step isn’t encrypting
anything. The encryption will be done later in the <span class=Literal>encryptMessage()</span>
function.</p>

<h2><a name="_Toc353630969">The </a><span class=Literal>encode()</span> String
Method and the Bytes Data Type</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 40.</span><span
class=SourceCodeComment><span style='color:windowtext'>     messageBytes =
message.encode('ascii') </span># convert the string to bytes</span></p>

</div>

<p class=MsoNormal>First, we need to convert the characters in the message
string into ASCII integers. The <span class=Literal>encode()</span> string method
will return a “bytes” object. Because a byte is represented as a number from 0
to 255, a bytes value is like a list of integers (although these integers have
a very limited range of 0 to 255). The <span class=Literal>len()</span>
function and indexing work with a bytes object in the same way a list of
integers would. A bytes value can be turned into a list value of integer values
by passing it to the <span class=Literal>list()</span> function. Try typing the
following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = 'hello'.encode('ascii')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
lang=DE>&gt;&gt;&gt; spam</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
lang=DE>b'hello'</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
lang=DE>&gt;&gt;&gt; list(spam)</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
lang=DE>[104, 101, 108, 108, 111]</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
lang=DE>&gt;&gt;&gt; len(spam)</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>5</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam[2]</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>108</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>Note that a single bytes value is a collection of values,
just like a single list value can contain multiple values. If you try to get a
single “byte” from a bytes object (like <span class=Literal>spam[2]</span> does
above), this just evaluates to an integer value.</p>

<p class=MsoNormal>Line 40 places the bytes form of the <span class=Literal>message</span>
string in a variable named <span class=Literal>messageBytes</span>.</p>

<h2><a name="_Toc353630970">The </a><span class=Literal>bytes()</span> Function
and <span class=Literal>decode()</span> Bytes Method</h2>

<p class=MsoNormal>Just like you can create a list by calling the <span
class=Literal>list()</span> function, you can also create a bytes object by
calling the <span class=Literal>bytes()</span> function. The <span
class=Literal>bytes()</span> function is passed a list of integers for the byte
values. Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = bytes([104, 101, 108, 108, 111])</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>b'hello'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
list(spam)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>[104, 101,
108, 108, 111]</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>You can also directly type a bytes object into your source
code just like you type a string or list. A bytes object has the letter b right
before what looks like an ordinary string value. But remember, the letter b
right before the quotes means that this is a bytes value, not a string value.
Try typing the following into the interactive shell, making sure that there is
no space between the b and the quote characters:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = b'hello'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
list(spam)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>[104, 101,
108, 108, 111]</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>We don’t use the <span class=Literal>decode()</span> bytes
method in this program, but you should know about it. It does the opposite of
the <span class=Literal>encode()</span> string method. When called on a bytes
object, the <span class=Literal>decode()</span> method returns a string made
from the values stored in the bytes object. Try typing the following into the
interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = bytes([104, 101, 108, 108, 111])</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam.decode('ascii')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'hello'</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<h2><a name="_Toc353630971">Practice Exercises, Chapter 24, Set C</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice24C</u></span>.</p>

<h2><a name="_Toc353630972">Back to the Code</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 42.</span><span
class=SourceCodeComment><span style='color:windowtext'>     blockInts = []</span></span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 43.</span><span
class=SourceCodeComment><span style='color:windowtext'>     for blockStart in
range(0, len(messageBytes), blockSize):</span></span></p>

</div>

<p class=MsoNormal>The <span class=Literal>blockInts</span> list will contain
the large integer “blocks” form of the characters in <span class=Literal>message</span>.
The <span class=Literal>blockSize</span> parameter is set to <span
class=Literal>DEFAULT_BLOCK_SIZE</span> by default, and the <span
class=Literal>DEFAULT_BLOCK_SIZE</span> constant was set to <span
class=Literal>128</span> (meaning, 128 bytes) on line 9. This means that each
large integer block can only store 128 string characters at most (since 1 ASCII
character takes up 1 byte). See Table 24-3 for an example of a message split
into 128-character blocks.</p>

<p class=MsoNormal>Line 43’s <span class=Literal>for</span> loop will set the
value in <span class=Literal>blockStart</span> so that on each iteration it
will be set to the index of the block being created. For example, if <span
class=Literal>blockSize</span> is set to <span class=Literal>128</span>, then
the index of the start of the first block will be <span class=Literal>0</span>,
the index of the start of the second block will be <span class=Literal>128</span>,
the index of the start of the third block will be <span class=Literal>256</span>,
and so on as long as the index is less than <span class=Literal>len(messageBytes)</span>.</p>

<h2><a name="_Toc353630973">The </a><span class=Literal>min()</span> and <span
class=Literal>max()</span> Functions</h2>

<p class=MsoNormal>The <span class=Literal>min()</span> function returns the
smallest (that is, the minimum) value of its arguments. Try typing the
following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
min(13, 32, 13, 15, 17, 39)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>13</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
min(21, 45, 18, 10)</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>10</p>

</div>

<p class=MsoNormal>You can also pass <span class=Literal>min()</span> a single
argument if the argument is a list or tuple value. In this case, <span
class=Literal>min()</span> returns the smallest value in that list or tuple.
Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
min([31, 26, 20, 13, 12, 36])</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>12</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam = (10, 37, 37, 43, 3)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
min(spam)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>3</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>The <span class=Literal>max()</span> function will return
the largest (that is, the maximum) value of its arguments:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
max(18, 15, 22, 30, 31, 34)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>34</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 44.</span><span
class=SourceCodeComment><span style='color:windowtext'>         </span>#
Calculate the block integer for this block of text</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 45.</span><span
class=SourceCodeComment><span style='color:windowtext'>         blockInt = 0</span></span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 46.</span><span
class=SourceCodeComment><span style='color:windowtext'>         for i in
range(blockStart, min(blockStart + blockSize, </span></span>len(<span
class=SourceCodeComment><span style='color:windowtext'>messageBytes))):</span></span></p>

</div>

<p class=MsoNormal>The code inside line 43’s <span class=Literal>for</span>
loop will create the very large integer for a single block. Recall from earlier
in this chapter that this is done by multiplying the ASCII value of the
character by (256 ^ index-of-character).</p>

<p class=MsoNormal>The very large integer will eventually be stored in <span
class=Literal>blockInt</span>, which starts at <span class=Literal>0</span> on
line 45. (This is much like how our previous cipher programs had a <span
class=Literal>translated</span> variable that started as a blank string but
eventually held the encrypted or decrypted message by the end of the program.)
Line 46’s <span class=Literal>for</span> loop sets <span class=Literal>i</span>
to be the index of all the characters in <span class=Literal>message</span> <strong><span
style='font-family:"Calibri","sans-serif"'>for this block</span></strong>. This
index should start at <span class=Literal>blockStart</span> and go up to <span
class=Literal>blockStart + blockSize</span> (that is, <span class=Literal>blockSize</span>
characters after <span class=Literal>blockStart</span>) <em><span
style='font-family:"Calibri","sans-serif"'>or</span></em> <span class=Literal>len(messageBytes)</span>,
whichever is smaller. The <span class=Literal>min()</span> call on line 46 will
return the smaller of these two expressions.</p>

<p class=MsoNormal>The second argument to <span class=Literal>range()</span> on
line 46 should be the smaller of these values because each block will always be
made up of 128 (or whatever value is in <span class=Literal>blockSize</span>)
characters, <em><span style='font-family:"Calibri","sans-serif"'>except</span></em>
for the last block. The last block might be exactly 128 characters, but more
likely it is less than the full 128 characters. In that case we want <span
class=Literal>i</span> to stop at <span class=Literal>len(messageBytes)</span>
because that will be the last index in <span class=Literal>messageBytes</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 47.</span><span
class=SourceCodeComment><span style='color:windowtext'>             blockInt +=
messageBytes[i] * (BYTE_SIZE ** (i % blockSize))</span></span></p>

</div>

<p class=MsoNormal>The value that is added to the block integer in <span
class=Literal>blockInt</span> is the ASCII value of the character (which is
what <span class=Literal>messageBytes[i]</span> evaluates to) multiplied by
(256 ^ index-of-character). </p>

<p class=MsoNormal>The variable <span class=Literal>i</span> cannot directly be
used for the index-of-character part of the equation, because it is the index
in the entire <span class=Literal>messageBytes</span> object which has indexes
from <span class=Literal>0</span> up to <span class=Literal>len(messageBytes)</span>.
We only want the index relative to the <em><span style='font-family:"Calibri","sans-serif"'>current
iteration’s block</span></em>, which will always be from <span class=Literal>0</span>
to <span class=Literal>blockSize</span>. This table shows the difference
between these indexes:</p>

<p class=TableCaption>Table 24-4. The indexes of the full message on top, and
indexes relative to the block on bottom.</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=222 colspan=5 valign=top style='width:133.15pt;border-top:double windowtext 1.5pt;
  border-left:double windowtext 1.5pt;border-bottom:none;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>1<sup>st</sup> Block’s Indexes</p>
  </td>
  <td width=191 colspan=4 valign=top style='width:114.5pt;border-top:double windowtext 1.5pt;
  border-left:double windowtext 1.5pt;border-bottom:none;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>2<sup>nd</sup> Block’s Indexes</p>
  </td>
  <td width=183 colspan=4 valign=top style='width:109.65pt;border:double windowtext 1.5pt;
  border-bottom:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>3<sup>rd</sup> Block’s Indexes</p>
  </td>
 </tr>
 <tr>
  <td width=42 valign=top style='width:25.45pt;border-top:double windowtext 1.5pt;
  border-left:double windowtext 1.5pt;border-bottom:none;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>0</p>
  </td>
  <td width=42 valign=top style='width:25.45pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>1</p>
  </td>
  <td width=42 valign=top style='width:25.45pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>2</p>
  </td>
  <td width=46 valign=top style='width:27.75pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>…</p>
  </td>
  <td width=48 valign=top style='width:29.05pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>127</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border-top:double windowtext 1.5pt;
  border-left:double windowtext 1.5pt;border-bottom:none;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>129</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>130</p>
  </td>
  <td width=45 valign=top style='width:27.2pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>…</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>255</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border-top:double windowtext 1.5pt;
  border-left:double windowtext 1.5pt;border-bottom:none;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>257</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>258</p>
  </td>
  <td width=40 valign=top style='width:24.15pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>…</p>
  </td>
  <td width=46 valign=top style='width:27.3pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:none;border-right:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:2.0pt;margin-right:0in;
  margin-bottom:0in;margin-left:0in;margin-bottom:.0001pt;text-align:center;
  line-height:normal'>511</p>
  </td>
 </tr>
 <tr>
  <td width=42 valign=top style='width:25.45pt;border-top:none;border-left:
  double windowtext 1.5pt;border-bottom:double windowtext 1.5pt;border-right:
  none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>0</p>
  </td>
  <td width=42 valign=top style='width:25.45pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>1</p>
  </td>
  <td width=42 valign=top style='width:25.45pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>2</p>
  </td>
  <td width=46 valign=top style='width:27.75pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>…</p>
  </td>
  <td width=48 valign=top style='width:29.05pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>127</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border-top:none;border-left:double windowtext 1.5pt;
  border-bottom:double windowtext 1.5pt;border-right:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>0</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>1</p>
  </td>
  <td width=45 valign=top style='width:27.2pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>…</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>127</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border-top:none;border-left:double windowtext 1.5pt;
  border-bottom:double windowtext 1.5pt;border-right:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>0</p>
  </td>
  <td width=49 valign=top style='width:29.1pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>1</p>
  </td>
  <td width=40 valign=top style='width:24.15pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>…</p>
  </td>
  <td width=46 valign=top style='width:27.3pt;border-top:none;border-left:none;
  border-bottom:double windowtext 1.5pt;border-right:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>127</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='margin-top:12.0pt'>By modding <span class=Literal>i</span>
by <span class=Literal>blockSize</span>, we can get the position relative to
the block. This is why line 47 is <span class=Literal>BYTE_SIZE ** (i %
blockSize)</span> instead of <span class=Literal>BYTE_SIZE ** i</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 48.</span><span
class=SourceCodeComment><span style='color:windowtext'>        
blockInts.append(blockInt)</span></span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 49.</span><span
class=SourceCodeComment><span style='color:windowtext'>     return blockInts</span></span></p>

</div>

<p class=MsoNormal>After line 46’s <span class=Literal>for</span> loop
completes, the very large integer for the block has been calculated. We want to
append this block integer to the <span class=Literal>blockInts</span> list. The
next iteration of line 43’s <span class=Literal>for</span> loop will calculate
the block integer for the next block of the message.</p>

<p class=MsoNormal>After line 43’s <span class=Literal>for</span> loop has
finished, all of the block integers have been calculated and are stored in the <span
class=Literal>blockInts</span> list. Line 49 returns <span class=Literal>blockInts</span>
from <span class=Literal>getBlocksFromText()</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 52.</span>
def getTextFromBlocks(blockInts, messageLength, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 53.</span>    
<span class=SourceCodeComment># Converts a list of block integers to the
original message string.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 54.</span>    
<span class=SourceCodeComment># The original message length is needed to
properly convert the last</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 55.</span>    
<span class=SourceCodeComment># block integer.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 56.</span>    
message = []</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 57.</span>    
for blockInt in blockInts:</p>

</div>

<p class=MsoNormal>The <span class=Literal>getTextFromBlocks()</span> function
does the opposite of <span class=Literal>getBlocksFromText()</span>. This
function is passed a list of block integers (as the <span class=Literal>blockInts</span>
parameter) and returns the string value that these blocks represent. The
function needs the length of the message encoded in <span class=Literal>messageLength</span>,
since this information is needed to get the string from the last block integer
if it is not a full 128 characters in size.</p>

<p class=MsoNormal>Just as before, <span class=Literal>blockSize</span> will
default to <span class=Literal>DEFAULT_BLOCK_SIZE</span> if no third argument
is passed to <span class=Literal>getTextFromBlocks()</span>, and <span
class=Literal>DEFAULT_BLOCK_SIZE</span> was set to <span class=Literal>128</span>
on line 9.</p>

<p class=MsoNormal>The <span class=Literal>message</span> list (which starts as
blank on line 56) will contain a string value for each character that was
computed from each block integer in <span class=Literal>blockInts</span>. (This
list of strings will be joined together to form the complete string at the end
of <span class=Literal>getTextFromBlocks()</span>.) The <span class=Literal>message</span>
list starts off empty on line 56. The <span class=Literal>for</span> loop on
line 57 iterates over each block integer in the <span class=Literal>blockInts</span>
list.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 58.</span>        
blockMessage = []</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 59.</span>        
for i in range(blockSize - 1, -1, -1):</p>

</div>

<p class=MsoNormal>Inside the <span class=Literal>for</span> loop, the code
from lines 58 to 65 calculates the letters that are in the current iteration’s
block. Recall from Chapter 15’s affine cipher program how one integer key was
split into two integer keys:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'><span
class=SourceLineNumber>24.</span> def getKeyParts(key):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceLineNumber>25.</span>     keyA = key // len(SYMBOLS)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceLineNumber>26.</span>     keyB = key % len(SYMBOLS)</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'><span
class=SourceLineNumber>27.</span>     return (keyA, keyB)</p>

</div>

<p class=MsoNormal>The code in <span class=Literal>getTextFromBlocks()</span>
works in a similar way, except the single integer (i.e. the block integer) is
split into 128 integers (and each is the ASCII value for a single character).
The way the ASCII numbers are extracted from <span class=Literal>blockInt</span>
has to work backwards, which is why the <span class=Literal>for</span> loop on
line 59 starts at <span class=Literal>blockSize - 1</span>, and then subtracts <span
class=Literal>1</span> on each iteration down to (but not including) <span
class=Literal>-1</span>. This means the value of <span class=Literal>i</span> on
the last iteration will be <span class=Literal>0</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 60.</span>            
if len(message) + i &lt; messageLength:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 61.</span>                
<span class=SourceCodeComment># Decode the message string for the 128 (or
whatever</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 62.</span>                
<span class=SourceCodeComment># blockSize is set to) characters from this block
integer.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 63.</span>                
asciiNumber = blockInt // (BYTE_SIZE ** i)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 64.</span>                
blockInt = blockInt % (BYTE_SIZE ** i)</p>

</div>

<p class=MsoNormal>The length of the <span class=Literal>message</span> list
will be how many characters have been translated from blocks so far. The <span
class=Literal>if</span> statement on line 60 makes sure the code does not keep
computing text from the block after <span class=Literal>i</span> has reached
the end of the <span class=Literal>message</span>.</p>

<p class=MsoNormal>The ASCII number of the next character from the block is
calculated by integer dividing <span class=Literal>blockInt</span> by <span
class=Literal>(BYTE_SIZE ** i)</span>. Now that we have calculated this
character, we can “remove” it from the block by setting <span class=Literal>blockInt</span>
to the remainder of <span class=Literal>blockInt</span> divided by <span
class=Literal>(BYTE_SIZE ** i)</span>. The <span class=Literal>%</span> mod
operator is used to calculate the remainder.</p>

<h2><a name="_Toc353630974">The </a><span class=Literal>insert()</span> List
Method</h2>

<p class=MsoNormal>While the <span class=Literal>append()</span> list method only
adds values to the end of a list, the <span class=Literal>insert()</span> list
method can add a value <em><span style='font-family:"Calibri","sans-serif"'>anywhere</span></em>
in the list. The arguments to <span class=Literal>insert()</span> are an
integer index of where in the list to insert the value, and the value to be
inserted. Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = [2, 4, 6, 8]</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam.insert(0, 'hello')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>['hello',
2, 4, 6, 8]</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam.insert(2, 'world')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>['hello',
2, 'world', 4, 6, 8]</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 65.</span>                
blockMessage.insert(0, chr(asciiNumber))</p>

</div>

<p class=MsoNormal>Using the <span class=Literal>chr()</span> function, the
character that <span class=Literal>asciiNumber</span> is the ASCII number of is
inserted to the beginning of the list at index <span class=Literal>0</span>. </p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 66.</span>        
message.extend(blockMessage)</p>

</div>

<p class=MsoNormal>After the <span class=Literal>for</span> loop on line 59
completes, <span class=Literal>blockMessage</span> will be a list of
single-character strings that were computed <em><span style='font-family:"Calibri","sans-serif"'>from
the current block integer</span></em>. The strings in this list are appended to
the end of the <span class=Literal>message</span> list with the <span
class=Literal>extend()</span> method.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 67.</span>     return
''.join(message)</p>

</div>

<p class=MsoNormal>After the <span class=Literal>for</span> loop on line 57
completes, the single-character strings in <span class=Literal>message</span>
are joined together into a single string which is the complete message. This
string is then returned from the <span class=Literal>getTextFromBlocks()</span>
function.</p>

<h2><a name="_Toc353630975">The Mathematics of RSA Encrypting and Decrypting</a></h2>

<p class=MsoNormal>With the numbers for e, d, and n from the public and private
keys, the mathematics done on the block integers to encrypt and decrypt them can
be summarized as follows:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Encrypted Block = Plaintext Block ^ e mod n</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Decrypted Block = Ciphertext Block ^ d mod n</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 70.</span>
def encryptMessage(message, key, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 71.</span>    
<span class=SourceCodeComment># Converts the message string into a list of
block integers, and then</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 72.</span>    
<span class=SourceCodeComment># encrypts each block integer. Pass the PUBLIC
key to encrypt.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 73.</span>    
encryptedBlocks = []</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 74.</span>    
n, e = key</p>

</div>

<p class=MsoNormal>The <span class=Literal>encryptMessage()</span> function is
passed the plaintext string along with the two-integer tuple of the private
key. The function returns a list of integer blocks of the encrypted ciphertext.
First, the <span class=Literal>encryptedBlocks</span> variable starts as an
empty list that holds the integer blocks and the two integers in <span
class=Literal>key</span> are assigned to variables <span class=Literal>n</span>
and <span class=Literal>e</span>.</p>

<h2><a name="_Toc353630976">The </a><span class=Literal>pow()</span> Function</h2>

<p class=MsoNormal>While the <span class=Literal>**</span> operator does
exponents, the <span class=Literal>pow()</span> function handles exponents and
mod. The expression <span class=Literal>pow(a, b, c)</span> is equivalent to <span
class=Literal>(a ** b) % c</span>. However, the code inside the <span
class=Literal>pow()</span> function knows how to intelligently handle very
large integers and is <strong><span style='font-family:"Calibri","sans-serif"'>much</span></strong>
faster than typing the expression <span class=Literal>(a ** b) % c</span>. Try
typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
pow(2, 8)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>256</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
(2 ** 8)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>256</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
pow(2, 8, 10)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>6</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
(2 ** 8) % 10</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>6</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 76.</span>    
for block in getBlocksFromText(message, blockSize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 77.</span>        
<span class=SourceCodeComment># ciphertext = plaintext ^ e mod n</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 78.</span>        
encryptedBlocks.append(pow(block, e, n))</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 79.</span>    
return encryptedBlocks</p>

</div>

<p class=MsoNormal>While creating the public and private keys involved a lot of
math, the actual math of the encryption is simple. The very large integer of the
block created from the string in <span class=Literal>message</span> is raised
to <span class=Literal>e</span> and then modded by <span class=Literal>n</span>.
This expression evaluates to the encrypted block integer, and is then appended
to <span class=Literal>encryptedBlocks</span> on line 78.</p>

<p class=MsoNormal>After all the blocks have been encrypted, the function
returns <span class=Literal>encryptedBlocks</span> on line 79.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 82.</span>
def decryptMessage(encryptedBlocks, messageLength, key, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 83.</span>    
<span class=SourceCodeComment># Decrypts a list of encrypted block ints into
the original message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 84.</span>    
<span class=SourceCodeComment># string. The original message length is required
to properly decrypt</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 85.</span>    
<span class=SourceCodeComment># the last block. Be sure to pass the PRIVATE key
to decrypt.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 86.</span>    
decryptedBlocks = []</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 87.</span>    
n, d = key</p>

</div>

<p class=MsoNormal>The math used in the <span class=Literal>decryptMessage()</span>
function is also simple. The <span class=Literal>decryptedBlocks</span>
variable will store a list of the decrypted integer blocks, and the two
integers of the <span class=Literal>key</span> tuple are placed in <span
class=Literal>n</span> and <span class=Literal>d</span> respectively using the
multiple assignment trick.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 88.</span>    
for block in encryptedBlocks:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 89.</span>        
<span class=SourceCodeComment># plaintext = ciphertext ^ d mod n</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 90.</span>        
decryptedBlocks.append(pow(block, d, n))</p>

</div>

<p class=MsoNormal>The math of the decryption on line 90 is the same as the encryption’s
math, except the integer block is being raised to <span class=Literal>d</span>
instead of <span class=Literal>e</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 91.</span>     return
getTextFromBlocks(decryptedBlocks, messageLength, blockSize)</p>

</div>

<p class=MsoNormal>The decrypted blocks along with the <span class=Literal>messageLength</span>
and <span class=Literal>blockSize</span> parameters are passed <span
class=Literal>getTextFromBlocks()</span> so that the decrypted plaintext as a
string is returned from <span class=Literal>decryptMessage()</span>.</p>

<h2><a name="_Toc353630977">Reading in the Public &amp; Private Keys from their
Key Files</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 94.</span>
def readKeyFile(keyFilename):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 95.</span>    
<span class=SourceCodeComment># Given the filename of a file that contains a
public or private key,</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 96.</span>    
<span class=SourceCodeComment># return the key as a (n,e) or (n,d) tuple value.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 97.</span>    
fo = open(keyFilename)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 98.</span>    
content = fo.read()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 99.</span>    
fo.close()</p>

</div>

<p class=MsoNormal>The key files that <span class=Filename>makeRsakeys.py</span>
creates look like this:</p>

<p class=MsoNormal>&lt;key size as an integer&gt;,&lt;big integer for
N&gt;,&lt;big integer for E or D&gt;</p>

<p class=MsoNormal>The <span class=Literal>readKeyFile()</span> function is
called to read the key size, n, and e (for the public key) or d (for the private
key) values from the key file. Lines 97 to 99 open this file and read in the
contents as a string into the <span class=Literal>content</span> variable.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>100.</span>    
keySize, n, EorD = content.split(',')</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>101.</span>    
return (int(keySize), int(n), int(EorD))</p>

</div>

<p class=MsoNormal>The <span class=Literal>split()</span> string method splits
up the string in content along the commas. The list that <span class=Literal>split()</span>
returns will have three items in it, and the multiple assignment trick will
place each of these items into the <span class=Literal>keySize</span>, <span
class=Literal>n</span>, and <span class=Literal>EorD</span> variables
respectively on line 100.</p>

<p class=MsoNormal>Remember that <span class=Literal>content</span> was a
string when it was read from the file, and the items in the list that <span
class=Literal>split()</span> returns will also be string values. So before
returning the <span class=Literal>keySize</span>, <span class=Literal>n</span>,
and <span class=Literal>EorD</span> values, they are each passed to <span
class=Literal>int()</span> to return an integer form of the value. This is how <span
class=Literal>readKeyFile()</span> returns three integers that were read from
the key file.</p>

<h2><a name="_Toc353630978">The Full RSA Encryption Process</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>104.</span>
def encryptAndWriteToFile(messageFilename, keyFilename, message, blockSize=DEFAULT_BLOCK_SIZE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>105.</span>    
<span class=SourceCodeComment># Using a key from a key file, encrypt the
message and save it to a</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>106.</span>    
<span class=SourceCodeComment># file. Returns the encrypted message string.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>107.</span>    
keySize, n, e = readKeyFile(keyFilename)</p>

</div>

<p class=MsoNormal>The <span class=Literal>encryptAndWriteToFile()</span>
function is passed three string arguments: a filename to write the encrypted
message in, a filename of the public key to use, and a message to be encrypted.
This function handles not just encrypting the string with the key, but also
creating the file that contains the encrypted contents. (The <span
class=Literal>blockSize</span> parameter can also be specified, but it will be set
to <span class=Literal>DEFAULT_BLOCK_SIZE</span> by default, which is <span
class=Literal>128</span>.)</p>

<p class=MsoNormal>The first step is to read in the values for <span
class=Literal>keySize</span>, <span class=Literal>n</span>, and <span
class=Literal>e</span> from the key file by calling <span class=Literal>readKeyFile()</span>
on line 107.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>109.</span>    
<span class=SourceCodeComment># Check that key size is greater than block size.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>110.</span>    
if keySize &lt; blockSize * 8: <span class=SourceCodeComment># * 8 to convert
bytes to bits</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>111.</span>        
sys.exit('ERROR: Block size is %s bits and key size is %s bits. The RSA cipher
requires the block size to be equal to or less than the key size. Either increase
the block size or use different keys.' % (blockSize * 8, keySize))</p>

</div>

<p class=MsoNormal>In order for the mathematics of the RSA cipher to work, the
key size must be equal to or greater than the block size. The <span
class=Literal>blockSize</span> value is in bytes, while the key size that was
stored in the key file was in bits, so we multiply the integer in <span
class=Literal>blockSize</span> by 8 on line 110 so that both of these values
represent number of bits.</p>

<p class=MsoNormal>If <span class=Literal>keySize</span> is less than <span
class=Literal>blockSize * 8</span>, the program exits with an error message.
The user will either have to decrease the value passed for <span class=Literal>blockSize</span>
or use a larger key.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>114.</span>    
<span class=SourceCodeComment># Encrypt the message</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>115.</span>    
encryptedBlocks = encryptMessage(message, (n, e), blockSize)</p>

</div>

<p class=MsoNormal>Now that we have the <span class=Literal>n</span> and <span
class=Literal>e</span> values for the key, we call the <span class=Literal>encryptMessage()</span>
function which returns a list of integer blocks on line 115. The <span
class=Literal>encryptMessage()</span> is expecting a two-integer tuple for the
key, which is why the <span class=Literal>n</span> and <span class=Literal>e</span>
variables are placed inside a tuple that is then passed as the second argument for
<span class=Literal>encryptMessage()</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>117.</span>    
<span class=SourceCodeComment># Convert the large int values to one string
value.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>118.</span>    
for i in range(len(encryptedBlocks)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>119.</span>        
encryptedBlocks[i] = str(encryptedBlocks[i])</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>120.</span>    
encryptedContent = ','.join(encryptedBlocks)</p>

</div>

<p class=MsoNormal>The <span class=Literal>join()</span> method will return a
string of the blocks separated by commas, but <span class=Literal>join()</span>
only works on lists with string values, and <span class=Literal>encryptedBlocks</span>
is a list of integers. These integers will have to first be converted into
strings.</p>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 118 iterates
through each index in <span class=Literal>encryptedBlocks</span>, replacing the
integer at <span class=Literal>encryptedBlocks[i]</span> with a string form of
the integer. When the loop completes, <span class=Literal>encryptedBlocks</span>
now contains a list of string values instead of a list of integer values.</p>

<p class=MsoNormal>The list of string values is passed to the <span
class=Literal>join()</span> method, which returns a single string of the list’s
strings joined together with commas. Line 120 stores this string in a variable
named <span class=Literal>encryptedContent</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>122.</span>    
<span class=SourceCodeComment># Write out the encrypted string to the output
file.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>123.     </span>encryptedContent
= '%s_%s_%s' % (len(message), blockSize, encryptedContent)</p>

</div>

<p class=MsoNormal>We want to write out more than just the encrypted integer
blocks to the file though, so line 123 changes the <span class=Literal>encryptedContent</span>
variable to include the size of the message (as an integer), followed by an
underscore, followed by the <span class=Literal>blockSize</span> (which is also
an integer), followed by another underscore, and then followed by the encrypted
integer blocks.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>124.</span>    
fo = open(messageFilename, 'w')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>125.</span>    
fo.write(encryptedContent)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>126.</span>    
fo.close()</p>

</div>

<p class=MsoNormal>The last step is to write out the contents of the encrypted
file. The filename provided by the <span class=Literal>messageFilename</span>
parameter is created with the call to <span class=Literal>open()</span> on line
124. (The <span class=Literal>'w'</span> argument tells <span class=Literal>open()</span>
to open the file in “write mode”.) Note that if a file with this name already
exists, then it will be overwritten by the new file.</p>

<p class=MsoNormal>The string in <span class=Literal>encryptedContent</span> is
written to the file by calling the <span class=Literal>write()</span> method on
line 125. Now that we are done writing the file’s contents, line 126 closes the
file object in <span class=Literal>fo</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>127.</span>    
<span class=SourceCodeComment># Also return the encrypted string.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>128.</span>    
return encryptedContent</p>

</div>

<p class=MsoNormal>Finally, the string in <span class=Literal>encryptedContent</span>
is returned from the <span class=Literal>encryptAndWriteToFile()</span>
function on line 128. (This is so that the code that calls the function can use
this string to, for example, print it on the screen.)</p>

<h2><a name="_Toc353630979">The Full RSA Decryption Process</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>131.</span>
def readFromFileAndDecrypt(messageFilename, keyFilename):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>132.</span>    
<span class=SourceCodeComment># Using a key from a key file, read an encrypted
message from a file</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>133.</span>    
<span class=SourceCodeComment># and then decrypt it. Returns the decrypted
message string.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>134.</span>    
keySize, n, d = readKeyFile(keyFilename)</p>

</div>

<p class=MsoNormal>The <span class=Literal>readFromFileAndDecrypt()</span>
function, like <span class=Literal>encryptAndWriteToFile()</span>, has parameters
for the encrypted message file’s filename and the key file’s filename. (Be sure
to pass the filename of the private key for <span class=Literal>keyFilename</span>,
not the public key.)</p>

<p class=MsoNormal>The first step is the same as <span class=Literal>encryptAndWriteToFile()</span>:
the <span class=Literal>readKeyFile()</span> function is called to get the
values for the <span class=Literal>keySize</span>, <span class=Literal>n</span>,
and <span class=Literal>d</span> variables.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>137.</span>    
<span class=SourceCodeComment># Read in the message length and the encrypted
message from the file.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>138.</span>    
fo = open(messageFilename)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>139.</span>    
content = fo.read()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>140.</span>    
messageLength, blockSize, encryptedMessage = content.split('_')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>141.</span>    
messageLength = int(messageLength)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>142.</span>    
blockSize = int(blockSize)</p>

</div>

<p class=MsoNormal>The second step is to read in the contents of the file. The <span
class=Literal>messageFilename</span> file is opened for reading (the lack of a
second argument means <span class=Literal>open()</span> will use “read mode”)
on line 138. The <span class=Literal>read()</span> method call on line 139 will
return a string of the full contents of the file.</p>

<p class=MsoNormal>Remember that the encrypted file’s format has an integer of
the message length, an integer for the block size used, and then the encrypted
integer blocks (all separated by underscore characters). Line 140 calls the <span
class=Literal>split()</span> method to return a list of these three values, and
the multiple assignment trick places the three values into the <span
class=Literal>messageLength</span>, <span class=Literal>blockSize</span>, and <span
class=Literal>message</span> variables respectively.</p>

<p class=MsoNormal>Because the values returned by <span class=Literal>split()</span>
will be strings, lines 141 and 142 will set <span class=Literal>messageLength</span>
and <span class=Literal>blockSize</span> to their integer form, respectively.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>144.</span>    
<span class=SourceCodeComment># Check that key size is greater than block size.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>145.</span>    
if keySize &lt; blockSize * 8: <span class=SourceCodeComment># * 8 to convert
bytes to bits</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>146.</span>        
sys.exit('ERROR: Block size is %s bits and key size is %s bits. The RSA cipher
requires the block size to be equal to or less than the key size. Did you
specify the correct key file and encrypted file?' % (blockSize * 8, keySize))</p>

</div>

<p class=MsoNormal>The <span class=Literal>readFromFileAndDecrypt()</span>
function also has a check that the block size is equal to or less than the key size.
This should always pass, because if the block size was too small, then it would
have been impossible to create this encrypted file. Most likely the wrong
private key file was specified for the <span class=Literal>keyFilename</span>
parameter, which means the key would not have decrypted the file correctly anyway.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>148.</span>    
<span class=SourceCodeComment># Convert the encrypted message into large int
values.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>149.</span>    
encryptedBlocks = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>150.</span>    
for block in encryptedMessage.split(','):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>151.</span>        
encryptedBlocks.append(int(block))</p>

</div>

<p class=MsoNormal>The <span class=Literal>encryptedMessage</span> string contains
many integer characters joined together with commas. Line 150’s <span
class=Literal>for</span> loop iterates over the list returned by the <span
class=Literal>split()</span> method. This list contains strings of individual
blocks. The integer form of these strings is appended to the <span
class=Literal>encryptedBlocks</span> list (which starts as an empty list on
line 149) each time line 151 is executed. After the <span class=Literal>for</span>
loop on line 150 completes, the <span class=Literal>encryptedBlocks</span> list
contains integer values of the numbers that were in the <span class=Literal>encryptedMessage</span>
string.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>153.</span>    
<span class=SourceCodeComment># Decrypt the large int values.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>154.</span>    
return decryptMessage(encryptedBlocks, messageLength, (n, d), blockSize)</p>

</div>

<p class=MsoNormal>The list in <span class=Literal>encryptedBlocks</span> is
passed to <span class=Literal>decryptMessage()</span>, along with <span
class=Literal>messageLength</span>, the private key (which is a tuple value of
the two integers in <span class=Literal>n</span> and <span class=Literal>d</span>),
and the block size. The <span class=Literal>decryptMessage()</span> function
returns a single string value of the decrypted message, which itself is
returned from <span class=Literal>readFileAndDecrypt()</span> on line 154.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rsaCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>157.</span> <span
class=SourceCodeComment># If rsaCipher.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>158.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>159.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>160.</span>    
main()</p>

</div>

<p class=MsoNormal>Lines 159 and 160 call the <span class=Literal>main()</span>
function if this program was run by itself rather than imported by another
program.</p>

<h2><a name="_Toc353630980">Practice Exercises, Chapter 24, Set D</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice24D</u></span>.</p>

<h2><a name="_Toc353630981">Why Can’t We Hack the RSA Cipher</a></h2>

<p class=MsoNormal>All the different types of cryptographic attacks we’ve used
in this book can’t be used against the RSA cipher:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The brute-force
attack won’t work. There are too many possible keys to go through.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A
dictionary attack won’t work because the keys are based on numbers, not words.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A
word pattern attack can’t be used because the same plaintext word can be
encrypted differently depending on where in the block it appears.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Frequency
analysis can’t be used. Since a single encrypted block represents several
characters, we can’t get a frequency count of the individual characters.</p>

<p class=MsoNormal>There are no mathematical tricks that work, either.
Remember, the RSA decryption equation is:</p>

<p class=MsoNormal align=center style='text-align:center'>M = C^d mod n</p>

<p class=MsoNormal>Where M is the message block integer, C is the ciphertext
block integer, and the private key is made up of the two numbers (d, n). Everyone
(including a cryptanalyst) has the public key file, which provides (e, n), so
the n number is known. If the cryptanalyst can intercept the ciphertext (which
we should always assume is possible), then she knows C as well. But without
knowing d, it is impossible to do the decryption and calculate M, the original
message.</p>

<p class=MsoNormal>A cryptanalyst knows that d is the inverse of e mod (p – 1) ×
(q – 1) and also knows e from the public key. But there’s no way she knows what
(p – 1) × (q – 1) is. There are some hints to figure it out though.</p>

<p class=MsoNormal>The key sizes are known (it’s in the public key file), so
the cryptanalyst knows that p and q are less than 2 ^ 1024 and that e is
relatively prime with (p – 1) × (q – 1). But e is relatively prime with <em><span
style='font-family:"Calibri","sans-serif"'>a lot</span></em> of numbers, and
with a range of 0 to 2 ^ 1024 possible numbers, it is too large to brute-force.</p>

<p class=MsoNormal>The cryptanalyst has another hint from the public key, though.
The public key is two numbers (e, n). And from the RSA algorithm she knows that
n = p × q. And since p and q are both prime numbers, for the given n number
there can be only two numbers for p and q.</p>

<p class=MsoNormal>(Remember, prime numbers have no factors besides 1 and
themselves. If you multiply two prime numbers, that new number will only have
the factors of 1 and itself, and also the two prime numbers.)</p>

<p class=MsoNormal>So to solve everything and hack the RSA cipher, all we need
to do is figure out what the factors are for n. Since there are two and only
two numbers that multiply to n, we won’t have several different numbers to
choose from. Then we can calculate (p – 1) × (q – 1) and then calculate d. This
seems pretty easy. We already have code that finds factors in <span
class=Filename>primeSieve.py</span>’s <span class=Literal>isPrime()</span>
function:</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code from primeSieve.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 7.</span>
def isPrime(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 8.</span>    
<span class=SourceCodeComment># Returns True if num is a prime number,
otherwise False.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 9. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>10.</span>    
<span class=SourceCodeComment># Note: Generally, isPrime() is slower than
primeSieve().</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>11. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>12.</span>    
<span class=SourceCodeComment># all numbers less than 2 are not prime</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>13.</span>    
if num &lt; 2:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>14.</span>        
return False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>15. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>16.</span>    
<span class=SourceCodeComment># see if num is divisible by any number up to the
square root of num</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>17.</span>    
for i in range(2, int(math.sqrt(num)) + 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>18.</span>        
if num % i == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>19.</span>            
return False</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>20.</span>    
return True</p>

</div>

<p class=MsoNormal>We can just modify this code to return the first factors it
finds (since we know that there can be only two factors for n besides 1 and n):</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>def
isPrime(num):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    <span
class=SourceCodeComment># Returns (p,q) where p and q are factors of num</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&nbsp;</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    <span
class=SourceCodeComment># see if num is divisible by any number up to the
square root of num</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    for i
in range(2, int(math.sqrt(num)) + 1):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>        if
num % i == 0:</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>           
return (i, num / i)</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>    return
None <span class=SourceCodeComment># no factors exist for num, num must be
prime</span></p>

</div>

<p class=MsoNormal>We can just call this function, pass it n (which we get from
the public key file), and wait for it to find our factors, p and q. Then we can
know what (p – 1) × (q – 1) is, which means we can calculate the mod inverse of
e mod (p – 1) × (q – 1), which is d, the decryption key. Then it would be easy
to calculate M, the plaintext message.</p>

<p class=MsoNormal>There’s a problem, though. Remember that n is a number that
is around 600 digits long. In fact, Python’s <span class=Literal>math.sqrt()</span>
function can’t even handle a number that big (it will give you an error
message). But even if it could, Python would be executing that <span
class=Literal>for</span> loop for a very, very long time.</p>

<p class=MsoNormal>Our Sun doesn’t have enough mass to eventually go supernova,
but in 5 billion years it will expand into a red giant star and utterly destroy
the Earth. Even if your computer was still running then, there’s still no
chance that 5 billion years is long enough to find the factors of n. That is
how big the numbers we are dealing with are.</p>

<p class=MsoNormal>And here’s where the strength of the RSA cipher comes from: <strong><span
style='font-family:"Calibri","sans-serif"'>Mathematically, there is no shortcut
to finding the factors of a number.</span></strong> It’s easy to look at a
small number like 15 and say, “Oh, 5 and 3 are two numbers that multiply to 15.
Those are factors of 15.” But it’s another thing entirely to take a (relatively
small) number like 178,565,887,643,607,245,654,502,737 and try to figure out
the factors for it. The only way we can try is by brute-forcing through
numbers, but there are too many numbers.</p>

<p class=MsoNormal>It is really easy to come up with two prime numbers p and q
and multiply them together to get n. But it is reasonably impossible to take a
number n and figure out what p and q are. These facts make the RSA cipher
usable as a cryptographic cipher.</p>

<h2><a name="_Toc353630982">Summary</a></h2>

<p class=MsoNormal>That’s it! This is the last chapter of the book! There is no
“Hacking the RSA Cipher” chapter because there’s no straightforward attack on
the mathematics behind the RSA cipher. And any brute-force attack would fail,
because there are far too many possible keys to try: the keys are literally
hundreds of digits long. If you had a trillion buildings each with a trillion
computers that each tried a trillion keys every nanosecond, it would still take
longer than the universe as been in existence to go through a fraction of the
possible keys. (And the electric bill for all those computers would bankrupt every
industrialized nation on the planet.)</p>

<p class=MsoNormal>That’s a lot of possible keys.</p>

<p class=MsoNormal>The RSA algorithm is a real encryption cipher used in
professional encryption software. When you log into a website or buy something
off the Internet, the RSA cipher (or one like it) is used to keep passwords and
credit card numbers secret from anyone who may be intercepting your network
traffic.</p>

<p class=MsoNormal>Actually, while the basic mathematics used for professional
encryption software are the same as described in this chapter, you probably
don’t want to use this program for your secret files. The hacks against an
encryption program like <span class=Filename>rsaCipher.py</span> are pretty
sophisticated, but they do exist. (For example, the “random” numbers returned
from <span class=Literal>random.randint()</span> aren’t truly random and can be
predicted, meaning that a hacker could figure out which “random” numbers were
used for the prime numbers of your private key.)</p>

<p class=MsoNormal>You’ve seen how all the previous ciphers in this book have
each been hacked and rendered worthless. In general, you don’t want to write
your own cryptography code for things you want to keep secret, because you will
probably make subtle mistakes in the implementation of these programs. And
hackers and spy agencies use these mistakes to hack your encrypted messages.</p>

<p class=MsoNormal>A cipher is only secure if everything but the key can be
revealed but still keep the message a secret. You cannot rely on a cryptanalyst
not having access to the same encryption software or knowing what cipher you
used. Remember Shannon’s Maxim: The enemy knows the system!</p>

<p class=MsoNormal>Professional encryption software is written by
cryptographers who have spent years studying the mathematics and potential
weaknesses of various ciphers. Even then, the software they write is inspected
by other cryptographers to check for mistakes or potential weaknesses. You are
perfectly capable of learning about these cipher systems  and cryptographic
mathematics too. It’s not about being the smartest hacker, but spending the
time to study to become the most knowledgeable hacker.</p>

<p class=MsoNormal>I hope you’ve found this book to be a helpful start on
becoming an elite hacker and programmer. There is a lot more to learn about
programming and cryptography than what is in this book, but I encourage you
explore and learn more! One great book about the general history of
cryptography that I highly recommend is “The Code Book” by Simon Singh. You can
go to <span class=URL><u>http://invpy.com/morehacking</u></span> for a list of other
books and websites to learn more about cryptography. Feel free to email me your
programming or cryptography questions at al@inventwithpython.com.</p>

<p class=MsoNormal>Good luck!</p>

</div>

</body>

</html>
