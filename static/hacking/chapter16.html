<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Definition
	{mso-style-name:Definition;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.URL
	{mso-style-name:URL;
	color:windowtext;
	text-decoration:underline;}
p.SourceCodeExcerpt, li.SourceCodeExcerpt, div.SourceCodeExcerpt
	{mso-style-name:"Source Code Excerpt";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpFirst, li.SourceCodeExcerptCxSpFirst, div.SourceCodeExcerptCxSpFirst
	{mso-style-name:"Source Code ExcerptCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpMiddle, li.SourceCodeExcerptCxSpMiddle, div.SourceCodeExcerptCxSpMiddle
	{mso-style-name:"Source Code ExcerptCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpLast, li.SourceCodeExcerptCxSpLast, div.SourceCodeExcerptCxSpLast
	{mso-style-name:"Source Code ExcerptCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.TopicsCoveredbox, li.TopicsCoveredbox, div.TopicsCoveredbox
	{mso-style-name:"Topics Covered box";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpFirst, li.TopicsCoveredboxCxSpFirst, div.TopicsCoveredboxCxSpFirst
	{mso-style-name:"Topics Covered boxCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpMiddle, li.TopicsCoveredboxCxSpMiddle, div.TopicsCoveredboxCxSpMiddle
	{mso-style-name:"Topics Covered boxCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpLast, li.TopicsCoveredboxCxSpLast, div.TopicsCoveredboxCxSpLast
	{mso-style-name:"Topics Covered boxCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
span.SourceCodeFilename
	{mso-style-name:"Source Code Filename";
	font-family:"Lucida Sans Typewriter";}
span.Filename
	{mso-style-name:Filename;
	font-style:italic;}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code \(Headline\)";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code \(Headline\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code \(Headline\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code \(Headline\)CxSpLast";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US>
<div style='float: right; height: 310px; font-family: sans-serif;'>Ad: Programming books by Al Sweigart<br />
    <a href='http://www.nostarch.com/automatestuff' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src='/images/cover_automate_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/gp/product/0982106017?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src='/images/cover_inventwithpython_thumb.jpg' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src='/images/cover_makinggames_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='https://www.amazon.com/gp/product/1593278225/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593278225&linkCode=as2&tag=playwithpyth-20&linkId=bf3b22819f0886d277e88b8a653b81ad' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src='/images/cover_crackingcodes_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
</div>

<div class=WordSection1><p><strong>Note: The second edition of this book is available under the title <em><a href="https://inventwithpython.com/cracking">Cracking Codes with Python</a></em></strong></p>

<p class=MsoNormal align=center style='text-align:center'><img width=327
height=180 id="Picture 37" src="chapter16_files/image001.jpg">  </p>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc353630826"><span style='font-variant:normal !important;
text-transform:uppercase'>Hacking the Affine Cipher</span></a></h1>

</div>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#DBE5F1'>

<p class=TopicsCoveredboxCxSpFirst style='background:#DBE5F1;border:none;
padding:0in'>Topics Covered In This Chapter:</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>**</span> Exponent Operator</p>

<p class=TopicsCoveredboxCxSpLast style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>continue</span> Statement</p>

</div>

<p class=MsoNormal>We know that the affine cipher is limited to only a few
thousand keys. This means it is trivial to perform a brute-force attack against
it. Open a new File Editor and type in the following code. Save the file as <span
class=Filename>affineHacker.py</span>.</p>

<h2><a name="_Toc353630827">Source Code of the Affine Cipher Hacker Program</a></h2>

<p class=MsoNormal>Open a new file editor window by clicking on <strong>File</strong>
&#9658; <strong>New Window</strong>. Type in the following code into the file
editor, and then save it as <span class=Filename>affineHacker.py</span>. Press <strong>F5</strong>
to run the program. Note that first you will need to download the <span
class=Filename>pyperclip.py</span> module and place this file in the same
directory as the <span class=Filename>affineHacker.py</span> file. You can
download this file from <span class=URL><u>http://invpy.com/pyperclip.py</u></span>.</p>

<p class=MsoNormal>Typing the string for the <span class=Literal>myMessage</span>
variable might be tricky, but you can copy and paste it from <span class=URL><u>http://invpy.com/affineHacker.py</u></span>
to save time.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
Code for affineHacker.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 1.</span> <span
class=SourceCodeComment># Affine Cipher Hacker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 4.</span>
import pyperclip, affineCipher, detectEnglish, cryptomath</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 6.</span>
SILENT_MODE = False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 7. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 8.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 9.</span>    
<span class=SourceCodeComment># You might want to copy &amp; paste this text
from the source code at</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>10.</span>    
<span class=SourceCodeComment># http://invpy.com/affineHacker.py</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>11.</span>    
myMessage = &quot;&quot;&quot;U&amp;'&lt;3dJ^Gjx'-3^MS'Sj0jxuj'G3'%j'&lt;mMMjS'g{GjMMg9j{G'g&quot;'gG
'&lt;3^MS'Sj&lt;jguj'm'P^dm{'g{G3'%jMgjug{9'GPmG'gG'-m0'P^dm{LU'5&amp;Mm{'_^xg{9&quot;&quot;&quot;</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>12. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>13.</span>    
hackedMessage = hackAffine(myMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>14. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>15.</span>    
if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>16.</span>        
<span class=SourceCodeComment># The plaintext is displayed on the screen. For
the convenience of</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>17.</span>        
<span class=SourceCodeComment># the user, we copy the text of the code to the
clipboard.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>18.</span>        
print('Copying hacked message to clipboard:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>19.</span>        
print(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>20.</span>        
pyperclip.copy(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>21.</span>    
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>22.</span>        
print('Failed to hack encryption.')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>23. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>24. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>25.</span>
def hackAffine(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>26.</span>    
print('Hacking...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>27. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>28.</span>    
<span class=SourceCodeComment># Python programs can be stopped at any time by
pressing Ctrl-C (on</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>29.</span>    
<span class=SourceCodeComment># Windows) or Ctrl-D (on Mac and Linux)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>30.</span>    
print('(Press Ctrl-C or Ctrl-D to quit at any time.)')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>31. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>32.</span>    
<span class=SourceCodeComment># brute-force by looping through every possible
key</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>33.</span>    
for key in range(len(affineCipher.SYMBOLS) ** 2):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>34.</span>        
keyA = affineCipher.getKeyParts(key)[0]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>35.</span>        
if cryptomath.gcd(keyA, len(affineCipher.SYMBOLS)) != 1:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>36.</span>            
continue</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>37. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>38.</span>        
decryptedText = affineCipher.decryptMessage(key, message)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>39.</span>        
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>40.</span>         
   print('Tried Key %s... (%s)' % (key, decryptedText[:40]))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>41. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>42.</span>        
if detectEnglish.isEnglish(decryptedText):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>43.</span>            
<span class=SourceCodeComment># Check with the user if the decrypted key has
been found</span>.</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>44.</span>            
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>45.</span>            
print('Possible encryption hack:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>46.</span>            
print('Key: %s' % (key))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>47.</span>            
print('Decrypted message: ' + decryptedText[:200])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>48.</span>            
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>49.</span>            
print('Enter D for done, or just press Enter to continue hacking:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>50.</span>            
response = input('&gt; ')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>51. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>52.</span>            
if response.strip().upper().startswith('D'):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>53.</span>                
return decryptedText</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>54.</span>    
return None</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>55. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>56. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>57.</span> <span
class=SourceCodeComment># If affineHacker.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>58.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>59.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>60.</span>    
main()</p>

</div>

<h2><a name="_Toc353630828">Sample Run of the Affine Cipher Hacker Program</a></h2>

<p class=MsoNormal>When you press <strong>F5</strong> from the file editor to
run this program, the output will look like this:</p>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Hacking...</p>

<p class=SampleRunCxSpMiddle>(Press Ctrl-C or Ctrl-D to quit at any time.)</p>

<p class=SampleRunCxSpMiddle>Tried Key 95... (U&amp;'&lt;3dJ^Gjx'-3^MS'Sj0jxuj'G3'%j'&lt;mMMjS'g)</p>

<p class=SampleRunCxSpMiddle>Tried Key 96...
(T%&amp;;2cI]Fiw&amp;,2]LR&amp;Ri/iwti&amp;F2&amp;$i&amp;;lLLiR&amp;f)</p>

<p class=SampleRunCxSpMiddle>Tried Key 97...
(S$%:1bH\Ehv%+1\KQ%Qh.hvsh%E1%#h%:kKKhQ%e)</p>

<p class=SampleRunCxSpMiddle><em><span style='font-family:"Lucida Sans Typewriter"'>&nbsp;</span></em></p>

<p class=SampleRunCxSpMiddle><em><span style='font-family:"Lucida Sans Typewriter"'>...skipped
for brevity...</span></em></p>

<p class=SampleRunCxSpMiddle><em><span style='font-family:"Lucida Sans Typewriter"'>&nbsp;</span></em></p>

<p class=SampleRunCxSpMiddle>Tried Key 2190...
(?^=!-+.32#0=5-3*&quot;=&quot;#1#04#=2-= #=!~**#&quot;=')</p>

<p class=SampleRunCxSpMiddle>Tried Key 2191... (` ^BNLOTSDQ^VNTKC^CDRDQUD^SN^AD^B@KKDC^H)</p>

<p class=SampleRunCxSpMiddle>Tried Key 2192... (&quot;A computer would deserve
to be called i)</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>Possible encryption hack:</p>

<p class=SampleRunCxSpMiddle>Key: 2192</p>

<p class=SampleRunCxSpMiddle>Decrypted message: &quot;A computer would deserve
to be called intelligent if it could deceive a human into believing that it was
human.&quot; -Alan Turing</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>Enter D for done, or just press Enter to continue
hacking:</p>

<p class=SampleRunCxSpMiddle>&gt; d</p>

<p class=SampleRunCxSpMiddle>Copying hacked message to clipboard:</p>

<p class=SampleRunCxSpLast>&quot;A computer would deserve to be called
intelligent if it could deceive a human into believing that it was human.&quot;
–Alan Turing</p>

</div>

<h2><a name="_Toc353630829">How the Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment> 1.</span> <span
class=SourceCodeComment># Affine Cipher Hacker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 4.</span>
import pyperclip, affineCipher, detectEnglish, cryptomath</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 5. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment> 6.</span>
SILENT_MODE = False</p>

</div>

<p class=MsoNormal>Our affine cipher hacking program fits in 60 lines of code
because we’ve already written much of the code it uses.</p>

<p class=MsoNormal>When you run the hacker program, you can see that this program
produces a lot of output as it works its way through all the possible
decryptions. However, printing out this input does slow down the program. If
you change line 6 to set the <span class=Literal>SILENT_MODE</span> variable to
<span class=Literal>True</span>, the program will be silenced and not print out
all these messages. This will speed up the program immensely.</p>

<p class=MsoNormal>But showing all that text while your hacking program runs makes
it look cool. (And if you want your programs to look cool by printing out text
slowly one character at a time for a “typewriter” effect, check out the <span
class=Filename>typewriter.py</span> module at <span class=URL><u>http://invpy.com/typewriter.py</u></span>.)</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment> 8.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 9.</span>    
<span class=SourceCodeComment># You might want to copy &amp; paste this text
from the source code at</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>10.</span>    
<span class=SourceCodeComment># http://invpy.com/affineHacker.py</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>11.</span>    
myMessage = &quot;&quot;&quot;U&amp;'&lt;3dJ^Gjx'-3^MS'Sj0jxuj'G3'%j'&lt;mMMjS'g{GjMMg9j{G'g&quot;'gG
'&lt;3^MS'Sj&lt;jguj'm'P^dm{'g{G3'%jMgjug{9'GPmG'gG'-m0'P^dm{LU'5&amp;Mm{'_^xg{9&quot;&quot;&quot;</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>12. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>13.</span>    
hackedMessage = hackAffine(myMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>14. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>15.</span>    
if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>16.</span>        
<span class=SourceCodeComment># The plaintext is displayed on the screen. For
the convenience of</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>17.</span>        
<span class=SourceCodeComment># the user, we copy the text of the code to the
clipboard.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>18.</span>        
print('Copying hacked message to clipboard:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>19.</span>        
print(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>20.</span>        
pyperclip.copy(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>21.</span>    
else:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>22.</span>        
print('Failed to hack encryption.')</p>

</div>

<p class=MsoNormal>The ciphertext to be hacked is stored as a string in <span
class=Literal>myMessage</span>, and this string is passed to the <span
class=Literal>hackAffine()</span> function (described next). The return value
from this call is either a string of the original message (if the ciphertext
was hacked) or the <span class=Literal>None</span> value (if the hacking
failed).</p>

<p class=MsoNormal>The code on lines 15 to 22 will check if <span
class=Literal>hackedMessage</span> was set to <span class=Literal>None</span>
or not. If <span class=Literal>hackedMessage</span> is not equal to <span
class=Literal>None</span>, then the message will be printed to the screen on
line 19 and copied to the clipboard on line 20. Otherwise, the program will
simply print that it was unable to hack the message.</p>

<h2><a name="_Toc353630830">The Affine Cipher Hacking Function</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>25.</span>
def hackAffine(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>26.</span>    
print('Hacking...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>27. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>28.</span>    
<span class=SourceCodeComment># Python programs can be stopped at any time by
pressing Ctrl-C (on</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>29.</span>    
<span class=SourceCodeComment># Windows) or Ctrl-D (on Mac and Linux)</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>30.</span>    
print('(Press Ctrl-C or Ctrl-D to quit at any time.)')</p>

</div>

<p class=MsoNormal>The <span class=Literal>hackAffine()</span> function has the
code that does the decryption. This can take a while, so if the user wants to exit
the program early, she can press Ctrl-C (on Windows) or Ctrl-D (on OS X and
Linux).</p>

<h2><a name="_Toc353630831">The </a><span class=Literal>**</span> Exponent
Operator</h2>

<p class=MsoNormal>There is another math operator besides the basic <span
class=Literal>+</span>, <span class=Literal>-</span>, <span class=Literal>*</span>,
<span class=Literal>/</span>, and <span class=Literal>//</span> operators. The <span
class=Literal>**</span> operator is Python’s <span class=Definition><span
style='font-size:12.0pt;line-height:115%'>exponent operator</span></span>. This
does “to the power of” math on two numbers. For example, “two to the power of
five” would be <span class=Literal>2 ** 5</span> in Python code. This is
equivalent to two multiplied by itself five times: <span class=Literal>2 * 2 *
2 * 2 * 2</span>. Both the expressions <span class=Literal>2 ** 5</span> and <span
class=Literal>2 * 2 * 2 * 2 * 2</span> evaluate to the integer <span
class=Literal>32</span>.</p>

<p class=MsoNormal>Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
2 ** 6</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>64</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
4**2</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>16</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
2**4</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>16</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
123**10</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>792594609605189126649</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>32.</span>    
<span class=SourceCodeComment># brute-force by looping through every possible
key</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>33.</span>    
for key in range(len(affineCipher.SYMBOLS) ** 2):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>34.</span>        
keyA = affineCipher.getKeyParts(key)[0]</p>

</div>

<p class=MsoNormal>The range of integers for the keys used to brute-force the
ciphertext will range from <span class=Literal>0</span> to the size of the
symbol set to the second power. The expression:</p>

<p class=MsoNormal align=center style='text-align:center'><span class=Literal>len(affineCipher.SYMBOLS)
** 2</span></p>

<p class=MsoNormal>...is the same as:</p>

<p class=MsoNormal align=center style='text-align:center'><span class=Literal>len(affineCipher.SYMBOLS)
* len(affineCipher.SYMBOLS)</span></p>

<p class=MsoNormal>We multiply this because there are at most <span
class=Literal>len(affineCipher.SYMBOLS)</span> possible integers for Key A and <span
class=Literal>len(affineCipher.SYMBOLS)</span> possible integers for Key B. To
get the entire range of possible keys, we multiply these values together.</p>

<p class=MsoNormal>Line 34 calls the <span class=Literal>getKeyParts()</span>
function that we made in <span class=Filename>affineCipher.py</span> to get the
Key A part of the key we are testing. Remember that the return value of this
function call is a tuple of two integers (one for Key A and one for Key B).
Since <span class=Literal>hackAffine()</span> only needs Key A, the <span
class=Literal>[0]</span> after the function call works on the return value to
evaluate to just the first integer in the returned tuple.</p>

<p class=MsoNormal>That is, <span class=Literal>affineCipher.getKeyParts(key)[0]</span>
will evaluate to (for example), the tuple <span class=Literal>(42, 22)[0]</span>,
which will then evaluate to <span class=Literal>42</span>. This is how we can
get just the Key A part of the return value. The Key B part (that is, the
second value in the returned tuple) is just ignored because we don’t need Key B
to calculate if Key A is valid.</p>

<h2><a name="_Toc353630832">The </a><span class=Literal>continue</span>
Statement</h2>

<p class=MsoNormal>The <span class=Literal>continue</span> statement is simply
the <span class=Literal>continue</span> keyword by itself. A <span
class=Literal>continue</span> statement is found inside the block of a <span
class=Literal>while</span> or <span class=Literal>for</span> loop. When a <span
class=Literal>continue</span> statement is executed, the program execution
immediately jumps to the start of the loop for the next iteration.</p>

<p class=MsoNormal>This is exactly the same thing that happens when the program
execution reaches the end of the loop’s block. But a <span class=Literal>continue</span>
statement makes the program execution jump back to the start of the loop early.</p>

<p class=MsoNormal>Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
for i in range(3):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
print(i)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
print('Hello!')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>0</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello!</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>1</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello!</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>2</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello!</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>This is pretty obvious. The <span class=Literal>for</span>
loop will loop through the <span class=Literal>range</span> object, and the
value in <span class=Literal>i</span> becomes each integer between <span
class=Literal>0</span> and <span class=Literal>4</span>. Also on each
iteration, the <span class=Literal>print('Hello!')</span> function call will
display “Hello!” on the screen.</p>

<p class=MsoNormal>Try typing in this code, which adds a <span class=Literal>continue</span>
statement before the <span class=Literal>print('Hello!')</span> line:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
for i in range(3):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
print(i)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
continue</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
print('Hello!')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>0</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>1</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>2</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>Notice that “Hello!” never appears, because the <span
class=Literal>continue</span> statement causes the program execution to jump
back to the start of the <span class=Literal>for</span> loop for the next
iteration. So the execution never reaches the <span class=Literal>print('Hello!')</span>
line.</p>

<p class=MsoNormal>A <span class=Literal>continue</span> statement is often put
inside an <span class=Literal>if </span>statement’s block so that execution
will continue at the beginning of the loop based on some condition.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>35.</span>        
if cryptomath.gcd(keyA, len(affineCipher.SYMBOLS)) != 1:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>36.</span>            
continue</p>

</div>

<p class=MsoNormal>With the Key A integer stored in the variable <span
class=Literal>keyA</span>, line 35 uses the <span class=Literal>gcd()</span>
function in our <span class=Literal>cryptomath</span> module to determine if
Key A is not relatively prime with the symbol set size. Remember, two numbers
are relatively prime if their GCD (greatest common divisor) is one.</p>

<p class=MsoNormal>If Key A and the symbol set size are not relatively prime,
then the condition on line 35 is <span class=Literal>True</span> and the <span
class=Literal>continue</span> statement on line 36 is executed. This will cause
the program execution to jump back to the start of the loop for the next
iteration. This way, the program will skip line 38’s call to <span
class=Literal>decryptMessage()</span> if the key is invalid, and continue to
the next key.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>38.</span>        
decryptedText = affineCipher.decryptMessage(key, message)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>39.</span>        
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>40.</span>         
   print('Tried Key %s... (%s)' % (key, decryptedText[:40]))</p>

</div>

<p class=MsoNormal>The message is then decrypted with the key by calling <span
class=Literal>decryptMessage()</span>. If <span class=Literal>SILENT_MODE</span>
is <span class=Literal>False</span> the “Tried Key” message will be printed on
the screen. If <span class=Literal>SILENT_MODE</span> was set to <span
class=Literal>True</span>, the <span class=Literal>print()</span> call on line
40 will be skipped.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>42.</span>        
if detectEnglish.isEnglish(decryptedText):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>43.</span>            
<span class=SourceCodeComment># Check with the user if the decrypted key has
been found</span>.</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>44.</span>            
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>45.</span>            
print('Possible encryption hack:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>46.</span>            
print('Key: %s' % (key))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>47.</span>            
print('Decrypted message: ' + decryptedText[:200])</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>48.</span>            
print()</p>

</div>

<p class=MsoNormal>Next, we use the <span class=Literal>isEnglish()</span>
function from our <span class=Literal>detectEnglish</span> module to check if
the decrypted message is recognized as English. If the wrong decryption key was
used, then the decrypted message will look like random characters and <span
class=Literal>isEnglish()</span> will return <span class=Literal>False</span>.</p>

<p class=MsoNormal>But if the decrypted message is recognized as readable
English (by the <span class=Literal>isEnglish()</span> function anyway), then
we will display this to the user.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>49.</span>            
print('Enter D for done, or just press Enter to continue hacking:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>50.</span>            
response = input('&gt; ')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>51.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>52.</span>            
if response.strip().upper().startswith('D'):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>53.</span>                
return decryptedText</p>

</div>

<p class=MsoNormal>The program might not have found the correct key, but rather
a key that produces gibberish that the <span class=Literal>isEnglish()</span>
function mistakenly thinks is English. To prevent false positives, the
decrypted text is printed on the screen for the user to read. If the user
decides that this is the correct decryption, she can type in D and press Enter.
Otherwise, she can just press Enter (which returns a blank string from the <span
class=Literal>input()</span> call) and the <span class=Literal>hackAffine()</span>
function will continue trying more keys.</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeatured><span class=SourceCodeComment>54.</span>     return
None</p>

</div>

<p class=MsoNormal>From the indentation of line 54, you can see that this is
line is executed after the <span class=Literal>for</span> loop on line 33 has
completed. If this loop has finished, then it has gone through every possible
decryption key without finding the correct key. (If the program had found the
correct key, then the execution would have previously returned from the
function on line 53.)</p>

<p class=MsoNormal>But at this point, the <span class=Literal>hackAffine()</span>
function returns the <span class=Literal>None</span> value to signal that it
was unsuccessful at hacking the ciphertext.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>affineHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>57.</span> <span
class=SourceCodeComment># If affineHacker.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>58.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>59.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>60.</span>    
main()</p>

</div>

<p class=MsoNormal>Just like the other programs, we want the <span
class=Filename>affineHacker.py</span> file to be run on its own or be imported
as a module. If <span class=Filename>affineHacker.py</span> is run as a
program, then the special <span class=Literal>__name__</span> variable will be
set to the string <span class=Literal>'__main__'</span> (instead of <span
class=Literal>'affineHacker'</span>). In this case, we want to call the <span
class=Literal>main()</span> function.</p>

<h2><a name="_Toc353630833">Practice Exercises, Chapter 16, Set A</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice16A</u></span>.</p>

<h2><a name="_Toc353630834">Summary</a></h2>

<p class=MsoNormal>This chapter was fairly short because it hasn’t introduced
any new hacking techniques. As long as the number of possible keys is less than
a million or so, it won’t take long for our computers to brute-force through
every possible key and use <span class=Literal>isEnglish()</span> to check if
it has found the right key.</p>

<p class=MsoNormal>And a lot of the code we use for the affine cipher hacker
has already been written in <span class=Filename>affineCipher.py</span>, <span
class=Filename>detectEnglish.py</span>, <span class=Filename>cryptomath.py</span>,
and <span class=Filename>pyperclip.py</span>. The <span class=Literal>main()</span>
function trick is really helpful in making the code in our programs reusable.</p>

<p class=MsoNormal>The <span class=Literal>**</span> exponent operator can be
used to raise a number to the power of another number. The <span class=Literal>continue</span>
statement sends the program execution back to the beginning of the loop
(instead of waiting until the execution reaches the end of the block).</p>

<p class=MsoNormal>In the next chapter, we will learn a new cipher that cannot
be brute-forced by our computers. The number of possible keys is more than a
trillion trillion! A single laptop couldn’t possible go through a fraction of
those keys in our life time. This makes it immune to brute-forcing. Let’s learn
about the simple substitution cipher.</p>

</div>

</body>

</html>
