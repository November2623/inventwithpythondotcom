<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Another Typewriter";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:33.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:44.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:66.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:77.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:88.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.Definition
	{mso-style-name:Definition;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Times New Roman","serif";}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Times New Roman","serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
p.TableListing, li.TableListing, div.TableListing
	{mso-style-name:"Table Listing";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TableHeader, li.TableHeader, div.TableHeader
	{mso-style-name:"Table Header";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpFirst, li.ChapterTitleCxSpFirst, div.ChapterTitleCxSpFirst
	{mso-style-name:"Chapter TitleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpMiddle, li.ChapterTitleCxSpMiddle, div.ChapterTitleCxSpMiddle
	{mso-style-name:"Chapter TitleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpLast, li.ChapterTitleCxSpLast, div.ChapterTitleCxSpLast
	{mso-style-name:"Chapter TitleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.URL
	{mso-style-name:URL;
	color:windowtext;
	text-decoration:underline;}
p.SourceCodeExcerpt, li.SourceCodeExcerpt, div.SourceCodeExcerpt
	{mso-style-name:"Source Code Excerpt";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpFirst, li.SourceCodeExcerptCxSpFirst, div.SourceCodeExcerptCxSpFirst
	{mso-style-name:"Source Code ExcerptCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpMiddle, li.SourceCodeExcerptCxSpMiddle, div.SourceCodeExcerptCxSpMiddle
	{mso-style-name:"Source Code ExcerptCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpLast, li.SourceCodeExcerptCxSpLast, div.SourceCodeExcerptCxSpLast
	{mso-style-name:"Source Code ExcerptCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.SourceCode
	{mso-style-name:"Source Code";
	font-family:"Lucida Console";}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
span.SampleRunResponse
	{mso-style-name:"Sample Run Response";
	color:black;}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.MessageText, li.MessageText, div.MessageText
	{mso-style-name:"Message Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Lucida Sans Typewriter";}
p.TopicsCoveredbox, li.TopicsCoveredbox, div.TopicsCoveredbox
	{mso-style-name:"Topics Covered box";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpFirst, li.TopicsCoveredboxCxSpFirst, div.TopicsCoveredboxCxSpFirst
	{mso-style-name:"Topics Covered boxCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpMiddle, li.TopicsCoveredboxCxSpMiddle, div.TopicsCoveredboxCxSpMiddle
	{mso-style-name:"Topics Covered boxCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpLast, li.TopicsCoveredboxCxSpLast, div.TopicsCoveredboxCxSpLast
	{mso-style-name:"Topics Covered boxCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
p.FigureCaption, li.FigureCaption, div.FigureCaption
	{mso-style-name:"Figure Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpFirst, li.FigureCaptionCxSpFirst, div.FigureCaptionCxSpFirst
	{mso-style-name:"Figure CaptionCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpMiddle, li.FigureCaptionCxSpMiddle, div.FigureCaptionCxSpMiddle
	{mso-style-name:"Figure CaptionCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpLast, li.FigureCaptionCxSpLast, div.FigureCaptionCxSpLast
	{mso-style-name:"Figure CaptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.SourceCodeFilename
	{mso-style-name:"Source Code Filename";
	font-family:"Lucida Sans Typewriter";}
p.TableCaption, li.TableCaption, div.TableCaption
	{mso-style-name:"Table Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	text-align:center;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.Filename
	{mso-style-name:Filename;
	font-style:italic;}
p.CipherInfoBox, li.CipherInfoBox, div.CipherInfoBox
	{mso-style-name:"Cipher Info Box";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	background:#FFFF99;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Another Typewriter";
	letter-spacing:1.4pt;}
p.ChapterQuotes, li.ChapterQuotes, div.ChapterQuotes
	{mso-style-name:"Chapter Quotes";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpFirst, li.ChapterQuotesCxSpFirst, div.ChapterQuotesCxSpFirst
	{mso-style-name:"Chapter QuotesCxSpFirst";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpMiddle, li.ChapterQuotesCxSpMiddle, div.ChapterQuotesCxSpMiddle
	{mso-style-name:"Chapter QuotesCxSpMiddle";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpLast, li.ChapterQuotesCxSpLast, div.ChapterQuotesCxSpLast
	{mso-style-name:"Chapter QuotesCxSpLast";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.CodeExample, li.CodeExample, div.CodeExample
	{mso-style-name:"Code Example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpFirst, li.CodeExampleCxSpFirst, div.CodeExampleCxSpFirst
	{mso-style-name:"Code ExampleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpMiddle, li.CodeExampleCxSpMiddle, div.CodeExampleCxSpMiddle
	{mso-style-name:"Code ExampleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpLast, li.CodeExampleCxSpLast, div.CodeExampleCxSpLast
	{mso-style-name:"Code ExampleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SmallerText, li.SmallerText, div.SmallerText
	{mso-style-name:"Smaller Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code \(Headline\)";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code \(Headline\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code \(Headline\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code \(Headline\)CxSpLast";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1, li.Style1, div.Style1
	{mso-style-name:Style1;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpFirst, li.Style1CxSpFirst, div.Style1CxSpFirst
	{mso-style-name:Style1CxSpFirst;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpMiddle, li.Style1CxSpMiddle, div.Style1CxSpMiddle
	{mso-style-name:Style1CxSpMiddle;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpLast, li.Style1CxSpLast, div.Style1CxSpLast
	{mso-style-name:Style1CxSpLast;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>
<div style='float: right; height: 310px; font-family: sans-serif;'>Ad: Programming books by Al Sweigart<br />
    <a href='http://www.nostarch.com/automatestuff' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src='/images/cover_automate_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/gp/product/0982106017?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src='/images/cover_inventwithpython_thumb.jpg' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src='/images/cover_makinggames_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='https://www.amazon.com/gp/product/1593278225/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593278225&linkCode=as2&tag=playwithpyth-20&linkId=bf3b22819f0886d277e88b8a653b81ad' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src='/images/cover_crackingcodes_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
</div>

<div class=WordSection1><p><strong>Note: The second edition of this book is available under the title <em><a href="https://inventwithpython.com/cracking">Cracking Codes with Python</a></em></strong></p>

<p class=MsoNormal align=center style='text-align:center'><img width=327
height=180 id="Picture 34" src="chapter14_files/image001.jpg">  </p>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc353630789"><span style='font-variant:normal !important;
text-transform:uppercase'>Modular Arithmetic with the Multiplicative and Affine
Ciphers</span></a></h1>

</div>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#DBE5F1'>

<p class=TopicsCoveredboxCxSpFirst style='background:#DBE5F1;border:none;
padding:0in'>Topics Covered In This Chapter:</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Modular Arithmetic</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>“Mod” is “Remainder Of”(Sort Of)</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>GCD: Greatest Common Divisor (aka Greatest Common Factor)</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Multiple Assignment Trick</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Euclid’s Algorithm for Finding the GCD of Two Numbers</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>“Relatively Prime”</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Multiplicative Cipher</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Finding Modular Inverses</p>

<p class=TopicsCoveredboxCxSpLast style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>cryptomath</span> Module</p>

</div>

<p class=ChapterQuotesCxSpFirst style='margin-top:30.0pt;margin-right:45.0pt;
margin-bottom:30.0pt;margin-left:45.0pt'>“People have been defending their own
privacy for centuries with whispers, darkness, envelopes, closed doors, secret
handshakes, and couriers. The technologies of the past did not allow for strong
privacy, but electronic technologies do.”</p>

<p class=ChapterQuotesCxSpMiddle>&nbsp;</p>

<p class=ChapterQuotesCxSpLast align=right style='text-align:right'><span
style='font-size:11.0pt;line-height:115%'>Eric Hughes, “A Cypherpunk's
Manifesto”, 1993</span></p>

<p class=MsoNormal>The multiplicative and affine ciphers are similar to the
Caesar cipher, except instead of adding a key to a symbol’s index in a string, these
ciphers use multiplication. But before we learn how to encrypt and decrypt with
these ciphers, we’re going to need to learn a little math. This knowledge is
also needed for the last cipher in this book, the RSA cipher.</p>

<h2><a name="_Toc353630790">Oh No Math!</a></h2>

<p class=MsoNormal>Don’t let it scare you that you need to learn some math. The
principles here are easy to learn from pictures, and we’ll see that they are
directly useful in cryptography.</p>

<h2><a name="_Toc353630791">Math Oh Yeah!</a></h2>

<p class=MsoNormal>That’s more like it.</p>

<h2><a name="_Toc353630792">Modular Arithmetic (aka Clock Arithmetic)</a></h2>

<p class=MsoNormal>This is a clock in which I’ve replaced the 12 with a 0. (I’m
a programmer. I think it’s weird that the day begins at 12 AM instead of 0 AM.)
Ignore the hour, minute, and second hands. We just need to pay attention to the
numbers.</p>

<p class=MsoNormal align=center style='text-align:center'><img width=218
height=218 id="Picture 16" src="chapter14_files/image002.png"></p>

<p class=FigureCaption>Figure 14-1. A clock with a zero o’clock.</p>

<h3>3 O’Clock + 5 Hours = 8 O’Clock</h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=437 valign=top style='width:327.95pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>If the current time is 3 o’clock, what time will it be in
  5 hours? This is easy enough to figure out. 3 + 5 = 8. It will be 8 o’clock.
  Think of the hour hand on the clock in Figure 14-1 starting at 3, and then
  moving 5 hours clockwise. It will end up at 8. This is one way we can double-check
  our math.</p>
  </td>
  <td width=153 valign=top style='width:114.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=139
  height=134 id="Picture 75" src="chapter14_files/image003.png"></p>
  </td>
 </tr>
</table>

<h3>10 O’Clock + 5 Hours = 3 O’Clock</h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=439 valign=top style='width:329.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>If the current time is 10 o’clock, what time will it be in
  5 hours? If you add 10 + 5, you get 15. But 15 o’clock doesn’t make sense for
  clocks like the one to the right. It only goes up to 12. So to find out what
  time it will be, we subtract 15 – 12 = 3. The answer is it will be 3 o’clock.
  (Whether or not it is 3 AM or 3PM depends on if the current time is 10 AM or
  10 PM. But it doesn’t matter for modular arithmetic.)</p>
  <p class=MsoNormal>If you think of the hour hand as starting at 10 and then
  moving forward 5 hours, it will land on 3. So double-checking our math by
  moving the hour hand clockwise shows us that we are correct.</p>
  </td>
  <td width=151 valign=top style='width:113.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=135
  height=137 id="Picture 76" src="chapter14_files/image004.png"></p>
  </td>
 </tr>
</table>

<h3>10 O’Clock + 200 Hours = 6 O’Clock</h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=439 valign=top style='width:329.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>If the current time is 10 o’clock, what time will it be in
  200 hours? 200 + 10 = 210, and 210 is larger than 12. So we subtract 210 – 12
  = 198. But 198 is still larger than 12, so we subtract 12 again. 198 – 12 =
  186. If we keep subtracting 12 until the difference is less than 12, we end
  up with 6. If the current time is 10 o’clock, the time 200 hours later will
  be 6 o’clock.</p>
  <p class=MsoNormal>If we wanted to double check our 10 o’clock + 200 hours
  math, we would keep moving the hour hand around and around the clock face.
  When we’ve moved the hour hand the 200<sup>th</sup> time, it will end up
  landing on 6.</p>
  </td>
  <td width=151 valign=top style='width:113.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=117
  height=135 id="Picture 77" src="chapter14_files/image005.png"></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc353630793">The % Mod Operator</a></h2>

<p class=MsoNormal>This sort of “wrap-around” arithmetic is called <span
class=Definition><span style='font-size:12.0pt;line-height:115%'>modular
arithmetic</span></span>. We say “fifteen mod twelve” is equal to 3. (Just like
how “15 o’clock” mod twelve would be “3 o’clock.) In Python, the mod operator
is the <span class=Literal>%</span> percent sign. Try typing the following into
the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'><span
class=SourceCode><span style='font-size:10.0pt;line-height:115%'>&gt;&gt;&gt; </span></span><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>15
% 12</span></span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>3</span></span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>&gt;&gt;&gt;
210 % 12</span></span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>6</span></span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>&gt;&gt;&gt;
10 % 10</span></span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>0</span></span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>&gt;&gt;&gt;
20 % 10</span></span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>0</span></span></p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'><span
class=SourceCode><span style='line-height:115%;font-family:"Lucida Sans Typewriter"'>&gt;&gt;&gt;&nbsp;</span></span></p>

</div>

<h3>“Mod” is “Division Remainder”(Sort Of)</h3>

<p class=MsoNormal>You can think of the mod operator as a “division remainder” operator.
21 ÷ 5 = 4 remainder 1. And 21 % 5 = 1. This works pretty well for positive
numbers, but not for negative numbers. -21 ÷ 5 = -4 remainder -1. But the
result of a mod operation will never be negative. Instead, think of that -1
remainder as being the same as 5 – 1, which comes to 4. This is exactly what
-21 % 5 evaluates to:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
-21 % 5</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>4</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>But for the purposes of cryptography in this book, we’ll
only be modding positive numbers.</p>

<h2><a name="_Toc353630794">Practice Exercises, Chapter 14, Set A</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice14A</u></span>.</p>

<h2><a name="_Toc353630795">GCD: Greatest Common Divisor (aka Greatest Common
Factor)</a></h2>

<p class=MsoNormal><span class=Definition><span style='font-size:12.0pt;
line-height:115%'>Factors</span></span> are the numbers that can be multiplied
to produce a particular number. Look at this simple multiplication:</p>

<p class=MsoNormal align=center style='text-align:center'>4 × 6 = 24</p>

<p class=MsoNormal>In the above math problem, we say 4 and 6 are factors of 24.
(Another name for factor is <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>divisor</span></span>.) The number 24 also has some other
factors:</p>

<p class=MsoNormal align=center style='text-align:center'>8 × 3 = 24</p>

<p class=MsoNormal align=center style='text-align:center'>12 × 2 = 24</p>

<p class=MsoNormal align=center style='text-align:center'>24 × 1 = 24</p>

<p class=MsoNormal>From the above three math problems, we can see that 8 and 3
are also factors of 24, as are 12 and 2, and 24 and 1. So we can say the
factors of 24 are: 1, 2, 3, 4, 6, 8, 12, and 24.</p>

<p class=MsoNormal>Let’s look at the factors of 30:</p>

<p class=MsoNormal align=center style='text-align:center'>1 × 30 = 30</p>

<p class=MsoNormal align=center style='text-align:center'>2 × 15 = 30</p>

<p class=MsoNormal align=center style='text-align:center'>3 × 10 = 30</p>

<p class=MsoNormal align=center style='text-align:center'>5 × 6 = 30</p>

<p class=MsoNormal>So the factors of 30 are 1, 2, 3, 5, 6, 10, 15, and 30.
(Notice that any number will always have 1 and itself as factors.) If you look
at the list of factors for 24 and 30, you can see that the factors that they
have in common are 1, 2, 3, and 6. The greatest number of these is 6, so we
call 6 the greatest common factor (or, more commonly, the greatest common
divisor) of 24 and 30.</p>

<h2><a name="_Toc353630796">Visualize Factors and GCD with Cuisenaire Rods</a></h2>

<p class=MsoNormal align=center style='text-align:center'><img width=167
height=293 id="Picture 27" src="chapter14_files/image006.jpg"></p>

<p class=FigureCaption>Figure 14-2. Each Cuisenaire rod has a different color
for each integer length.</p>

<p class=MsoNormal>Above are some rectangular blocks with a width of 1 unit, 2
units, 3 units, and so on. The block’s length can be used to represent a
number. You can count the number of squares in each block to determine the
length and number. These blocks (sometimes called Cuisenaire rods) can be used
to visualize math operations, like 3 + 2 = 5 or 5 × 3 = 15:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=182
height=122 id="Picture 28" src="chapter14_files/image007.jpg"></p>

<p class=FigureCaption>Figure 14-3. Using Cuisenaire rods to demonstrate
addition and multiplication.</p>

<p class=MsoNormal>If we represent the number 30 as a block that is 30 units
long, a number is a factor of 30 if the number’s blocks can evenly fit with the
30-block. You can see that 3 and 10 are factors of 30:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=452
height=99 id="Picture 60" src="chapter14_files/image008.jpg"></p>

<p class=FigureCaption>Figure 14-4. Cuisenaire rods demonstrating factors.</p>

<p class=MsoNormal>But 4 and 7 are not factors of 30, because the 4-blocks and
7-blocks won’t evenly fit into the 30-block:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=546
height=145 id="Picture 30" src="chapter14_files/image009.jpg"></p>

<p class=FigureCaption>Figure 14-5. Cuisenaire rods demonstrating numbers that
are not factors of 30.</p>

<p class=MsoNormal>The Greatest Common Divisor of two blocks (that is, two
numbers represented by those blocks) is the <strong>longest</strong> block that
can evenly fit <strong>both</strong> blocks.</p>

<p class=MsoNormal align=center style='text-align:center'><img width=484
height=157 id="Picture 61" src="chapter14_files/image010.jpg"></p>

<p class=FigureCaption>Figure 14-6. Cuisenaire rods demonstrating Greatest
Common Divisor.</p>

<p class=MsoNormal>More information about Cuisenaire rods can be found at <span
class=URL><u>http://invpy.com/cuisenaire</u></span>.</p>

<h2><a name="_Toc353630797">Practice Exercises, Chapter 14, Set B</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice14B</u></span>.</p>

<h2><a name="_Toc353630798">Multiple Assignment</a></h2>

<p class=MsoNormal>Our GCD function will use Python’s multiple assignment trick.
The multiple assignment trick lets you assign more than one variable with a
single assignment statement. Try typing the following into the interactive
shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam, eggs = 42, 'Hello'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>42</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
eggs</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'Hello'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
a, b, c, d = ['Alice', 'Bob', 'Carol', 'David']</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
a</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'Alice'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
b</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'Bob'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
c</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'Carol'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
d</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'David'</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>The variable names on the left side of the <span
class=Literal>=</span> operator and the values on the right side of the <span
class=Literal>=</span> operator are separated by a comma. You can also assign each
of the values in a list to its own variable, if the number of items in the list
is the same as the number of variables on the left side of the <span
class=Literal>=</span> operator.</p>

<p class=MsoNormal>Be sure to have the same number of variables as you have
values, otherwise Python will raise an error that says the call needs more or
has too many values:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
a, b, c = 1, 2</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Traceback
(most recent call last):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>  File
&quot;&lt;pyshell#8&gt;&quot;, line 1, in &lt;module&gt;</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    a, b,
c = 1, 2</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>ValueError:
need more than 2 values to unpack</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&nbsp;</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
a, b, c = 1, 2, 3, 4, 5, 6</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Traceback
(most recent call last):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>  File
&quot;&lt;pyshell#9&gt;&quot;, line 1, in &lt;module&gt;</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    a, b,
c = 1, 2, 3, 4, 5, 6</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>ValueError:
too many values to unpack</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<h2><a name="_Toc353630799">Swapping Values with the Multiple Assignment Trick</a></h2>

<p class=MsoNormal>One of the main uses of the multiple assignment trick is to
swap the values in two variables. Try typing the following into the interactive
shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = 'hello'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
eggs = 'goodbye'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam, eggs = eggs, spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'goodbye'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
eggs</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>'hello'</p>

</div>

<p class=MsoNormal>We will use this swapping trick in our implementation of
Euclid’s algorithm.</p>

<h2><a name="_Toc353630800">Euclid’s Algorithm for Finding the GCD of Two
Numbers</a></h2>

<p class=MsoNormal>Figuring out the GCD of two numbers will be important for
doing the multiplicative and affine ciphers. It seems simple enough: just look
at the numbers and write down any factors you can think of, then compare the
lists and find the largest number that is in both of them.</p>

<p class=MsoNormal>But to program a computer to do it, we’ll need to be more
precise. We need an algorithm (that is, a specific series of steps we execute)
to find the GCD of two numbers.</p>

<p class=MsoNormal>A mathematician who lived 2,000 years ago named Euclid came
up with an algorithm for finding the greatest common divisor of two numbers.
Here’s a statue of Euclid at Oxford University:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=195
height=228 id="Picture 1" src="chapter14_files/image011.jpg"></p>

<p class=FigureCaption>Figure 14-7. Euclid may or may not have looked like
this.</p>

<p class=MsoNormal>Of course since no likeness or description of Euclid exists in
any historical document, no one knows what he actually looked like at all. (Artists
and sculptors just make it up.) This statue could also be called, “Statue of
Some Guy with a Beard”.</p>

<p class=MsoNormal>Euclid’s GCD algorithm is short. Here’s a function that
implements his algorithm as Python code, which returns the GCD of integers <span
class=Literal>a</span> and <span class=Literal>b</span>:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>def gcd(a,
b):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    while
a != 0:</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>        a,
b = b % a, a</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>    return b</p>

</div>

<p class=MsoNormal>If you call this function from the interactive shell and
pass it <span class=Literal>24</span> and <span class=Literal>30</span> for the
<span class=Literal>a</span> and <span class=Literal>b</span> parameters, the
function will return <span class=Literal>6</span>. You could have done this
yourself with pencil and paper. But since you’ve programmed a computer to do
this, it can easily handle very large numbers:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
gcd(24, 30)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>6</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
gcd(409119243, 87780243)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>6837</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>How Euclid’s algorithm works is beyond the scope of this
book, but you can rely on this function to return the GCD of the two integers
you pass it.</p>

<h2><a name="_Toc353630801">“Relatively Prime”</a></h2>

<p class=MsoNormal>Relatively prime numbers are used for the multiplicative and
affine ciphers. We say that two numbers are relatively prime if their greatest
common divisor is 1. That is, the numbers <span class=Literal>a</span> and <span
class=Literal>b</span> are relatively prime to each other if <span
class=Literal>gcd(a, b) == 1</span>.</p>

<h2><a name="_Toc353630802">Practice Exercises, Chapter 14, Set C</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice14C</u></span>.</p>

<h2><a name="_Toc353630803">The Multiplicative Cipher</a></h2>

<p class=MsoNormal>In the Caesar cipher, encrypting and decrypting symbols
involved converting them to numbers, adding or subtracting the key, and then
converting the new number back to a symbol.</p>

<p class=MsoNormal>What if instead of adding the key to do the encryption, we
use multiplication? There would be a “wrap-around” issue, but the mod operator
would solve that. For example, let’s use the symbol set of just uppercase
letters and the key 7. Here’s a list of the letters and their numbers:</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr style='height:13.1pt'>
  <td width=29 valign=top style='width:21.85pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>0</p>
  </td>
  <td width=28 valign=top style='width:21.15pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>1</p>
  </td>
  <td width=28 valign=top style='width:21.15pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>2</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>3</p>
  </td>
  <td width=27 valign=top style='width:20.45pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>4</p>
  </td>
  <td width=26 valign=top style='width:19.75pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>5</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>6</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>7</p>
  </td>
  <td width=25 valign=top style='width:19.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>8</p>
  </td>
  <td width=25 valign=top style='width:19.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>9</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>10</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>11</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>12</p>
  </td>
 </tr>
 <tr style='height:13.1pt'>
  <td width=29 valign=top style='width:21.85pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>A</p>
  </td>
  <td width=28 valign=top style='width:21.15pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>B</p>
  </td>
  <td width=28 valign=top style='width:21.15pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>C</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>D</p>
  </td>
  <td width=27 valign=top style='width:20.45pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>E</p>
  </td>
  <td width=26 valign=top style='width:19.75pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>F</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>G</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>H</p>
  </td>
  <td width=25 valign=top style='width:19.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>I</p>
  </td>
  <td width=25 valign=top style='width:19.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>J</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>K</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>L</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;padding:0in 5.4pt 0in 5.4pt;
  height:13.1pt'>
  <p class=TableListing>M</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>13</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>14</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>15</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>16</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>17</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>18</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>19</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>20</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>21</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>22</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>23</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>24</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>25</p>
  </td>
 </tr>
 <tr>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>N</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>P</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>R</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>T</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>V</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>X</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Z</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To find what the symbol F encrypts to with key 7, multiply
its number (5) by 7 and mod by 26 (to handle the “wrap-around” with our
26-symbol set). Then use that number’s symbol. (5 × 7) mod 26 = 9, and 9 is the
number for the symbol J. So F encrypts to J in the multiplicative cipher with
key 7. Do the same with all of the letters:</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Times New Roman","serif"'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<p class=TableCaption>Table 14-1. Encrypting each letter with the
multiplicative cipher with key 7.</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td valign=top style='border-top:double windowtext 1.5pt;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Plaintext</p>
  <p class=TableHeader>Symbol</p>
  </td>
  <td valign=top style='border-top:double windowtext 1.5pt;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Number</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Encryption with Key 7</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Ciphertext</p>
  <p class=TableHeader>Symbol</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>A</p>
  </td>
  <td valign=top style='border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>0</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(0 * 7) % 26  =  0</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>A</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>B</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>1</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(1 * 7) % 26  =  7</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>H</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>C</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>2</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(2 * 7) % 26  =  14</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>D</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>3</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(3 * 7) % 26  =  21</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>V</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>E</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>4</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(4 * 7) % 26  =  2</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>C</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>F</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>5</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(5 * 7) % 26  =  9</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>J</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>G</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>6</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(6 * 7) % 26  =  16</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>H</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>7</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(7 * 7) % 26  =  23</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>X</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>I</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>8</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(8 * 7) % 26  =  4</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>E</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>J</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>9</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(9 * 7) % 26  =  11</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>L</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>K</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>10</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(10 * 7) % 26  =  18</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>L</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>11</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(11 * 7) % 26  =  25</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>M</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>12</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(12 * 7) % 26  =  6</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>G</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>N</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>13</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(13 * 7) % 26  =  13</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>N</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>14</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(14 * 7) % 26  =  20</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>P</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>15</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(15 * 7) % 26  =  1</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>B</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>16</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(16 * 7) % 26  =  8</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>I</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>R</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>17</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(17 * 7) % 26  =  15</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>P</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>18</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(18 * 7) % 26  =  22</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>T</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>19</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(19 * 7) % 26  =  3</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>D</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>20</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(20 * 7) % 26  =  10</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>K</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>V</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>21</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(21 * 7) % 26  =  17</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>R</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>22</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(22 * 7) % 26  =  24</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>X</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>23</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(23 * 7) % 26  =  5</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>F</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>24</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(24 * 7) % 26  =  12</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>M</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Z</p>
  </td>
  <td valign=top style='border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>25</p>
  </td>
  <td width=141 valign=top style='width:105.55pt;border:none;border-bottom:
  double windowtext 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>(25 * 7) % 26  =  19</p>
  </td>
  <td width=70 valign=top style='width:52.55pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>T</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>You will end up with this mapping for the key 7: to encrypt
you replace the top letter with the letter under it, and vice versa to decrypt:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=23 valign=top style='width:16.95pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>A</p>
  </td>
  <td width=23 valign=top style='width:16.95pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>B</p>
  </td>
  <td width=23 valign=top style='width:16.95pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>C</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>D</p>
  </td>
  <td width=22 valign=top style='width:16.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>E</p>
  </td>
  <td width=21 valign=top style='width:15.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>F</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>G</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>H</p>
  </td>
  <td width=21 valign=top style='width:16.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>I</p>
  </td>
  <td width=21 valign=top style='width:16.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>J</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>K</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>L</p>
  </td>
  <td width=25 valign=top style='width:18.45pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>M</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>N</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
  <td width=22 valign=top style='width:16.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>P</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
  <td width=22 valign=top style='width:16.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>R</p>
  </td>
  <td width=25 valign=top style='width:18.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>T</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>V</p>
  </td>
  <td width=25 valign=top style='width:18.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>X</p>
  </td>
  <td width=25 valign=top style='width:18.45pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td width=21 valign=top style='width:16.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Z</p>
  </td>
 </tr>
 <tr>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:.25in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
 </tr>
 <tr>
  <td width=23 valign=top style='width:16.95pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>A</p>
  </td>
  <td width=23 valign=top style='width:16.95pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>H</p>
  </td>
  <td width=23 valign=top style='width:16.95pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>V</p>
  </td>
  <td width=22 valign=top style='width:16.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>C</p>
  </td>
  <td width=21 valign=top style='width:15.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>J</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>X</p>
  </td>
  <td width=21 valign=top style='width:16.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>E</p>
  </td>
  <td width=21 valign=top style='width:16.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>L</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td width=25 valign=top style='width:18.45pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>G</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>N</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
  <td width=22 valign=top style='width:16.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>B</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>I</p>
  </td>
  <td width=22 valign=top style='width:16.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>P</p>
  </td>
  <td width=25 valign=top style='width:18.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>D</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>K</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>R</p>
  </td>
  <td width=25 valign=top style='width:18.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td width=23 valign=top style='width:17.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>F</p>
  </td>
  <td width=25 valign=top style='width:18.45pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>M</p>
  </td>
  <td width=21 valign=top style='width:16.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>T</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>It wouldn’t take long for an attacker to brute-force through
the first 7 keys. But the good thing about the multiplicative cipher is that it
can work with very large keys, like 8,953,851 (which has the letters of the
alphabet map to the letters AXUROLIFCZWTQNKHEBYVSPMJGD). It would take quite
some time for a computer to brute-force through nearly nine million keys.</p>

<h2><a name="_Toc353630804">Practice Exercises, Chapter 14, Set D</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice14D</u></span>.</p>

<h2><a name="_Toc353630805">Multiplicative Cipher + Caesar Cipher = The Affine
Cipher</a></h2>

<p class=MsoNormal>One downside to the multiplicative cipher is that the letter
A always maps to the letter A. This is because A’s number is 0, and 0
multiplied by anything will always be 0. We can fix this by adding a second key
that performs a Caesar cipher encryption after the multiplicative cipher’s
multiplication and modding is done.</p>

<p class=MsoNormal>This is called the affine cipher. The affine cipher has two
keys. “Key A” is the integer that the letter’s number is multiplied by. After
modding this number by 26, “Key B” is the integer that is added to the number.
This sum is also modded by 26, just like in the original Caesar cipher.</p>

<p class=MsoNormal>This means that the affine cipher has 26 times as many possible
keys as the multiplicative cipher. It also ensures that the letter A does not
always encrypt to the letter A.</p>

<p class=MsoNormal><img width=576 height=133 id="Picture 5"
src="chapter14_files/image012.jpg"></p>

<p class=FigureCaption>Figure 14-8. The encryption and decryption are mirrors
of each other.</p>

<h2><a name="_Toc353630806">The First Affine Key Problem</a></h2>

<p class=MsoNormal>There are two problems with the multiplicative cipher’s key
and affine cipher’s Key A. You cannot just use any number for Key A. For
example, if you chose the key 8, here is the mapping you would end up with:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>A</p>
  </td>
  <td width=22 valign=top style='width:16.3pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>B</p>
  </td>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>C</p>
  </td>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>D</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>E</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>F</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>G</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>H</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>I</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>J</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>K</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>L</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>M</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>N</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>P</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>R</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>T</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>V</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>X</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td width=21 valign=top style='width:15.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Z</p>
  </td>
 </tr>
 <tr>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.3pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
  <td width=21 valign=top style='width:15.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8597;</p>
  </td>
 </tr>
 <tr>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>A</p>
  </td>
  <td width=22 valign=top style='width:16.3pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>I</p>
  </td>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
  <td width=22 valign=top style='width:16.75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>G</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>E</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>M</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>C</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>K</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>A</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>I</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>G</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>E</p>
  </td>
  <td width=24 valign=top style='width:18.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>M</p>
  </td>
  <td width=25 valign=top style='width:18.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>C</p>
  </td>
  <td width=22 valign=top style='width:16.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>K</p>
  </td>
  <td width=21 valign=top style='width:15.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This mapping doesn’t work at all! Both the letters C and P
encrypt to Q. When we encounter a Q in the ciphertext, how do we know which it
decrypts to?! The same problem exists for encrypting A and N, F and S, and many
others.</p>

<p class=MsoNormal>So some keys will work in the affine cipher while others
will not. The secret to determining which key numbers will work is this:</p>

<p class=MsoNormal><strong>In the affine cipher, the Key A number and the size
of the symbol set must be relatively prime to each other. That is, gcd(key,
size of symbol set) == 1.</strong></p>

<p class=MsoNormal>We can use the <span class=Literal>gcd()</span> function we
wrote earlier to test this. The key 7 works as an affine cipher key because <span
class=Literal>gcd(7, 26)</span> returns 1. The larger key 8,953,851 will also
work because <span class=Literal>gcd(8953851, 26) </span>also returns <span
class=Literal>1</span>. However, the key 8 did not work because <span
class=Literal>gcd(8, 26)</span> is <span class=Literal>2</span>. If the GCD of
the key and the symbol set size is not 1, then they are not relatively prime
and the key won’t work.</p>

<p class=MsoNormal>The math we learned earlier sure is coming in handy now. We
need to know how mod works because it is part of the GCD and affine cipher
algorithms. And we need to know how GCD works because that will tell us if a
pair of numbers is relatively prime. And we need to know if a pair of numbers
is relatively prime or not in order to choose valid keys for the affine cipher.</p>

<p class=MsoNormal>The second problem with affine cipher’s key is discussed in
the next chapter.</p>

<h2><a name="_Toc353630807">Decrypting with the Affine Cipher</a></h2>

<p class=MsoNormal>In the Caesar cipher, we used addition to encrypt and
subtraction to decrypt. In the affine cipher, we use multiplication to encrypt.
You might think that we need to divide to decrypt with the affine cipher. But
if you try this yourself, you’ll quickly see that it doesn’t work. To decrypt
with the affine cipher, we need to multiply by the key’s modular inverse.</p>

<p class=MsoNormal>A <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>modular inverse</span></span> (which we will call <span
class=Literal>i</span>) of two numbers (which we will call <span class=Literal>a</span>
and <span class=Literal>m</span>) is such that <span class=Literal>(a * i) % m ==
1</span>. For example, let’s find the modular inverse of “5 mod 7”. There is
some number <span class=Literal>i</span> where <span class=Literal>(5 * i) % 7</span>
will equal “1”. We will have to brute-force this calculation:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 isn’t the modular inverse of 5 mod 7, because (5 * 1) % 7 = 5.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2 isn’t the modular inverse of 5 mod 7, because (5 * 2) % 7 = 3.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>3 is the modular inverse of 5 mod 7, because (5 * 3) % 7 = 1.</p>

<p class=MsoNormal>The encryption key and decryption keys for the affine cipher
are two different numbers. The encryption key can be anything we choose as long
as it is relatively prime to 26 (which is the size of our symbol set). If we
have chosen the key 7 for encrypting with the affine cipher, the decryption key
will be the modular inverse of 7 mod 26:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 is not the modular inverse of 7 mod 26, because (7 * 1) % 26 =
7.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2 is not the modular inverse of 7 mod 26, because (7 * 2) % 26 =
14.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>3 is not the modular inverse of 7 mod 26, because (7 * 3) % 26 =
21.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>4 is not the modular inverse of 7 mod 26, because (7 * 4) % 26 =
2.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>5 is not the modular inverse of 7 mod 26, because (7 * 5) % 26 =
9.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>6 is not the modular inverse of 7 mod 26, because (7 * 6) % 26 =
16.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>7 is not the modular inverse of 7 mod 26, because (7 * 7) % 26 =
23.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>8 is not the modular inverse of 7 mod 26, because (7 * 8) % 26 =
4.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>9 is not the modular inverse of 7 mod 26, because (7 * 9) % 26 =
11.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>10 is not the modular inverse of 7 mod 26, because (7 * 10) % 26
= 18.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>11 is not the modular inverse of 7 mod 26, because (7 * 11) % 26
= 25.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>12 is not the modular inverse of 7 mod 26, because (7 * 12) % 26
= 6.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>13 is not the modular inverse of 7 mod 26, because (7 * 13) % 26
= 13.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>14 is not the modular inverse of 7 mod 26, because (7 * 14) % 26
= 20.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>15 <strong>is</strong> the modular inverse of 7 mod 26, because
(7 * 15) % 26 = 1.</p>

<p class=MsoNormal>So the affine cipher decryption key is 15. To decrypt a
ciphertext letter, we take that letter’s number and multiply it by 15, and then
mod 26. This will be the number of the original plaintext’s letter.</p>

<h2><a name="_Toc353630808">Finding Modular Inverses</a></h2>

<p class=MsoNormal>In order to calculate the modular inverse to get the
decryption key, we could take a brute-force approach and start testing the
integer 1, and then 2, and then 3, and so on like we did above. But this will
be very time-consuming for large keys like 8,953,851.</p>

<p class=MsoNormal>There is an algorithm for finding the modular inverse just
like there was for finding the Greatest Common Divisor. Euclid’s Extended
Algorithm can be used to find the modular inverse of a number:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>def
findModInverse(a, m):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    if
gcd(a, m) != 1:</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>       
return None <span class=SourceCodeComment># no mod inverse exists if a &amp; m
aren't relatively prime</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    u1,
u2, u3 = 1, 0, a</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    v1,
v2, v3 = 0, 1, m</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    while
v3 != 0:</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>        q
= u3 // v3 <span class=SourceCodeComment># // is the integer division operator</span></p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>       
v1, v2, v3, u1, u2, u3 = (u1 - q * v1), (u2 - q * v2), (u3 - q * v3), v1, v2,
v3</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>    return
u1 % m</p>

</div>

<p class=MsoNormal>You don’t have to understand how Euclid’s Extended Algorithm
works in order to make use of it. We’re just going to have our programs call this
function. If you’d like to learn more about how it works, you can read <span
class=URL><u>http://invpy.com/euclid</u></span>.</p>

<h2><a name="_Toc353630809">The </a><span class=Literal>//</span> Integer
Division Operator</h2>

<p class=MsoNormal>You may have noticed the <span class=Literal>//</span>
operator used in the <span class=Literal>findModInverse()</span> function
above. This is the integer division operator. It divides two numbers and rounds
down. Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
41 // 7</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>5</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
41 / 7</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>5.857142857142857</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
10 // 5</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>2</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
10 / 5</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>2.0</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>Notice that an expression with the <span class=Literal>//</span>
integer division operator always evaluates to an int, not a float.</p>

<h2><a name="_Toc353630810">Source Code of the </a><span class=Literal>cryptomath</span>
Module</h2>

<p class=MsoNormal>The <span class=Literal>gcd()</span> and <span
class=Literal>findModInverse()</span> functions will be used by more than one
of our cipher programs later in this book, so we should put this code into a
separate module. In the file editor, type in the following code and save it as <span
class=Filename>cryptomath.py</span>:</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for cryptomath.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 1.</span> <span
class=SourceCodeComment># Cryptomath Module</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 3.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 4.</span> def
gcd(a, b):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 5.</span>     <span
class=SourceCodeComment># Return the GCD of a and b using Euclid's Algorithm</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 6.</span>     while
a != 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 7.</span>         a,
b = b % a, a</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>     return
b</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.</span> def
findModInverse(a, m):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>12.</span>     <span
class=SourceCodeComment># Returns the modular inverse of a % m, which is</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>13.</span>     <span
class=SourceCodeComment># the number x such that a*x % m = 1</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15.</span>     if
gcd(a, m) != 1:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16.</span>         return
None <span class=SourceCodeComment># no mod inverse if a &amp; m aren't
relatively prime</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18.</span>     <span
class=SourceCodeComment># Calculate using the Extended Euclidean Algorithm:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>     u1,
u2, u3 = 1, 0, a</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>     v1,
v2, v3 = 0, 1, m</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21.</span>     while
v3 != 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22.</span>         q
= u3 // v3 <span class=SourceCodeComment># // is the integer division operator</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>23.</span>         v1,
v2, v3, u1, u2, u3 = (u1 - q * v1), (u2 - q * v2), (u3 - q * v3), v1, v2, v3</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>24.</span>     return
u1 % m</p>

</div>

<p class=MsoNormal>The GCD algorithm is described earlier in this chapter. The <span
class=Literal>findModInverse()</span> function implements an algorithm called
Euclid’s Extended Algorithm. How these functions work is beyond the scope of
this book, but you don’t have to know how the code works in order to make use
of it.</p>

<p class=MsoNormal>From the interactive shell, you can try out these functions
after importing the module. Try typing the following into the interactive
shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
import cryptomath</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
cryptomath.gcd(24, 32)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>8</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
cryptomath.gcd(37, 41)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>1</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
cryptomath.findModInverse(7, 26)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>15</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
cryptomath.findModInverse(8953851, 26)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>17</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<h2><a name="_Toc353630811">Practice Exercises, Chapter 14, Set E</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice14E</u></span>.</p>

<h2><a name="_Toc353630812">Summary</a></h2>

<p class=MsoNormal>Since the multiplicative cipher is the same thing as the
affine cipher except using Key B of <span class=Literal>0</span>, we won’t have
a separate program for the multiplicative cipher. And since it is just a less
secure version of the affine cipher, you shouldn’t use it anyway. The source
code to our affine cipher program will be presented in the next chapter.</p>

<p class=MsoNormal>The math presented in this chapter isn’t so hard to understand.
Modding with the <span class=Literal>%</span> operator finds the “remainder”
between two numbers. The Greatest Common Divisor function returns the largest
number that can divide two numbers. If the GCD of two numbers is 1, we say that
those numbers are “relatively prime” to each other. The most useful algorithm
to find the GCD of two numbers is Euclid’s Algorithm.</p>

<p class=MsoNormal>The affine cipher is sort of like the Caesar cipher, except
it uses multiplication instead of addition to encrypt letters. Not all numbers
will work as keys though. The key number and the size of the symbol set must be
relatively prime towards each other.</p>

<p class=MsoNormal>To decrypt with the affine cipher we also use
multiplication. To decrypt, the modular inverse of the key is the number that
is multiplied. The modular inverse of “a mod m” is a number <span
class=Literal>i</span> such that <span class=Literal>(a * i) % m == 1</span>. To
write a function that finds the modular inverse of a number, we use Euclid’s
Extended Algorithm.</p>

<p class=MsoNormal>Once we understand these math concepts, we can write a program
for the affine cipher in the next chapter.</p>

</div>

</body>

</html>
