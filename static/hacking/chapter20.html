<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Another Typewriter";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:33.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:44.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:66.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:77.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:88.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.Definition
	{mso-style-name:Definition;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Times New Roman","serif";}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Times New Roman","serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
p.TableListing, li.TableListing, div.TableListing
	{mso-style-name:"Table Listing";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TableHeader, li.TableHeader, div.TableHeader
	{mso-style-name:"Table Header";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpFirst, li.ChapterTitleCxSpFirst, div.ChapterTitleCxSpFirst
	{mso-style-name:"Chapter TitleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpMiddle, li.ChapterTitleCxSpMiddle, div.ChapterTitleCxSpMiddle
	{mso-style-name:"Chapter TitleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpLast, li.ChapterTitleCxSpLast, div.ChapterTitleCxSpLast
	{mso-style-name:"Chapter TitleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.URL
	{mso-style-name:URL;
	color:windowtext;
	text-decoration:underline;}
p.SourceCodeExcerpt, li.SourceCodeExcerpt, div.SourceCodeExcerpt
	{mso-style-name:"Source Code Excerpt";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpFirst, li.SourceCodeExcerptCxSpFirst, div.SourceCodeExcerptCxSpFirst
	{mso-style-name:"Source Code ExcerptCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpMiddle, li.SourceCodeExcerptCxSpMiddle, div.SourceCodeExcerptCxSpMiddle
	{mso-style-name:"Source Code ExcerptCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpLast, li.SourceCodeExcerptCxSpLast, div.SourceCodeExcerptCxSpLast
	{mso-style-name:"Source Code ExcerptCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.SourceCode
	{mso-style-name:"Source Code";
	font-family:"Lucida Console";}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
span.SampleRunResponse
	{mso-style-name:"Sample Run Response";
	color:black;}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.MessageText, li.MessageText, div.MessageText
	{mso-style-name:"Message Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Lucida Sans Typewriter";}
p.TopicsCoveredbox, li.TopicsCoveredbox, div.TopicsCoveredbox
	{mso-style-name:"Topics Covered box";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpFirst, li.TopicsCoveredboxCxSpFirst, div.TopicsCoveredboxCxSpFirst
	{mso-style-name:"Topics Covered boxCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpMiddle, li.TopicsCoveredboxCxSpMiddle, div.TopicsCoveredboxCxSpMiddle
	{mso-style-name:"Topics Covered boxCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpLast, li.TopicsCoveredboxCxSpLast, div.TopicsCoveredboxCxSpLast
	{mso-style-name:"Topics Covered boxCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
p.FigureCaption, li.FigureCaption, div.FigureCaption
	{mso-style-name:"Figure Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpFirst, li.FigureCaptionCxSpFirst, div.FigureCaptionCxSpFirst
	{mso-style-name:"Figure CaptionCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpMiddle, li.FigureCaptionCxSpMiddle, div.FigureCaptionCxSpMiddle
	{mso-style-name:"Figure CaptionCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpLast, li.FigureCaptionCxSpLast, div.FigureCaptionCxSpLast
	{mso-style-name:"Figure CaptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.SourceCodeFilename
	{mso-style-name:"Source Code Filename";
	font-family:"Lucida Sans Typewriter";}
p.TableCaption, li.TableCaption, div.TableCaption
	{mso-style-name:"Table Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	text-align:center;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.Filename
	{mso-style-name:Filename;
	font-style:italic;}
p.CipherInfoBox, li.CipherInfoBox, div.CipherInfoBox
	{mso-style-name:"Cipher Info Box";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	background:#FFFF99;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Another Typewriter";
	letter-spacing:1.4pt;}
p.ChapterQuotes, li.ChapterQuotes, div.ChapterQuotes
	{mso-style-name:"Chapter Quotes";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpFirst, li.ChapterQuotesCxSpFirst, div.ChapterQuotesCxSpFirst
	{mso-style-name:"Chapter QuotesCxSpFirst";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpMiddle, li.ChapterQuotesCxSpMiddle, div.ChapterQuotesCxSpMiddle
	{mso-style-name:"Chapter QuotesCxSpMiddle";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpLast, li.ChapterQuotesCxSpLast, div.ChapterQuotesCxSpLast
	{mso-style-name:"Chapter QuotesCxSpLast";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.CodeExample, li.CodeExample, div.CodeExample
	{mso-style-name:"Code Example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpFirst, li.CodeExampleCxSpFirst, div.CodeExampleCxSpFirst
	{mso-style-name:"Code ExampleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpMiddle, li.CodeExampleCxSpMiddle, div.CodeExampleCxSpMiddle
	{mso-style-name:"Code ExampleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpLast, li.CodeExampleCxSpLast, div.CodeExampleCxSpLast
	{mso-style-name:"Code ExampleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SmallerText, li.SmallerText, div.SmallerText
	{mso-style-name:"Smaller Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code \(Headline\)";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code \(Headline\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code \(Headline\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code \(Headline\)CxSpLast";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1, li.Style1, div.Style1
	{mso-style-name:Style1;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpFirst, li.Style1CxSpFirst, div.Style1CxSpFirst
	{mso-style-name:Style1CxSpFirst;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpMiddle, li.Style1CxSpMiddle, div.Style1CxSpMiddle
	{mso-style-name:Style1CxSpMiddle;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpLast, li.Style1CxSpLast, div.Style1CxSpLast
	{mso-style-name:Style1CxSpLast;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>
<div style='float: right; height: 310px; font-family: sans-serif;'>Ad: Programming books by Al Sweigart<br />
    <a href='http://www.nostarch.com/automatestuff' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src='/images/cover_automate_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/gp/product/0982106017?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src='/images/cover_inventwithpython_thumb.jpg' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src='/images/cover_makinggames_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='https://www.amazon.com/gp/product/1593278225/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593278225&linkCode=as2&tag=playwithpyth-20&linkId=bf3b22819f0886d277e88b8a653b81ad' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src='/images/cover_crackingcodes_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
</div>

<div class=WordSection1><p><strong>Note: The second edition of this book is available under the title <em><a href="https://inventwithpython.com/cracking">Cracking Codes with Python</a></em></strong></p>

<p class=MsoNormal align=center style='text-align:center'><img width=327
height=180 id="Picture 41" src="chapter20_files/image001.jpg"> </p>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc353630886"><span style='font-variant:normal !important;
text-transform:uppercase'>Frequency Analysis</span></a><span style='font-variant:
normal !important;text-transform:uppercase'> </span></h1>

</div>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#DBE5F1'>

<p class=TopicsCoveredboxCxSpFirst style='background:#DBE5F1;border:none;
padding:0in'>Topics Covered In This Chapter:</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Letter Frequency and ETAOIN</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>sort()</span> Method’s <span
class=Literal>key</span> and <span class=Literal>reverse</span> Keyword
Arguments</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Passing Functions as Values Instead of Calling Functions</p>

<p class=TopicsCoveredboxCxSpLast style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Converting Dictionaries to Lists with the <span class=Literal>keys()</span>,
<span class=Literal>values()</span>, <span class=Literal>items()</span>
Dictionary Methods</p>

</div>

<p class=ChapterQuotesCxSpFirst>The ineffable talent for finding patterns in
chaos cannot do its thing unless he immerses himself in the chaos first. If
they do contain patterns, he does not see them just now, in any rational way.
But there may be some subrational part of his mind that can go to work, now
that the letters have passed before his eyes and through his pencil, and that
may suddenly present him with a gift-wrapped clue--or even a full solution--a
few weeks from now while he is shaving or antenna-twiddling.</p>

<p class=ChapterQuotesCxSpMiddle>&nbsp;</p>

<p class=ChapterQuotesCxSpLast align=right style='text-align:right'><span
style='font-size:11.0pt;line-height:115%'>“Cryptonomicon” by Neal Stephenson</span></p>

<p class=MsoNormal>A coin has 2 sides, and when you flip a coin, about half the
time it will come up heads and half of the time it comes up tails. The <span
class=Definition><span style='font-size:12.0pt;line-height:115%'>frequency</span></span>
(that is, how often) that the coin flip ends up heads is the same as the frequency
that it ends up tails: about one-half or 50%.</p>

<p class=MsoNormal>There are 26 letters in the English alphabet, but they don’t
each appear an equal amount of the time in English text. Some letters are used
more often than others. For example, if you look at the letters in this book you
will find that the letters E, T, A and O occur very frequently in English
words. But the letters J, X, Q, and Z are rarely found in English text. We can
use this fact to help crack Vigenère-encrypted messages. This technique is
called frequency analysis.</p>

<p class=MsoNormal>Here are the frequencies of the 26 letters in average
English text. This graph is compiled by grabbing English text from books,
newspapers, and other sources to count often each letter appears:</p>

<p class=FigureCaption>Figure 20-1. Letter frequency of normal English.</p>

<p class=MsoNormal align=center style='text-align:center'><img width=393
height=314 id="Picture 17" src="chapter20_files/image002.png"></p>

<p class=MsoNormal>If we sort these in order of greatest frequency to least, we
find that E is the most frequent letter, followed by T, followed by A, and so
on:</p>

<p class=FigureCaption>Figure 20-2. Letter frequency of normal English, sorted.</p>

<p class=MsoNormal align=center style='text-align:center'><img width=385
height=308 id="Picture 15" src="chapter20_files/image003.png"></p>

<p class=MsoNormal>The word “ETAOIN” is a handy way to remember the six most
frequent letters. The full list of letters ordered by frequency is
“ETAOINSHRDLCUMWFGYPBVKJXQZ”.</p>

<p class=MsoNormal>Think about the transposition cipher: Messages encrypted
with the transposition cipher contain all the original letters of the original
English plaintext, except in a different order. But the frequency of each
letter in the ciphertext remains the same: E, T, and A should occur much more
often than Q and Z. Because they are the same letters, the frequencies of these
letters in the ciphertext are the same as the plaintext.</p>

<p class=MsoNormal>The Caesar and simple substitution ciphers have their
letters replaced, but you can still count the frequency of the letters. The
letters may be different but the frequencies are the same. There should be
letters that occur the most often in the ciphertext. These letters are good
candidates for being cipherletters for the E, T, or A letters. The letters in
the ciphertext that occur least are more likely to be X, Q, and Z.</p>

<p class=MsoNormal>This counting of letters and how frequently they appear in
both plaintexts and ciphertexts is called <span class=Definition><span
style='font-size:12.0pt;line-height:115%'>frequency analysis</span></span>.</p>

<p class=MsoNormal>Since the Vigenère cipher is essentially multiple Caesar
cipher keys used in the same message, we can use frequency analysis to hack
each subkey one at a time based on the letter frequency of the attempted
decryptions. We can’t use English word detection, since any word in the
ciphertext will have been encrypted with multiple subkeys. But we don’t need
full words, we can analyze the letter frequency of each subkey’s decrypted
text. (This will be explained more in the next chapter.)</p>

<h3>Matching Letter Frequencies</h3>

<p class=MsoNormal>By “matching the letter frequency of regular English” we
could try several different algorithms. The one used in our hacking program
will simply order the letters from most frequent to least frequent. We will
calculate what we will call in this book a <span class=Definition><span
style='font-size:12.0pt;line-height:115%'>frequency match score</span></span>
for this ordering of frequencies. To calculate the frequency match score for a
string, the score starts at 0 and each time one of the letters E, T, A, O, I, N
appears among the six most frequent letters of the string, we add a point to the
score. And each time one of the letters V, K, J, X, Q, or Z appears among the
six least frequent letters of the string, we add a point to the score. The
frequency match score for a string will be an integer from 0 (meaning the
letter frequency of the string is completely unlike regular English’s letter
frequency) to 12 (meaning it is identical to regular English’s letter
frequency).</p>

<h3>An Example of Calculating Frequency Match Score</h3>

<p class=MsoNormal>For example, look at this ciphertext which was encrypted
with a simple substitution cipher:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MessageText style='border:none;padding:0in'><span style='font-size:
9.0pt;line-height:115%'>“Sy l nlx sr pyyacao l ylwj eiswi upar lulsxrj isr
sxrjsxwjr, ia esmm rwctjsxsza sj wmpramh, lxo txmarr jia aqsoaxwa sr
pqaceiamnsxu, ia esmm caytra jp famsaqa sj. Sy, px jia pjiac ilxo, ia sr
pyyacao rpnajisxu eiswi lyypcor l calrpx ypc lwjsxu sx lwwpcolxwa jp isr
sxrjsxwjr, ia esmm lwwabj sj aqax px jia rmsuijarj aqsoaxwa. Jia pcsusx py
nhjir sr agbmlsxao sx jisr elh. -Facjclxo Ctrramm”</span></p>

</div>

<p class=MsoNormal>If we count the frequency of each letter and then arrange
them by order of its frequency, we end up with this ordering: ASRXJILPWMCYOUEQNTHBFZGKVD.
That is, A is the most frequent letter, S is the 2<sup>nd</sup> most frequent
letter, and so on down to the letter D, which appears the least frequently.</p>

<p class=MsoNormal>The six most frequent letters in this ordering are A, S, R,
X, J, and I. Only two of these letters (A and I) appear in the ETAOIN set of
letters. The six least frequent letters in the ordering are F, Z, G, K, V, and
D. Only three of these letters (Z, K, and V) appear in the VKJXQZ set of
letters. So the frequency ordering ASRXJILPWMCYOUEQNTHBFZGKVD (which comes from
the above ciphertext) has a frequency match score of 5.</p>

<p class=MsoNormal align=center style='text-align:center'><img width=576
height=137 id="Picture 20" src="chapter20_files/image004.jpg"></p>

<p class=FigureCaption>Figure 20-3. How the frequency match score of ASRXJILPWMCYOUEQNTHBFZGKVD
is calculated.</p>

<p class=MsoNormal>The above ciphertext was encrypted with a simple
substitution cipher, which is why the frequency match score isn’t very high.
The letter frequencies of simple substitution ciphertext won’t match regular
English’s letter frequencies.</p>

<h3>Another Example of Calculating Frequency Match Score</h3>

<p class=MsoNormal>For another example, look at this ciphertext which was
encrypted with a transposition cipher:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MessageText style='border:none;padding:0in'><span style='font-size:
9.0pt;line-height:115%'>“I rc ascwuiluhnviwuetnh,osgaa ice tipeeeee
slnatsfietgi tittynecenisl. e fo f fnc isltn sn o a yrs sd onisli ,l erglei
trhfmwfrogotn,l  stcofiit.aea  wesn,lnc ee w,l eIh eeehoer ros  iol er snh nl
oahsts  ilasvih  tvfeh rtira id thatnie.im ei-dlmf i  thszonsisehroe,
aiehcdsanahiec  gv gyedsB affcahiecesd d lee   onsdihsoc nin cethiTitx  eRneahgin
r e teom fbiotd  n  ntacscwevhtdhnhpiwru”</span></p>

</div>

<p class=MsoNormal>The ordering of most to least frequent letters in the above
ciphertext is: EISNTHAOCLRFDGWVMUYBPZXQJK. (That is, E is the most frequent
letter, I the 2<sup>nd</sup> most frequent letter, and so on.)</p>

<p class=MsoNormal>Of the top and bottom six letters in this ordering, the four
letters E, I, N, and T appear in ETAOIN and the five letters Z, X, Q, J, and K
appear in VKJXQZ. This gives the ordering a frequency match score of 9.</p>

<p class=MsoNormal><img width=576 height=137 id="Picture 21"
src="chapter20_files/image005.jpg"></p>

<p class=FigureCaption>Figure 20-4. How the frequency match score of EISNTHAOCLRFDGWVMUYBPZXQJK
is calculated.</p>

<p class=MsoNormal>The above ciphertext was encrypted with a transposition
cipher, so it has all the same letters as the original English plaintext (their
order has just been switched around.) This is why the frequency ordering has a
much higher frequency match score.</p>

<h3>Hacking Each Subkey</h3>

<p class=MsoNormal>When hacking the Vigenère cipher, we try to decrypt the
letters for the first subkey with each of the 26 possible letters and find out
which decrypted ciphertext produces a letter frequency that closest matches
that of regular English. This is a good indication that we have found the
correct subkey.</p>

<p class=MsoNormal>We can do this same thing for the second, third, fourth, and
fifth subkey as well. Since we are only doing 26 decryptions for each subkey
individually, our computer only has to perform 26 + 26 + 26 + 26 + 26, or 156,
decryptions. This is much easier than trying to do 11,881,376 decryptions!</p>

<p class=MsoNormal>So, hacking the Vigenère cipher sounds simple in theory.
Just try all 26 possible subkeys for each subkey in the key, and see which one
produces decrypted text that has a letter frequency that closest matches the
letter frequency of English.</p>

<p class=MsoNormal>It turns out that there are a few more steps than this,
though, but we can cover them when we write the hacking program in the next
chapter. For this chapter, we will write a module with several helpful
functions that perform frequency analysis. This module will have these
functions:</p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=Literal>getLetterCount()</span> – This function will
take a string parameter and return a dictionary that has the count of how often
each letter appears in the string.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=Literal>getFrequencyOrder()</span> – This function
will take a string parameter and return a string of the 26 letters ordered from
those that appear most frequently to least frequently in the string parameter.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=Literal>englishFreqMatchScore()</span> – This
function will take a string parameter and return an integer from 0 to 12 of the
string’s letter frequency match score.</p>

<h2><a name="_Toc353630887">The Code for Matching Letter Frequencies</a></h2>

<p class=MsoNormal>Type in the following code into the file editor, and then
save it as <span class=Filename>freqAnalysis.py</span>. Press <strong>F5</strong>
to run the program.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for freqAnalysis.py </span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  1.</span> <span
class=SourceCodeComment># Frequency Finder</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  4.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  5.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  6.</span> <span
class=SourceCodeComment># frequency taken from
http://en.wikipedia.org/wiki/Letter_frequency</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  7.</span>
englishLetterFreq = {'E': 12.70, 'T': 9.06, 'A': 8.17, 'O': 7.51, 'I': 6.97,
'N': 6.75, 'S': 6.33, 'H': 6.09, 'R': 5.99, 'D': 4.25, 'L': 4.03, 'C': 2.78,
'U': 2.76, 'M': 2.41, 'W': 2.36, 'F': 2.23, 'G': 2.02, 'Y': 1.97, 'P': 1.93,
'B': 1.29, 'V': 0.98, 'K': 0.77, 'J': 0.15, 'X': 0.15, 'Q': 0.10, 'Z': 0.07}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  8.</span> ETAOIN
= 'ETAOINSHRDLCUMWFGYPBVKJXQZ'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  9.</span>
LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 10. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 11. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 12. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 13.</span>
def getLetterCount(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 14.</span>    
<span class=SourceCodeComment># Returns a dictionary with keys of single
letters and values of the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 15.</span>    
<span class=SourceCodeComment># count of how many times they appear in the
message parameter.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 16.</span>    
letterCount = {'A': 0, 'B': 0, 'C': 0, 'D': 0, 'E': 0, 'F': 0, 'G': 0, 'H': 0,
'I': 0, 'J': 0, 'K': 0, 'L': 0, 'M': 0, 'N': 0, 'O': 0, 'P': 0, 'Q': 0, 'R': 0,
'S': 0, 'T': 0, 'U': 0, 'V': 0, 'W': 0, 'X': 0, 'Y': 0, 'Z': 0}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 17. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 18.</span>    
for letter in message.upper():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 19.</span>        
if letter in LETTERS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 20.</span>            
letterCount[letter] += 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 21. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 22.</span>    
return letterCount</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 23. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 24. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 25. </span>def
getItemAtIndexZero(x):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 26. </span>    return
x[0]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 27. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 28. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 29.</span>
def getFrequencyOrder(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 30.</span>    
<span class=SourceCodeComment># Returns a string of the alphabet letters
arranged in order of most</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 31.</span>    
<span class=SourceCodeComment># frequently occurring in the message parameter.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 32. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 33.</span>    
<span class=SourceCodeComment># first, get a dictionary of each letter and its
frequency count</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 34.</span>    
letterToFreq = getLetterCount(message)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 35. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 36.</span>    
<span class=SourceCodeComment># second, make a dictionary of each frequency
count to each letter(s)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 37.</span>    
<span class=SourceCodeComment># with that frequency</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 38.</span>    
freqToLetter = {}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 39.</span>    
for letter in LETTERS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 40.</span>        
if letterToFreq[letter] not in freqToLetter:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 41.</span>             freqToLetter[letterToFreq[letter]]
= [letter]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 42.</span>    
    else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 43.</span>        
    freqToLetter[letterToFreq[letter]].append(letter)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 44. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 45.</span>    
<span class=SourceCodeComment># third, put each list of letters in reverse &quot;ETAOIN&quot;
order, and then</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 46.</span>    
<span class=SourceCodeComment># convert it to a string</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 47.</span>    
for freq in freqToLetter:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 48.</span>        
freqToLetter[freq].sort(key=ETAOIN.find, reverse=True)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 49.</span>        
freqToLetter[freq] = ''.join(freqToLetter[freq])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 50. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 51.</span>    
<span class=SourceCodeComment># fourth, convert the freqToLetter dictionary to
a list of tuple</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 52.</span>    
<span class=SourceCodeComment># pairs (key, value), then sort them</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 53.</span>    
freqPairs = list(freqToLetter.items())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 54.</span>    
freqPairs.sort(key=getItemAtIndexZero, reverse=True)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 55. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 56.</span>    
<span class=SourceCodeComment># fifth, now that the letters are ordered by
frequency, extract all</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 57.</span>    
<span class=SourceCodeComment># the letters for the final string</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 58.</span>    
freqOrder = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 59.</span>    
for freqPair in freqPairs:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 60.</span>        
freqOrder.append(freqPair[1])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 61. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 62.</span>    
return ''.join(freqOrder)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 63. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 64. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 65.</span>
def englishFreqMatchScore(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 66.</span>    
<span class=SourceCodeComment># Return the number of matches that the string in
the message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 67.</span>    
<span class=SourceCodeComment># parameter has when its letter frequency is
compared to English</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 68.</span>    
<span class=SourceCodeComment># letter frequency. A &quot;match&quot; is how
many of its six most frequent</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 69.</span>    
<span class=SourceCodeComment># and six least frequent letters is among the six
most frequent and</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 70.</span>    
<span class=SourceCodeComment># six least frequent letters for English.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 71.</span>    
freqOrder = getFrequencyOrder(message)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 72. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 73.</span>    
matchScore = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 74.</span>    
<span class=SourceCodeComment># Find how many matches for the six most common
letters there are.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 75.</span>    
for commonLetter in ETAOIN[:6]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 76.</span>        
if commonLetter in freqOrder[:6]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 77.</span>            
matchScore += 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 78.</span>    
<span class=SourceCodeComment># Find how many matches for the six least common
letters there are.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 79.</span>    
for uncommonLetter in ETAOIN[-6:]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 80.</span>        
if uncommonLetter in freqOrder[-6:]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 81.</span>            
matchScore += 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 82. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 83.</span>    
return matchScore</p>

</div>

<h2><a name="_Toc353630888">How the Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>  1.</span> <span
class=SourceCodeComment># Frequency Finder</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  4.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  5.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  6.</span> <span
class=SourceCodeComment># frequency taken from
http://en.wikipedia.org/wiki/Letter_frequency</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>  7.</span>
englishLetterFreq = {'E': 12.70, 'T': 9.06, 'A': 8.17, 'O': 7.51, 'I': 6.97,
'N': 6.75, 'S': 6.33, 'H': 6.09, 'R': 5.99, 'D': 4.25, 'L': 4.03, 'C': 2.78,
'U': 2.76, 'M': 2.41, 'W': 2.36, 'F': 2.23, 'G': 2.02, 'Y': 1.97, 'P': 1.93,
'B': 1.29, 'V': 0.98, 'K': 0.77, 'J': 0.15, 'X': 0.15, 'Q': 0.10, 'Z': 0.07}</p>

</div>

<p class=MsoNormal>The <span class=Literal>englishLetterFreq</span> dictionary
will contain strings of the letters of the alphabet as keys and a float for
their percentage frequency as the value. (These values come from the Wikipedia
article for letter frequency: <span class=URL><u>https://en.wikipedia.org/wiki/Letter_frequency</u></span>)
The <span class=Literal>englishLetterFreq</span> value isn’t actually used by
our program. It is simply here for your future reference in case you write a
program that needs it.</p>

<h2><a name="_Toc353630889">The Most Common Letters, “ETAOIN”</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>  8.</span> ETAOIN = 'ETAOINSHRDLCUMWFGYPBVKJXQZ'</p>

</div>

<p class=MsoNormal>We will create a variable named <span class=Literal>ETAOIN</span>
on line 8 which will have the 26 letters of the alphabet in order of most
frequent to least frequent. The word ETAOIN is a handy way to remember the six
most common letters in English. Of course, this ordering isn’t always going to
be perfect. You could easily find a book that has a set of letter frequencies
where Z is used more often than Q, for example. <em>Gadsby</em> by Ernest
Vicent Wright is a novel that never uses the letter E, which gives it a very
odd set of letter frequencies. But in most cases, the “ETAOIN order” will be
accurate.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>  9.</span> LETTERS =
'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</p>

</div>

<p class=MsoNormal>Our module will also need a string of all the uppercase
letters of the alphabet for a few different functions, so we set the <span
class=Literal>LETTERS</span> constant variable on line 9.</p>

<h2><a name="_Toc353630890">The Program’s </a><span class=Literal>getLettersCount()</span>
Function</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 13.</span>
def getLetterCount(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 14.</span>    
<span class=SourceCodeComment># Returns a dictionary with keys of single
letters and values of the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 15.</span>    
<span class=SourceCodeComment># count of how many times they appear in the
message parameter.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 16.</span>    
letterCount = {'A': 0, 'B': 0, 'C': 0, 'D': 0, 'E': 0, 'F': 0, 'G': 0, 'H': 0,
'I': 0, 'J': 0, 'K': 0, 'L': 0, 'M': 0, 'N': 0, 'O': 0, 'P': 0, 'Q': 0, 'R': 0,
'S': 0, 'T': 0, 'U': 0, 'V': 0, 'W': 0, 'X': 0, 'Y': 0, 'Z': 0}</p>

</div>

<p class=MsoNormal>The <span class=Literal>getLetterCount()</span> function
returns a dictionary value where the keys are single uppercase letter strings,
and the values are an integer showing how many times that letter occurs in the <span
class=Literal>message</span> parameter. For example, a certain string value for
the <span class=Literal>message</span> parameter with 135 A’s, 30 B’s, and so
on will cause <span class=Literal>getLetterCount()</span> to return <span
class=Literal>{'A':</span> <span class=Literal>135,</span> <span class=Literal>'B':</span>
<span class=Literal>30,</span> <span class=Literal>'C':</span> <span
class=Literal>74,</span> <span class=Literal>'D':</span> <span class=Literal>58,</span>
<span class=Literal>'E':</span> <span class=Literal>196,</span> <span
class=Literal>'F':</span> <span class=Literal>37,</span> <span class=Literal>'G':</span>
<span class=Literal>39,</span> <span class=Literal>'H':</span> <span
class=Literal>87,</span> <span class=Literal>'I':</span> <span class=Literal>139,</span>
<span class=Literal>'J':</span> <span class=Literal>2,</span> <span
class=Literal>'K':</span> <span class=Literal>8,</span> <span class=Literal>'L':</span>
<span class=Literal>62,</span> <span class=Literal>'M':</span> <span
class=Literal>58,</span> <span class=Literal>'N':</span> <span class=Literal>122,</span>
<span class=Literal>'O':</span> <span class=Literal>113,</span> <span
class=Literal>'P':</span> <span class=Literal>36,</span> <span class=Literal>'Q':</span>
<span class=Literal>2,</span> <span class=Literal>'R':</span> <span
class=Literal>106,</span> <span class=Literal>'S':</span> <span class=Literal>89,</span>
<span class=Literal>'T':</span> <span class=Literal>140,</span> <span
class=Literal>'U':</span> <span class=Literal>37,</span> <span class=Literal>'V':</span>
<span class=Literal>14,</span> <span class=Literal>'W':</span> <span
class=Literal>30,</span> <span class=Literal>'X':</span> <span class=Literal>3,</span>
<span class=Literal>'Y':</span> <span class=Literal>21,</span> <span
class=Literal>'Z':</span> <span class=Literal>1}</span></p>

<p class=MsoNormal>Line 16 starts the <span class=Literal>letterCount</span>
variable with a dictionary that has all keys with a value of <span
class=Literal>0</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 18.</span>    
for letter in message.upper():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 19.</span>        
if letter in LETTERS:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 20.</span>            
letterCount[letter] += 1</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 18 iterates through
each character in the uppercase version of <span class=Literal>message</span>. On
line 19, if the character exists in the <span class=Literal>LETTERS</span>
string, we know it is an uppercase letter. In that case line 20 will increment
the value at <span class=Literal>letterCount[letter]</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 22.</span>     return
letterCount</p>

</div>

<p class=MsoNormal>After the <span class=Literal>for</span> loop on line 18
finishes, the <span class=Literal>letterCount</span> dictionary will have a
count of how often each letter appeared in <span class=Literal>message</span>.
This dictionary is returned from <span class=Literal>getLetterCount()</span>.</p>

<h2><a name="_Toc353630891">The Program’s </a><span class=Literal>getItemAtIndexZero()</span>
Function</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 25. </span>def
getItemAtIndexZero(x):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 26. </span>    return
x[0]</p>

</div>

<p class=MsoNormal>The <span class=Literal>getItemAtIndexZero()</span> function
is very simple: it is passed a tuple and returns the items at index <span
class=Literal>1</span>. This function will be passed as the <span
class=Literal>key</span> keyword argument for the <span class=Literal>sort()</span>
method. (The reason for this will be explained later.)</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc353630892">The Program’s </a><span class=Literal>getFrequencyOrder()</span>
Function</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 29.</span>
def getFrequencyOrder(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 30.</span>    
<span class=SourceCodeComment># Returns a string of the alphabet letters
arranged in order of most</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 31.</span>    
<span class=SourceCodeComment># frequently occurring in the message parameter.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 32. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 33.</span>    
<span class=SourceCodeComment># first, get a dictionary of each letter and its
frequency count</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 34.</span>    
letterToFreq = getLetterCount(message)</p>

</div>

<p class=MsoNormal>The <span class=Literal>getFrequencyOrder()</span> function
will return a string with the 26 uppercase letters of the alphabet arranged in
order of how frequently they appear in the <span class=Literal>message</span>
parameter. If <span class=Literal>message</span> is readable English instead of
random gibberish, this string will most likely be similar (if not identical to)
the string in the <span class=Literal>ETAOIN</span> constant.</p>

<p class=MsoNormal>For example, if the “Alan Mathison Turing was a British
mathematician…” text from Chapter 19’s <span class=Filename>vigenereCipher.py</span>
program was passed as a string to <span class=Literal>getFrequencyOrder()</span>,
the function would return the string <span class=Literal>'ETIANORSHCLMDGFUPBWYVKXQJZ'</span>
because E is the most common letter in that paragraph, followed by T, then I,
then A, and so on.</p>

<p class=MsoNormal>This function is somewhat complicated, but it breaks down to
five simple steps.</p>

<p class=MsoNormal>The first step of <span class=Literal>getFrequencyOrder()</span>,
line 34 gets a dictionary value of the letter frequency count from <span
class=Literal>getLetterCount()</span> for the string in the <span
class=Literal>message</span> parameter. (The <span class=Literal>getLetterCount()</span>
function was described previously.)</p>

<p class=MsoNormal>If the “Alan Mathison Turing…” text was passed as a string
value for the <span class=Literal>message</span> parameter, then line 34 would
assign <span class=Literal>letterToFreq</span> the dictionary value, <span
class=Literal>{'A':</span> <span class=Literal>135,</span> <span class=Literal>'C':</span>
<span class=Literal>74,</span> <span class=Literal>'B':</span> <span
class=Literal>30,</span> <span class=Literal>'E':</span> <span class=Literal>196,</span>
<span class=Literal>'D':</span> <span class=Literal>58,</span> <span
class=Literal>'G':</span> <span class=Literal>39,</span> <span class=Literal>'F':</span>
<span class=Literal>37,</span> <span class=Literal>'I':</span> <span
class=Literal>139,</span> <span class=Literal>'H':</span> <span class=Literal>87,</span>
<span class=Literal>'K':</span> <span class=Literal>8,</span> <span
class=Literal>'J':</span> <span class=Literal>2,</span> <span class=Literal>'M':</span>
<span class=Literal>58,</span> <span class=Literal>'L':</span> <span
class=Literal>62,</span> <span class=Literal>'O':</span> <span class=Literal>113,</span>
<span class=Literal>'N':</span> <span class=Literal>122,</span> <span
class=Literal>'Q':</span> <span class=Literal>2,</span> <span class=Literal>'P':</span>
<span class=Literal>36,</span> <span class=Literal>'S':</span> <span
class=Literal>89,</span> <span class=Literal>'R':</span> <span class=Literal>106,</span>
<span class=Literal>'U':</span> <span class=Literal>37,</span> <span
class=Literal>'T':</span> <span class=Literal>140,</span> <span class=Literal>'W':</span>
<span class=Literal>30,</span> <span class=Literal>'V':</span> <span
class=Literal>14,</span> <span class=Literal>'Y':</span> <span class=Literal>21,</span>
<span class=Literal>'X':</span> <span class=Literal>3,</span> <span
class=Literal>'Z':</span> <span class=Literal>1}</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 36.</span>    
<span class=SourceCodeComment># second, make a dictionary of each frequency
count to each letter(s)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 37.</span>    
<span class=SourceCodeComment># with that frequency</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 38.</span>    
freqToLetter = {}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 39.</span>    
for letter in LETTERS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 40.</span>        
if letterToFreq[letter] not in freqToLetter:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 41.</span>             freqToLetter[letterToFreq[letter]]
= [letter]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 42.</span>    
    else:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 43.</span>        
    freqToLetter[letterToFreq[letter]].append(letter)</p>

</div>

<p class=MsoNormal>For the second step of <span class=Literal>getFrequencyOrder()</span>,
while the <span class=Literal>letterToFreq</span> dictionary has keys of each
of the 26 letters and values of their frequency count, what we need is a
dictionary value that maps the opposite: a dictionary where the keys are the
frequency count and values are a list of letters that appear that many times.
While the <span class=Literal>letterToFreq</span> dictionary maps letter keys
to frequency values, the <span class=Literal>freqToLetter</span> dictionary
will map frequency keys to list of letter values.</p>

<p class=MsoNormal>Line 38 creates a blank dictionary. Line 39 loops over all
the letters in <span class=Literal>LETTERS</span>. The <span class=Literal>if</span>
statement on line 40 checks if the letter’s frequency (that is, <span
class=Literal>letterToFreq[letter]</span>) already exists as a key in <span
class=Literal>freqToLetter</span>. If not, then line 41 adds this key with a
list of the letter as the value. Or else, line 43 appends the letter to the end
of the list that is already at <span class=Literal>letterToFreq[letter]</span>.</p>

<p class=MsoNormal>If we continue to use our “Alan Mathison Turing…” example
value of <span class=Literal>letterToFreq</span> then <span class=Literal>freqToLetter</span>
would end up looking like this: <span class=Literal>{1:</span> <span
class=Literal>['Z'],</span> <span class=Literal>2:</span> <span class=Literal>['J',</span>
<span class=Literal>'Q'],</span> <span class=Literal>3:</span> <span
class=Literal>['X'],</span> <span class=Literal>135:</span> <span
class=Literal>['A'],</span> <span class=Literal>8:</span> <span class=Literal>['K'],</span>
<span class=Literal>139:</span> <span class=Literal>['I'],</span> <span
class=Literal>140:</span> <span class=Literal>['T'],</span> <span
class=Literal>14:</span> <span class=Literal>['V'],</span> <span class=Literal>21:</span>
<span class=Literal>['Y'],</span> <span class=Literal>30:</span> <span
class=Literal>['B',</span> <span class=Literal>'W'],</span> <span
class=Literal>36:</span> <span class=Literal>['P'],</span> <span class=Literal>37:</span>
<span class=Literal>['F',</span> <span class=Literal>'U'],</span> <span
class=Literal>39:</span> <span class=Literal>['G'],</span> <span class=Literal>58:</span>
<span class=Literal>['D',</span> <span class=Literal>'M'],</span> <span
class=Literal>62:</span> <span class=Literal>['L'],</span> <span class=Literal>196:</span>
<span class=Literal>['E'],</span> <span class=Literal>74:</span> <span
class=Literal>['C'],</span> <span class=Literal>87:</span> <span class=Literal>['H'],</span>
<span class=Literal>89:</span> <span class=Literal>['S'],</span> <span
class=Literal>106:</span> <span class=Literal>['R'],</span> <span
class=Literal>113:</span> <span class=Literal>['O'],</span> <span
class=Literal>122:</span> <span class=Literal>['N']}</span></p>

<h2><a name="_Toc353630893">The </a><span class=Literal>sort()</span> Method’s <span
class=Literal>key</span> and <span class=Literal>reverse</span> Keyword
Arguments</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 45.</span>    
<span class=SourceCodeComment># third, put each list of letters in reverse &quot;ETAOIN&quot;
order, and then</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 46.</span>    
<span class=SourceCodeComment># convert it to a string</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 47.</span>    
for freq in freqToLetter:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 48.</span>        
freqToLetter[freq].sort(key=ETAOIN.find, reverse=True)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 49.</span>        
freqToLetter[freq] = ''.join(freqToLetter[freq])</p>

</div>

<p class=MsoNormal>The third step of <span class=Literal>getFrequencyOrder()</span>
to is sort the letter strings in each list in <span class=Literal>freqToLetter</span>
in reverse ETAOIN order (as opposed to alphabetical order).</p>

<p class=MsoNormal>Remember that <span class=Literal>freqToLetter[freq]</span>
will evaluate to a <em>list</em> of letters that have a frequency count of <span
class=Literal>freq</span>. A list is used because it’s possible that two or
more letters have the exact same frequency count, in which case this list will
have two-or-more-letters strings in it.</p>

<p class=MsoNormal>When multiple letters are tied for frequency, we want these
tied letters to be sorted in the reverse order that they appear in the <span
class=Literal>ETAOIN</span> string. We need this so that we have a consistent
way of breaking ties. Otherwise messages with the same letter frequencies might
produce different return values from <span class=Literal>getFrequencyOrder()</span>!</p>

<p class=MsoNormal>For example, if E appears 15 times, D and W appear 8 times
each, and H appears 4 times, we would want them to be sorted as <span
class=Literal>'EWDH'</span> and not <span class=Literal>'EDWH'</span>. This is
because while E is the most frequent, D and W have the same frequency count but
W comes after D in the <span class=Literal>ETAOIN</span> string.</p>

<p class=MsoNormal>Python’s <span class=Literal>sort()</span> function can do
this sorting for us if we pass it a function or method for its <span
class=Literal>key</span> keyword argument. Normally the <span class=Literal>sort()</span>
function simply sorts the list it is called on into alphabetical (or numeric) order.
However, we can change this by passing the <span class=Literal>find()</span>
method of the <span class=Literal>ETAOIN</span> string as the <span
class=Literal>key</span> keyword argument. This will sort the items in the <span
class=Literal>freqToLetter[freq]</span> list by the integer returned from the <span
class=Literal>ETAOIN.find()</span> method, that is, the order that they appear
in the <span class=Literal>ETAOIN</span> string.</p>

<p class=MsoNormal>Normally the <span class=Literal>sort()</span> method sorts
the values in a list in <strong>ascending order</strong> (that is, lowest to
highest or the letter A first and letter Z last). If we pass <span
class=Literal>True</span> for the <span class=Literal>sort()</span> method’s <span
class=Literal>reverse</span> keyword argument, it will sort the items in <strong>descending
order</strong> instead. The reason we want to sort the letters in reverse
ETAOIN order is so that ties result in lower match scores in the <span
class=Literal>englishFreqMatchScore()</span> function rather than higher match
scores. (This function is explained later.)</p>

<p class=MsoNormal>If we continue using our “Alan Mathison Turing…” example value
for <span class=Literal>freqToLetter</span>, then after the loop finishes the
value stored in <span class=Literal>freqToLetter</span> would be: <span
class=Literal>{1:</span> <span class=Literal>'Z',</span> <span class=Literal>2:</span>
<span class=Literal>'QJ',</span> <span class=Literal>3:</span> <span
class=Literal>'X',</span> <span class=Literal>135:</span> <span class=Literal>'A',</span>
<span class=Literal>8:</span> <span class=Literal>'K',</span> <span
class=Literal>139:</span> <span class=Literal>'I',</span> <span class=Literal>140:</span>
<span class=Literal>'T',</span> <span class=Literal>14:</span> <span
class=Literal>'V',</span> <span class=Literal>21:</span> <span class=Literal>'Y',</span>
<span class=Literal>30:</span> <span class=Literal>'BW',</span> <span
class=Literal>36:</span> <span class=Literal>'P',</span> <span class=Literal>37:</span>
<span class=Literal>'FU',</span> <span class=Literal>39:</span> <span
class=Literal>'G',</span> <span class=Literal>58:</span> <span class=Literal>'MD',</span>
<span class=Literal>62:</span> <span class=Literal>'L',</span> <span
class=Literal>196:</span> <span class=Literal>'E',</span> <span class=Literal>74:</span>
<span class=Literal>'C',</span> <span class=Literal>87:</span> <span
class=Literal>'H',</span> <span class=Literal>89:</span> <span class=Literal>'S',</span>
<span class=Literal>106:</span> <span class=Literal>'R',</span> <span
class=Literal>113:</span> <span class=Literal>'O',</span> <span class=Literal>122:</span>
<span class=Literal>'N'}</span></p>

<p class=MsoNormal>Notice that the strings for the <span class=Literal>30</span>,
<span class=Literal>37</span>, and <span class=Literal>58</span> keys are all
sorted in reverse ETAOIN order.</p>

<h2><a name="_Toc353630894">Passing Functions as Values</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 48.</span>        
freqToLetter[freq].sort(key=ETAOIN.find, reverse=True)</p>

</div>

<p class=MsoNormal>If you look on line 47, you’ll notice that we are not
calling the <span class=Literal>find()</span> method but instead using the find
method itself as a value that is passed to the <span class=Literal>sort()</span>
method call. In Python, functions themselves are values just like any other
values. For example, try typing this into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
def foo():</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
print('Hello!')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
bar = foo</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
bar()</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>Hello!</p>

</div>

<p class=MsoNormal>In the above code, we define a function named <span
class=Literal>foo()</span> that prints out the string <span class=Literal>'Hello!'</span>.
But this is basically defining a function and then storing it in a variable
named <span class=Literal>foo</span>. Then we copy the function in <span
class=Literal>foo</span> to the variable <span class=Literal>bar</span>. This
means we can call <span class=Literal>bar()</span> just like we can call <span
class=Literal>foo()</span>! Note that in this assignment statement we do <strong>not</strong>
have parentheses after <span class=Literal>foo</span>. If we did, we would be <em>calling</em>
the function <span class=Literal>foo()</span> and setting <span class=Literal>bar</span>
to its return value. Just like <span class=Literal>spam[42]</span> has the <span
class=Literal>[42]</span> index operating on <span class=Literal>spam</span>,
the parentheses means, “Call the value in <span class=Literal>foo</span> as a
function.”</p>

<p class=MsoNormal>You can also pass functions as values just like any other
value. Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
def doMath(func):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
return func(10, 5)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
def adding(a, b):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
return a + b</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
def subtracting(a, b):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
return a - b</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
doMath(adding)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>15</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
doMath(subtracting)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>5</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>When the function in <span class=Literal>adding</span> is
passed to the <span class=Literal>doMath()</span> call, the <span
class=Literal>func(10, 5)</span> line is calling <span class=Literal>adding()</span>
and passing <span class=Literal>10</span> and <span class=Literal>5</span> to
it. So the call <span class=Literal>func(10, 5)</span> is effectively the same as
the call <span class=Literal>adding(10, 5)</span>. This is why <span
class=Literal>doMath(adding)</span> returns <span class=Literal>15</span>.</p>

<p class=MsoNormal>When <span class=Literal>subtracting</span> is passed to the
<span class=Literal>doMath()</span> call, <span class=Literal>func(10, 5)</span>
is the same as <span class=Literal>subtracting(10, 5)</span>. This is why <span
class=Literal>doMath(subtracting)</span> returns <span class=Literal>5</span>.</p>

<p class=MsoNormal>Passing a function or method to a function or method call is
how the <span class=Literal>sort()</span> method lets you implement different
sorting behavior. The function or method that is passed to <span class=Literal>sort()</span>
should accept a single parameter and returns a value that is used to
alphabetically sort the item.</p>

<p class=MsoNormal>To put it another way: normally <span class=Literal>sort()</span>
sorts the values in a list by the alphabetical order of the list values.. But
if we pass a function (or method) for the <span class=Literal>key</span>
keyword argument, then the values in the list are sorted <em>by the alphabetical
or numeric order of the return value of the function</em> when the value in the
list is passed to that function.</p>

<p class=MsoNormal>You can think of a normal <span class=Literal>sort()</span>
call such as this:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerpt style='border:none;padding:0in'>someListVariable.sort()</p>

</div>

<p class=MsoNormal>…as being equivalent to this:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>def
func(x):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    return
x   <span class=SourceCodeComment># sorting based on the value itself</span></p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>someListVariable.sort(key=func)</p>

</div>

<p class=MsoNormal>So when the <span class=Literal>sort()</span> method call is
passed <span class=Literal>ETAOIN.find</span>, instead of sorting the strings
like <span class=Literal>'A'</span>, <span class=Literal>'B'</span>, and <span
class=Literal>'C'</span> by the alphabetical order the <span class=Literal>sort()</span>
method sorts them by the numeric order of the integers returned from <span
class=Literal>ETAOIN.find('A')</span>, <span class=Literal>ETAOIN.find('B')</span>,
and <span class=Literal>ETAOIN.find('C')</span>: that is, <span class=Literal>2</span>,
<span class=Literal>19</span>, and <span class=Literal>11</span> respectively.
So the <span class=Literal>'A'</span>, <span class=Literal>'B'</span>, and <span
class=Literal>'C'</span> strings get sorted as <span class=Literal>'A'</span>, <span
class=Literal>'C'</span>, and then <span class=Literal>'B'</span> (the order
they appear in <span class=Literal>ETAOIN</span>).</p>

<h2><a name="_Toc353630895">Converting Dictionaries to Lists with the keys(),
values(), items() Dictionary Methods</a></h2>

<p class=MsoNormal>If you want to get a list value of all the keys in a
dictionary, the <span class=Literal>keys()</span> method will return a
dict_keys object that can be passed to <span class=Literal>list()</span> to get
a list of all the keys. There is a similar dictionary method named <span
class=Literal>values()</span> that returns a dict_values object. Try typing the
following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = {'cats': 10, 'dogs': 3, 'mice': 3}</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam.keys()</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>dict_keys(['mice',
'cats', 'dogs'])</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
list(spam.keys())</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>['mice',
'cats', 'dogs']</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
list(spam.values())</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>[3, 10, 3]</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>Remember, dictionaries do not have any ordering associated
with the key-value pairs they contain. When getting a list of the keys or values,
they will be in a random order in the list. If you want to get the keys and
values together, the <span class=Literal>items()</span> dictionary method returns
a dict_items object that can be passed to <span class=Literal>list()</span>.
The <span class=Literal>list()</span> function will then return a list of
tuples where the tuples contain a key and value pair of values. Try typing the
following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = {'cats': 10, 'dogs': 3, 'mice': 3}</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
list(spam.items())</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>[('mice',
3), ('cats', 10), ('dogs', 3)]</p>

</div>

<p class=MsoNormal>We will be using the <span class=Literal>items()</span>
method in our <span class=Literal>getFrequencyOrder()</span> function, but you
should know about the <span class=Literal>keys()</span> and <span
class=Literal>values()</span> methods too. Remember, in order to use the return
values from these methods as lists, they must be passed to the <span
class=Literal>list()</span> function. The <span class=Literal>list()</span>
function then returns a list version of the dict_keys, dict_values, or
dict_items object.</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Times New Roman","serif"'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc353630896">Sorting the Items from a Dictionary</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 51.</span>    
<span class=SourceCodeComment># fourth, convert the freqToLetter dictionary to
a list of tuple</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 52.</span>    
<span class=SourceCodeComment># pairs (key, value), then sort them</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 53.</span>    
freqPairs = list(freqToLetter.items())</p>

</div>

<p class=MsoNormal>The fourth step of <span class=Literal>getFrequencyOrder()</span>
is to sort the strings from the <span class=Literal>freqToLetter</span>
dictionary by the frequency count. Remember that the <span class=Literal>freqToLetter</span>
dictionary has integer frequency counts for the keys and lists of single-letter
strings for the values. But since dictionaries do not have an ordering for the
key-value pairs in them, we will call the <span class=Literal>items()</span>
method and <span class=Literal>list()</span> function to create a list of
tuples of the dictionary’s key-value pairs. This list of tuples (stored in a
variable named <span class=Literal>freqPairs</span> on line 53) is what we will
sort.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 54.</span>    
freqPairs.sort(key=getItemAtIndexZero, reverse=True)</p>

</div>

<p class=MsoNormal>The <span class=Literal>sort()</span> method call is passed
the <span class=Literal>getItemAtIndexZero</span> function value itself. This
means the items in the <span class=Literal>freqPairs</span> will be sorted by
the numeric order of the value at index <span class=Literal>0</span> of the tuple
value, which is the frequency count integer. Line 54 also passes <span
class=Literal>True</span> for the <span class=Literal>reverse</span> keyword
argument so that the tuples are reverse ordered from largest frequency count to
smallest.</p>

<p class=MsoNormal>If we continue using the previous “Alan Mathison Turing…” example,
the value of <span class=Literal>freqPairs</span> will be <span class=Literal>[(196,</span>
<span class=Literal>'E'),</span> <span class=Literal>(140,</span> <span
class=Literal>'T'),</span> <span class=Literal>(139,</span> <span
class=Literal>'I'),</span> <span class=Literal>(135,</span> <span
class=Literal>'A'),</span> <span class=Literal>(122,</span> <span
class=Literal>'N'),</span> <span class=Literal>(113,</span> <span
class=Literal>'O'),</span> <span class=Literal>(106,</span> <span
class=Literal>'R'),</span> <span class=Literal>(89,</span> <span class=Literal>'S'),</span>
<span class=Literal>(87,</span> <span class=Literal>'H'),</span> <span
class=Literal>(74,</span> <span class=Literal>'C'),</span> <span class=Literal>(62,</span>
<span class=Literal>'L'),</span> <span class=Literal>(58,</span> <span
class=Literal>'MD'),</span> <span class=Literal>(39,</span> <span
class=Literal>'G'),</span> <span class=Literal>(37,</span> <span class=Literal>'FU'),</span>
<span class=Literal>(36,</span> <span class=Literal>'P'),</span> <span
class=Literal>(30,</span> <span class=Literal>'BW'),</span> <span
class=Literal>(21,</span> <span class=Literal>'Y'),</span> <span class=Literal>(14,</span>
<span class=Literal>'V'),</span> <span class=Literal>(8,</span> <span
class=Literal>'K'),</span> <span class=Literal>(3,</span> <span class=Literal>'X'),</span>
<span class=Literal>(2,</span> <span class=Literal>'QJ'),</span> <span
class=Literal>(1,</span> <span class=Literal>'Z')]</span></p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 56.</span>    
<span class=SourceCodeComment># fifth, now that the letters are ordered by
frequency, extract all</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 57.</span>    
<span class=SourceCodeComment># the letters for the final string</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 58.</span>    
freqOrder = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 59.</span>    
for freqPair in freqPairs:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 60.</span>        
freqOrder.append(freqPair[1])</p>

</div>

<p class=MsoNormal>The fifth step is to create a list of all the strings from
the sorted list in <span class=Literal>freqPairs</span>. The variable <span
class=Literal>freqOrder</span> will start as a blank list on line 58, and the
string at index <span class=Literal>1</span> of the tuple in <span
class=Literal>freqPairs</span> will be appended to the end of <span
class=Literal>freqOrder</span>.</p>

<p class=MsoNormal>If we continue with the “Alan Mathison Turing was a British
mathematician...” example from before, after this loop has finished, <span
class=Literal>freqOrder</span> will contain the value <span class=Literal>['E',</span>
<span class=Literal>'T',</span> <span class=Literal>'I',</span> <span
class=Literal>'A',</span> <span class=Literal>'N',</span> <span class=Literal>'O',</span>
<span class=Literal>'R',</span> <span class=Literal>'S',</span> <span
class=Literal>'H',</span> <span class=Literal>'C',</span> <span class=Literal>'L',</span>
<span class=Literal>'MD',</span> <span class=Literal>'G',</span> <span
class=Literal>'FU',</span> <span class=Literal>'P',</span> <span class=Literal>'BW',</span>
<span class=Literal>'Y',</span> <span class=Literal>'V',</span> <span
class=Literal>'K',</span> <span class=Literal>'X',</span> <span class=Literal>'QJ',</span>
<span class=Literal>'Z']</span></p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 62.</span>     return
''.join(freqOrder)</p>

</div>

<p class=MsoNormal>Line 62 creates a string from the list of strings in <span
class=Literal>freqOrder</span> by joining them together with the <span
class=Literal>join()</span> method. If we continue using the previous example, <span
class=Literal>getFrequencyOrder()</span> will return the string <span
class=Literal>'ETIANORSHCLMDGFUPBWYVKXQJZ'</span>. According to this ordering,
E is the most frequent letter in the “Alan Mathison Turing…” example string, T
is the second most frequent letter, I is the third most frequent, and so on.</p>

<h2><a name="_Toc353630897">The Program’s </a><span class=Literal>englishFreqMatchScore()</span>
Function</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 65.</span>
def englishFreqMatchScore(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 66.</span>    
<span class=SourceCodeComment># Return the number of matches that the string in
the message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 67.</span>    
<span class=SourceCodeComment># parameter has when its letter frequency is
compared to English</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 68.</span>    
<span class=SourceCodeComment># letter frequency. A &quot;match&quot; is how
many of its six most frequent</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 69.</span>    
<span class=SourceCodeComment># and six least frequent letters is among the six
most frequent and</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 70.</span>    
<span class=SourceCodeComment># six least frequent letters for English.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 71.</span>    
freqOrder = getFrequencyOrder(message)</p>

</div>

<p class=MsoNormal>The <span class=Literal>englishFreqMatchScore()</span>
function takes a string for <span class=Literal>message</span>, and then returns
an integer between <span class=Literal>0</span> and <span class=Literal>12</span>
to show <span class=Literal>message</span>’s frequency match score with
readable English’s letter frequency. The higher the integer, the more that the
frequency of the letters in <span class=Literal>message</span> matches the
frequency of normal English text.</p>

<p class=MsoNormal>The first step in calculating the match score is to get the
letter frequency ordering of <span class=Literal>message</span> by calling the <span
class=Literal>getFrequencyOrder()</span> function.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 73.</span>    
matchScore = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 74.</span>    
<span class=SourceCodeComment># Find how many matches for the six most common
letters there are.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 75.</span>    
for commonLetter in ETAOIN[:6]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 76.</span>        
if commonLetter in freqOrder[:6]:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 77.</span>            
matchScore += 1</p>

</div>

<p class=MsoNormal>The <span class=Literal>matchScore</span> variable starts
off at <span class=Literal>0</span> on line 73. The <span class=Literal>for</span>
loop on line 75 goes through each of the first 6 letters of the <span
class=Literal>ETAOIN</span> string. Remember that the <span class=Literal>[:6]</span>
slice is the same thing as <span class=Literal>[0:6]</span>. If one of these E,
T, A, O, I, or N letters is in the first six letters in the <span
class=Literal>freqOrder</span> string, then line 76’s condition is <span
class=Literal>True</span> and line 77 will increment <span class=Literal>matchScore</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 78.</span>    
<span class=SourceCodeComment># Find how many matches for the six least common
letters there are.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 79.</span>    
for uncommonLetter in ETAOIN[-6:]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 80.</span>        
if uncommonLetter in freqOrder[-6:]:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 81.</span>            
matchScore += 1</p>

</div>

<p class=MsoNormal>Lines 79 to 81 are much like lines 75 to 77, except the <em>last</em>
six letters in <span class=Literal>ETAOIN</span> (V, K, J, X, Q, and Z) are
checked to see if they are in the <em>last</em> six letters in the <span
class=Literal>freqOrder</span> string. If they are, then <span class=Literal>matchScore</span>
is incremented.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>freqAnalysis.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 83.</span>     return
matchScore</p>

</div>

<p class=MsoNormal>The integer in <span class=Literal>matchScore</span> is
returned on line 83.</p>

<p class=MsoNormal>The 14 letters in the middle of the frequency ordering are
ignored with our frequency match score calculation. This approach to comparing
letter frequencies is pretty simple, but it works well enough for our hacking
program in the next chapter.</p>

<h2><a name="_Toc353630898">Summary</a></h2>

<p class=MsoNormal>The <span class=Literal>sort()</span> function is useful for
sorting the values in a list. Normally <span class=Literal>sort()</span> will
sort them in alphabetical or numerical order. But the <span class=Literal>reverse</span>
and <span class=Literal>key</span> keyword arguments can be used to sort them
in different orders. This chapter also explains how functions themselves can be
passed as values in function calls.</p>

<p class=MsoNormal>Let’s use the frequency analysis module to hack the Vigenère
cipher, a cipher that perplexed cryptanalysts for hundreds of years!</p>

</div>

</body>

</html>
