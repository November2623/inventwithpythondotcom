<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Another Typewriter";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:33.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:44.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:66.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:77.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:88.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.Definition
	{mso-style-name:Definition;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Times New Roman","serif";}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Times New Roman","serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
p.TableListing, li.TableListing, div.TableListing
	{mso-style-name:"Table Listing";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TableHeader, li.TableHeader, div.TableHeader
	{mso-style-name:"Table Header";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpFirst, li.ChapterTitleCxSpFirst, div.ChapterTitleCxSpFirst
	{mso-style-name:"Chapter TitleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpMiddle, li.ChapterTitleCxSpMiddle, div.ChapterTitleCxSpMiddle
	{mso-style-name:"Chapter TitleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpLast, li.ChapterTitleCxSpLast, div.ChapterTitleCxSpLast
	{mso-style-name:"Chapter TitleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.URL
	{mso-style-name:URL;
	color:windowtext;
	text-decoration:underline;}
p.SourceCodeExcerpt, li.SourceCodeExcerpt, div.SourceCodeExcerpt
	{mso-style-name:"Source Code Excerpt";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpFirst, li.SourceCodeExcerptCxSpFirst, div.SourceCodeExcerptCxSpFirst
	{mso-style-name:"Source Code ExcerptCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpMiddle, li.SourceCodeExcerptCxSpMiddle, div.SourceCodeExcerptCxSpMiddle
	{mso-style-name:"Source Code ExcerptCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpLast, li.SourceCodeExcerptCxSpLast, div.SourceCodeExcerptCxSpLast
	{mso-style-name:"Source Code ExcerptCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.SourceCode
	{mso-style-name:"Source Code";
	font-family:"Lucida Console";}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
span.SampleRunResponse
	{mso-style-name:"Sample Run Response";
	color:black;}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.MessageText, li.MessageText, div.MessageText
	{mso-style-name:"Message Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Lucida Sans Typewriter";}
p.TopicsCoveredbox, li.TopicsCoveredbox, div.TopicsCoveredbox
	{mso-style-name:"Topics Covered box";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpFirst, li.TopicsCoveredboxCxSpFirst, div.TopicsCoveredboxCxSpFirst
	{mso-style-name:"Topics Covered boxCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpMiddle, li.TopicsCoveredboxCxSpMiddle, div.TopicsCoveredboxCxSpMiddle
	{mso-style-name:"Topics Covered boxCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpLast, li.TopicsCoveredboxCxSpLast, div.TopicsCoveredboxCxSpLast
	{mso-style-name:"Topics Covered boxCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
p.FigureCaption, li.FigureCaption, div.FigureCaption
	{mso-style-name:"Figure Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpFirst, li.FigureCaptionCxSpFirst, div.FigureCaptionCxSpFirst
	{mso-style-name:"Figure CaptionCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpMiddle, li.FigureCaptionCxSpMiddle, div.FigureCaptionCxSpMiddle
	{mso-style-name:"Figure CaptionCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpLast, li.FigureCaptionCxSpLast, div.FigureCaptionCxSpLast
	{mso-style-name:"Figure CaptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.SourceCodeFilename
	{mso-style-name:"Source Code Filename";
	font-family:"Lucida Sans Typewriter";}
p.TableCaption, li.TableCaption, div.TableCaption
	{mso-style-name:"Table Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	text-align:center;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.Filename
	{mso-style-name:Filename;
	font-style:italic;}
p.CipherInfoBox, li.CipherInfoBox, div.CipherInfoBox
	{mso-style-name:"Cipher Info Box";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	background:#FFFF99;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Another Typewriter";
	letter-spacing:1.4pt;}
p.ChapterQuotes, li.ChapterQuotes, div.ChapterQuotes
	{mso-style-name:"Chapter Quotes";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpFirst, li.ChapterQuotesCxSpFirst, div.ChapterQuotesCxSpFirst
	{mso-style-name:"Chapter QuotesCxSpFirst";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpMiddle, li.ChapterQuotesCxSpMiddle, div.ChapterQuotesCxSpMiddle
	{mso-style-name:"Chapter QuotesCxSpMiddle";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpLast, li.ChapterQuotesCxSpLast, div.ChapterQuotesCxSpLast
	{mso-style-name:"Chapter QuotesCxSpLast";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.CodeExample, li.CodeExample, div.CodeExample
	{mso-style-name:"Code Example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpFirst, li.CodeExampleCxSpFirst, div.CodeExampleCxSpFirst
	{mso-style-name:"Code ExampleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpMiddle, li.CodeExampleCxSpMiddle, div.CodeExampleCxSpMiddle
	{mso-style-name:"Code ExampleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpLast, li.CodeExampleCxSpLast, div.CodeExampleCxSpLast
	{mso-style-name:"Code ExampleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SmallerText, li.SmallerText, div.SmallerText
	{mso-style-name:"Smaller Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code \(Headline\)";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code \(Headline\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code \(Headline\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code \(Headline\)CxSpLast";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1, li.Style1, div.Style1
	{mso-style-name:Style1;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpFirst, li.Style1CxSpFirst, div.Style1CxSpFirst
	{mso-style-name:Style1CxSpFirst;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpMiddle, li.Style1CxSpMiddle, div.Style1CxSpMiddle
	{mso-style-name:Style1CxSpMiddle;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpLast, li.Style1CxSpLast, div.Style1CxSpLast
	{mso-style-name:Style1CxSpLast;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>
<div style='float: right; height: 310px; font-family: sans-serif;'>Ad: Programming books by Al Sweigart<br />
    <a href='http://www.nostarch.com/automatestuff' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src='/images/cover_automate_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/gp/product/0982106017?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src='/images/cover_inventwithpython_thumb.jpg' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src='/images/cover_makinggames_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='https://www.amazon.com/gp/product/1593278225/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593278225&linkCode=as2&tag=playwithpyth-20&linkId=bf3b22819f0886d277e88b8a653b81ad' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src='/images/cover_crackingcodes_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
</div>

<div class=WordSection1><p><strong>Note: The second edition of this book is available under the title <em><a href="https://inventwithpython.com/cracking">Cracking Codes with Python</a></em></strong></p>

<p class=MsoNormal align=center style='text-align:center'><img width=327
height=180 id="Picture 57" src="chapter19_files/image001.jpg"> </p>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc353630879"><span style='font-variant:normal !important;
text-transform:uppercase'>The Vigenère Cipher</span></a></h1>

</div>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#DBE5F1'>

<p class=TopicsCoveredboxCxSpFirst style='background:#DBE5F1;border:none;
padding:0in'>Topics Covered In This Chapter:</p>

<p class=TopicsCoveredboxCxSpLast style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Subkeys</p>

</div>

<p class=ChapterQuotesCxSpFirst>“I believed then, and continue to believe now,
that the benefits to our security and freedom of widely available cryptography
far, far outweigh the inevitable damage that comes from its use by criminals
and terrorists... I believed, and continue to believe, that the arguments
against widely available cryptography, while certainly advanced by people of
good will, did not hold up against the cold light of reason and were
inconsistent with the most basic American values.”</p>

<p class=ChapterQuotesCxSpMiddle>&nbsp;</p>

<p class=ChapterQuotesCxSpLast align=right style='text-align:right'><span
style='font-size:11.0pt;line-height:115%'>Matt Blaze, AT&amp;T Labs, September
2001</span></p>

<h2><a name="_Toc353630880">Le Chiffre Indéchiffrable</a></h2>

<p class=MsoNormal>The Vigenère cipher is a stronger cipher than the ones we’ve
seen before. There are too many possible keys to brute-force, even with English
detection. It cannot be broken with the word pattern attack that worked on the
simple substitution cipher. It was possibly first described in 1553 by Italian
cryptographer Giovan Battista Bellaso (though it has been reinvented many
times, including by Blaise de Vigenère). It is thought to have remained
unbroken until Charles Babbage, considered to be the father of computers, broke
it in the 19<sup>th</sup> century. It was called “le chiffre indéchiffrable”,
French for “the indecipherable cipher”.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr style='height:176.15pt'>
  <td width=344 valign=top style='width:257.7pt;padding:0in 5.4pt 0in 5.4pt;
  height:176.15pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=166
  height=214 id="Picture 106" src="chapter19_files/image002.jpg"></p>
  </td>
  <td width=247 valign=top style='width:185.1pt;padding:0in 5.4pt 0in 5.4pt;
  height:176.15pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=190
  height=219 id="Picture 112" src="chapter19_files/image003.jpg"></p>
  </td>
 </tr>
 <tr style='height:32.45pt'>
  <td width=344 valign=top style='width:257.7pt;padding:0in 5.4pt 0in 5.4pt;
  height:32.45pt'>
  <p class=FigureCaptionCxSpFirst>Figure 19-1. Blaise de Vigenère</p>
  <p class=FigureCaptionCxSpMiddle>April 5, 1523 - 1596</p>
  </td>
  <td width=247 valign=top style='width:185.1pt;padding:0in 5.4pt 0in 5.4pt;
  height:32.45pt'>
  <p class=FigureCaptionCxSpMiddle>Figure 19-2. Charles Babbage</p>
  <p class=FigureCaptionCxSpLast>December 26, 1791 - October 18, 1871</p>
  </td>
 </tr>
</table>

<h2><a name="_Toc353630881">Multiple “Keys” in the Vigenère Key</a></h2>

<p class=MsoNormal>The Vigenère cipher is similar to the Caesar cipher, except
with multiple keys. Because it uses more than one set of substitutions, it is
also called a <span class=Definition><span style='font-size:12.0pt;line-height:
115%'>polyalphabetic substitution cipher</span></span>. Remember that the Caesar
cipher had a key from 0 to 25. For the Vigenère cipher, instead of using a
numeric key, we will use a letter key. The letter A will be used for key 0. The
letter B will be used for key 1, and so on up to Z for the key 25.</p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr style='height:13.1pt'>
  <td width=29 valign=top style='width:21.85pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>0</p>
  </td>
  <td width=28 valign=top style='width:21.15pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>1</p>
  </td>
  <td width=28 valign=top style='width:21.15pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>2</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>3</p>
  </td>
  <td width=27 valign=top style='width:20.45pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>4</p>
  </td>
  <td width=26 valign=top style='width:19.75pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>5</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>6</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>7</p>
  </td>
  <td width=25 valign=top style='width:19.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>8</p>
  </td>
  <td width=25 valign=top style='width:19.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>9</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>10</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>11</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>12</p>
  </td>
 </tr>
 <tr style='height:13.1pt'>
  <td width=29 valign=top style='width:21.85pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>A</p>
  </td>
  <td width=28 valign=top style='width:21.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>B</p>
  </td>
  <td width=28 valign=top style='width:21.15pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>C</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>D</p>
  </td>
  <td width=27 valign=top style='width:20.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>E</p>
  </td>
  <td width=26 valign=top style='width:19.75pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>F</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>G</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>H</p>
  </td>
  <td width=25 valign=top style='width:19.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>I</p>
  </td>
  <td width=25 valign=top style='width:19.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>J</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>K</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>L</p>
  </td>
  <td width=34 valign=top style='width:25.45pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:13.1pt'>
  <p class=TableListing>M</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>13</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>14</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>15</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>16</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>17</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>18</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>19</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>20</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>21</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>22</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>23</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>24</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>25</p>
  </td>
 </tr>
 <tr>
  <td width=29 valign=top style='width:21.8pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>N</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>O</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>P</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Q</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>R</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>S</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>T</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>U</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>V</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>W</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>X</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Y</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Z</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The key in a Vigenère cipher is a series of letters, such as
a single English word. <strong>This single word key will be split into multiple
subkeys.</strong> If we use a Vigenère key of “PIZZA”, then the first subkey is
P, the second subkey is I, the third and fourth subkeys are both Z and the
fifth subkey is A. We will use the first subkey to encrypt the first letter of
the plaintext, and the second subkey to encrypt the second letter, and so on.
When we get to the sixth letter of the plaintext, we will go back to using the <em>first</em>
subkey.</p>

<p class=MsoNormal><strong>The Vigenère cipher is the same as using multiple
Caesar ciphers in the same message.</strong></p>

<p class=FigureCaption>Figure 19-3. Multiple Caesar ciphers combine to make the
Vigenère cipher</p>

<p class=MsoNormal align=center style='text-align:center'><img width=523
height=125 id="Picture 14" src="chapter19_files/image004.jpg"></p>

<p class=MsoNormal>The following shows which subkey will encrypt which letters
in the message, “Common sense is not so common.” with the Vigenère key,
“PIZZA”.</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>COMMONSENSEISNOTSOCOMMON</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>PIZZAPIZZAPIZZAPIZZAPIZZ</p>

</div>

<p class=MsoNormal>To encrypt the first C with the subkey P, encrypt it with
the Caesar cipher using numeric key 15 (15 is the number for the letter P)
which creates the ciphertext R, and so on. Do this for each of the letters of
the plaintext. The following table shows this process:</p>

<p class=TableCaption>Table 19-1. Numbers of the letters before and after
encryption.</p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Plaintext Letter</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Subkey</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>&nbsp;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Ciphertext Letter</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>C (2)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>P (15)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>R (17)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>I (8)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>W (22)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>M (12)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>L (11)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>M (12)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>L (11)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>A (0)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>N (13)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>P (15)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>C (2)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>S (18)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>I (8)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>A (0)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>E (4)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>D (3)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>N (13)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>M (12)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>S (18)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>A (0)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>S (18)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>E (4)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>P (15)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>T (19)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>I (8)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>I (8)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Q (16)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>S (18)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>R (17)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>N (13)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>M (12)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>A (0)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>T (19)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>P (15)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>I (8)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>S (18)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>I (8)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>A (0)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>N (13)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>C (2)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>B (1)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>A (0)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>M (12)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>P (15)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>B (1)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>M (12)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>I (8)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>U (20)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>O (14)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>N (13)</p>
  </td>
 </tr>
 <tr>
  <td width=73 valign=top style='width:54.9pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>N (13)</p>
  </td>
  <td width=61 valign=top style='width:45.7pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>Z (25)</p>
  </td>
  <td width=29 valign=top style='width:21.8pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>&#8594;</p>
  </td>
  <td width=82 valign=top style='width:61.55pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>M (12)</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>So using the Vigenère cipher with the key “PIZZA” (which is
made up of the subkeys 15, 8, 25, 25, 0) the plaintext “Common sense is not so
common.” becomes the ciphertext “Rwlloc admst qr moi an bobunm.”</p>

<p class=MsoNormal>The more letters in the Vigenère key, the stronger the
encrypted message will be against a brute-force attack. The choice of “PIZZA”
is a poor one for a Vigenère key, because it only has five letters. A key with
only five letters has 11,881,376 possible combinations. (26 ^ 5 = 26 × 26 × 26 ×
26 × 26 = 11,881,376) Eleven million keys is far too many for a human to try
out, but a computer could try them all in a few hours. It would first try to
decrypt the message with the key “AAAAA” and check if the resulting decryption
was in English. Then it could try “AAAAB”, then “AAAAC”, until it got to
“PIZZA”.</p>

<p class=MsoNormal>The good news is that for every additional letter the key
has, the number of possible keys multiplies by 26. Once there are quadrillions
of possible keys, it would take a computer years to break. Table 19-2 shows how
many possible keys there are for each length:</p>

<p class=TableCaption>Table 19-2. Number of possible keys based on Vigenère key
length.</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=97 valign=top style='width:72.9pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Key Length</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Equation</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Possible Keys</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>1</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 26</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>2</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>26 × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 676</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>3</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>676 × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 17,576</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>4</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>17,576 × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 456,976</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>5</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>456,976 × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 11,881,376</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>6</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>11,881,376 × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 308,915,776</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>7</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>308,915,776 × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 8,031,810,176</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>8</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>8,031,810,176 × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 208,827,064,576</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>9</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>208,827,064,576 × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 5,429,503,678,976</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>10</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>5,429,503,678,976 ×
  26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 141,167,095,653,376</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>11</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>141,167,095,653,376 ×
  26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 3,670,344,486,987,776</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>12</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>3,670,344,486,987,776
  × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 95,428,956,661,682,176</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>13</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>95,428,956,661,682,176
  × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 2,481,152,873,203,736,576</p>
  </td>
 </tr>
 <tr>
  <td width=97 valign=top style='width:72.9pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>14</p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>2,481,152,873,203,736,576
  × 26</p>
  </td>
  <td width=271 valign=top style='width:203.4pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing align=left style='text-align:left'>= 64,509,974,703,297,150,976</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>Once we get to keys that are twelve or more letters long,
then it becomes impossible for most consumer laptops to crack in a reasonable
amount of time.</p>

<p class=MsoNormal>A Vigenère key does not have to be a word like “PIZZA”. It
can be any combination of letters, such as “DURIWKNMFICK”. In fact, it is much
better not to use a word that can be found in the dictionary. The word “RADIOLOGISTS”
is a 12-letter key that is easier to remember than “DURIWKNMFICK” even though
they have the same number of letters. But a cryptanalyst might anticipate that
the cryptographer is being lazy by using an English word for the Vigenère key.
There are 95,428,956,661,682,176 possible 12-letter keys, but there are only
about 1,800 12-letter words in our dictionary file. If you are using a
12-letter English word, it would be easier to brute-force that ciphertext than
it would be to brute-force the ciphertext from a 3-letter random key.</p>

<p class=MsoNormal>Of course, the cryptographer is helped by the fact that the
cryptanalyst does not know how many letters long the Vigenère key is. But the
cryptanalyst could try all 1-letter keys, then all 2-letter keys, and so on.</p>

<h2><a name="_Toc353630882">Source Code of Vigenère Cipher Program</a></h2>

<p class=MsoNormal>Open a new file editor window by clicking on <strong>File</strong>
&#9658; <strong>New Window</strong>. Type in the following code into the file
editor, and then save it as <span class=Filename>vigenereCipher.py</span>.
Press <strong>F5</strong> to run the program. Note that first you will need to
download the <span class=Filename>pyperclip.py</span> module and place this
file in the same directory as the <span class=Filename>vigenereCipher.py</span>
file. You can download this file from <span class=URL><u>http://invpy.com/pyperclip.py</u></span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for vigenereCipher.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 1.</span> <span
class=SourceCodeComment># Vigenere Cipher (Polyalphabetic Substitution Cipher)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 4.</span>
import pyperclip</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 6.</span>
LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 7. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9.</span>    
<span class=SourceCodeComment># This text can be copy/pasted from
http://invpy.com/vigenereCipher.py</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>    
myMessage = &quot;&quot;&quot;Alan Mathison Turing was a British mathematician,
logician, cryptanalyst, and computer scientist. He was highly influential in
the development of computer science, providing a formalisation of the concepts
of &quot;algorithm&quot; and &quot;computation&quot; with the Turing machine.
Turing is widely considered to be the father of computer science and artificial
intelligence. During World War II, Turing worked for the Government Code and
Cypher School (GCCS) at Bletchley Park, Britain's codebreaking centre. For a
time he was head of Hut 8, the section responsible for German naval
cryptanalysis. He devised a number of techniques for breaking German ciphers,
including the method of the bombe, an electromechanical machine that could find
settings for the Enigma machine. After the war he worked at the National Physical
Laboratory, where he created one of the first designs for a stored-program
computer, the ACE. In 1948 Turing joined Max Newman's Computing Laboratory at
Manchester University, where he assisted in the development of the Manchester
computers and became interested in mathematical biology. He wrote a paper on
the chemical basis of morphogenesis, and predicted oscillating chemical
reactions such as the Belousov-Zhabotinsky reaction, which were first observed
in the 1960s. Turing's homosexuality resulted in a criminal prosecution in
1952, when homosexual acts were still illegal in the United Kingdom. He
accepted treatment with female hormones (chemical castration) as an alternative
to prison. Turing died in 1954, just over two weeks before his 42nd birthday, from
cyanide poisoning. An inquest determined that his death was suicide; his mother
and some others believed his death was accidental. On 10 September 2009,
following an Internet campaign, British Prime Minister Gordon Brown made an
official public apology on behalf of the British government for &quot;the
appalling way he was treated.&quot; As of May 2012 a private member's bill was
before the House of Lords which would grant Turing a statutory pardon if
enacted.&quot;&quot;&quot;</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.</span>    
myKey = 'ASIMOV'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>12.</span>    
myMode = 'encrypt' <span class=SourceCodeComment># set to 'encrypt' or
'decrypt'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>13. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span>    
if myMode == 'encrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15.</span>        
translated = encryptMessage(myKey, myMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16.</span>    
elif myMode == 'decrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17.</span>        
translated = decryptMessage(myKey, myMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>    
print('%sed message:' % (myMode.title()))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>    
print(translated)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21.</span>    
pyperclip.copy(translated)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22.</span>    
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>23.</span>    
print('The message has been copied to the clipboard.')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>24. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>25. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>26.</span>
def encryptMessage(key, message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>27.</span>    
return translateMessage(key, message, 'encrypt')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>28. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>29. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>30.</span>
def decryptMessage(key, message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>31.</span>    
return translateMessage(key, message, 'decrypt')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>32. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>33. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>34.</span>
def translateMessage(key, message, mode):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>35.</span>    
translated = [] <span class=SourceCodeComment># stores the encrypted/decrypted
message string</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>36. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>37.</span>    
keyIndex = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>38.</span>    
key = key.upper()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>39. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>40.</span>    
for symbol in message: <span class=SourceCodeComment># loop through each
character in message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>41.</span>        
num = LETTERS.find(symbol.upper())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>42.</span>        
if num != -1: <span class=SourceCodeComment># -1 means symbol.upper() was not
found in LETTERS</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>43.</span>            
if mode == 'encrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>44.</span>                
num += LETTERS.find(key[keyIndex]) <span class=SourceCodeComment># add if
encrypting</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>45.</span>            
elif mode == 'decrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>46.</span>                
num -= LETTERS.find(key[keyIndex]) <span class=SourceCodeComment># subtract if
decrypting</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>47. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>48.</span>            
num %= len(LETTERS) <span class=SourceCodeComment># handle the potential wrap-around</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>49. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>50.</span>            
<span class=SourceCodeComment># add the encrypted/decrypted symbol to the end
of translated.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>51.</span>            
if symbol.isupper():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>52.</span>                
translated.append(LETTERS[num])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>53.</span>           
 elif symbol.islower():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>54.</span>                
translated.append(LETTERS[num].lower())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>55. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>56.</span>            
keyIndex += 1 <span class=SourceCodeComment># move to the next letter in the
key</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>57.</span>            
if keyIndex == len(key):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>58.</span>                
keyIndex = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>59.</span>        
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>60.</span>    
        <span class=SourceCodeComment># The symbol was not in LETTERS, so add
it to translated as is.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>61.</span>            
translated.append(symbol)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>62. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>63.</span>    
return ''.join(translated)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>64. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>65. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>66.</span> <span
class=SourceCodeComment># If vigenereCipher.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>67.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>68.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>69.</span>    
main()</p>

</div>

<h2><a name="_Toc353630883">Sample Run of the Vigenère Cipher Program</a></h2>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Encrypted message:</p>

<p class=SampleRunCxSpMiddle>Adiz Avtzqeci Tmzubb wsa m Pmilqev halpqavtakuoi,
lgouqdaf, kdmktsvmztsl, izr xoexghzr kkusitaaf. Vz wsa twbhdg ubalmmzhdad qz
hce vmhsgohuqbo ox kaakulmd gxiwvos, krgdurdny i rcmmstugvtawz ca tzm ocicwxfg
jf &quot;stscmilpy&quot; oid </p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle><em><span style='font-family:"Lucida Sans Typewriter"'>...skipped
for brevity...</span></em></p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>uiydviyv, Nfdtaat Dmiem Ywiikbqf Bojlab Wrgez avdw
iz cafakuog pmjxwx ahwxcby gv nscadn at ohw Jdwoikp scqejvysit xwd &quot;hce
sxboglavs kvy zm ion tjmmhzd.&quot; Sa at Haq 2012 i bfdvsbq azmtmd'g widt ion
bwnafz tzm Tcpsw wr Zjrva ivdcz eaigd yzmbo Tmzubb a kbmhptgzk dvrvwz wa
efiohzd.</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpLast>The message has been copied to the clipboard.</p>

</div>

<h2><a name="_Toc353630884">How the Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 1.</span> <span
class=SourceCodeComment># Vigenere Cipher (Polyalphabetic Substitution Cipher)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 4.</span>
import pyperclip</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 5. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 6.</span>
LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</p>

</div>

<p class=MsoNormal>The beginning of the program has the usual comments to
describe the program, an <span class=Literal>import</span> statement for the <span
class=Literal>pyperclip</span> module, and creates a variable called <span
class=Literal>LETTERS</span> with a string of every uppercase letter.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 8.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9.</span>    
<span class=SourceCodeComment># This text can be copy/pasted from
http://invpy.com/vigenereCipher.py</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>    
myMessage = &quot;&quot;&quot;Alan Mathison Turing was a British mathematician,
</p>

<p class=SourceCodeFeaturedCxSpMiddle>&nbsp;</p>

<p class=SourceCodeFeaturedCxSpMiddle>        <span class=SourceCodeComment><i>...skipped
for brevity...</i></span></p>

<p class=SourceCodeFeaturedCxSpMiddle>&nbsp;</p>

<p class=SourceCodeFeaturedCxSpMiddle>grant Turing a statutory pardon if enacted.&quot;&quot;&quot;</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.</span>    
myKey = 'ASIMOV'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>12.</span>    
myMode = 'encrypt' <span class=SourceCodeComment># set to 'encrypt' or
'decrypt'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>13. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span>    
if myMode == 'encrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15.</span>        
translated = encryptMessage(myKey, myMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16.</span>    
elif myMode == 'decrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17.</span>        
translated = decryptMessage(myKey, myMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>    
print('%sed message:' % (myMode.title()))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>    
print(translated)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21.</span>    
pyperclip.copy(translated)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22.</span>    
print()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>23.</span>    
print('The message has been copied to the clipboard.')</p>

</div>

<p class=MsoNormal>The <span class=Literal>main()</span> function for the Vigenère
cipher is exactly like the other <span class=Literal>main()</span> functions in
this book: there are variables for <span class=Literal>message</span>, <span
class=Literal>key</span>, and <span class=Literal>mode</span>. The user sets these
variables on lines 10, 11, and 12 before running the program. The encrypted or
decrypted message (depending on what <span class=Literal>myMode</span> is set
to) is stored in a variable named <span class=Literal>translated</span> so that
it can be printed to the screen (on line 20) and copied to the clipboard (on
line 21).</p>

<p class=MsoNormal>The code that does the actual encryption and decryption is
in <span class=Literal>translateMessage()</span>, which is explained later.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>26.</span>
def encryptMessage(key, message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>27.</span>    
return translateMessage(key, message, 'encrypt')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>28. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>29. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>30.</span>
def decryptMessage(key, message):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>31.</span>     return
translateMessage(key, message, 'decrypt')</p>

</div>

<p class=MsoNormal>Since the encryption and decryption use much of the same
code as the other, we put them both in <span class=Literal>translateMessage()</span>.
The <span class=Literal>encryptMessage()</span> and <span class=Literal>decryptMessage()</span>
functions are wrapper functions for <span class=Literal>translateMessage()</span>.
(Wrapper functions were covered in Chapter 17.)</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>34.</span>
def translateMessage(key, message, mode):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>35.</span>    
translated = [] <span class=SourceCodeComment># stores the encrypted/decrypted
message string</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>36. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>37.</span>    
keyIndex = 0</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>38.</span>    
key = key.upper()</p>

</div>

<p class=MsoNormal>In the <span class=Literal>translateMessage()</span>
function, we will slowly build the encrypted (or decrypted) string one
character at a time. The list in <span class=Literal>translated</span> will
store these characters so that they can be joined together once the string
building is done. (The reason we use a list instead of just appending the
characters to a string is explained in the “Building Strings in Python with
Lists” section in Chapter 18.)</p>

<p class=MsoNormal>Remember, the Vigenère cipher is just the Caesar cipher
except that a different key is used depending on the position of the letter in
the message. The <span class=Literal>keyIndex</span> variable keeps track of
which subkey to use. The <span class=Literal>keyIndex</span> variable starts
off as <span class=Literal>0</span>, because the letter used to encrypt or decrypt
the first character of the message will be the one at <span class=Literal>key[0]</span>.</p>

<p class=MsoNormal>Our code assumes that the key has only uppercase letters. To
make sure the key is valid, line 38 sets the key to be the uppercase version of
it.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>40.</span>    
for symbol in message: <span class=SourceCodeComment># loop through each
character in message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>41.</span>        
num = LETTERS.find(symbol.upper())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>42.</span>        
if num != -1: <span class=SourceCodeComment># -1 means symbol.upper() was not
found in LETTERS</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>43.</span>            
if mode == 'encrypt':</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>44.</span>                
num += LETTERS.find(key[keyIndex]) <span class=SourceCodeComment># add if
encrypting</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>45.</span>      
      elif mode == 'decrypt':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>46.</span>                
num -= LETTERS.find(key[keyIndex]) <span class=SourceCodeComment># subtract if
decrypting</span></p>

</div>

<p class=MsoNormal>The rest of the code in <span class=Literal>translateMessage()</span>
is similar to the Caesar cipher code. The <span class=Literal>for</span> loop
on line 40 sets the characters in <span class=Literal>message</span> to the
variable <span class=Literal>symbol</span> on each iteration of the loop. On
line 41 we find the index of the uppercase version of this symbol in <span
class=Literal>LETTERS</span>. (This is how we translate a letter into a
number).</p>

<p class=MsoNormal>If <span class=Literal>num</span> was not set to <span
class=Literal>-1</span> on line 41, then the uppercase version of <span
class=Literal>symbol</span> was found in <span class=Literal>LETTERS</span>
(meaning that <span class=Literal>symbol</span> is a letter). The <span
class=Literal>keyIndex</span> variable keeps track of which subkey to use, and
the subkey itself will always be what <span class=Literal>key[keyIndex]</span>
evaluates to.</p>

<p class=MsoNormal>Of course, this is just a single letter string. We need to
find this letter’s index in the <span class=Literal>LETTERS</span> to convert
the subkey into an integer. This integer is then added (if encrypting) to the
symbol’s number on line 44 or subtracted (if decrypting) to the symbol’s number
on line 46.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>48.</span>            
num %= len(LETTERS) <span class=SourceCodeComment># handle the potential wrap-around</span></p>

</div>

<p class=MsoNormal>In the Caesar cipher code, we checked if the new value of <span
class=Literal>num</span> was less than <span class=Literal>0</span> (in which
case, we added <span class=Literal>len(LETTERS)</span> to it) or if the new
value of <span class=Literal>num</span> was <span class=Literal>len(LETTERS)</span>
or greater (in which case, we subtracted <span class=Literal>len(LETTERS)</span>
from it). This handles the “wrap-around” cases.</p>

<p class=MsoNormal>However, there is a simpler way that handles both of these
cases. If we mod the integer stored in num by <span class=Literal>len(LETTERS)</span>,
then this will do the exact same thing except in a single line of code.</p>

<p class=MsoNormal>For example, if <span class=Literal>num</span> was <span
class=Literal>-8</span> we would want to add <span class=Literal>26</span>
(that is, <span class=Literal>len(LETTERS)</span>) to it to get <span
class=Literal>18</span>. Or if <span class=Literal>num</span> was <span
class=Literal>31</span> we would want to subtract <span class=Literal>26</span>
to get <span class=Literal>5</span>. However <span class=Literal>-8 % 26</span>
evaluates to <span class=Literal>18</span> and <span class=Literal>31 % 26</span>
evaluates to <span class=Literal>5</span>. The modular arithmetic on line 48
handles both “wrap-around” cases for us.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>50.</span>            
<span class=SourceCodeComment># add the encrypted/decrypted symbol to the end
of translated.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>51.</span>            
if symbol.isupper():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>52.</span>                
translated.append(LETTERS[num])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>53.</span>            
elif symbol.islower():</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>54.</span>                
translated.append(LETTERS[num].lower())</p>

</div>

<p class=MsoNormal>The encrypted (or decrypted) character exists at <span
class=Literal>LETTERS[num]</span>. However, we want the encrypted (or
decrypted) character’s case to match <span class=Literal>symbol</span>’s
original case. So if <span class=Literal>symbol</span> is an uppercase letter,
the condition on line 51 will be <span class=Literal>True</span> and line 52
will append the character at <span class=Literal>LETTERS[num]</span> to <span
class=Literal>translated</span>. (Remember, all the characters in the <span
class=Literal>LETTERS</span> string are already uppercase.)</p>

<p class=MsoNormal>However, if <span class=Literal>symbol</span> is a lowercase
letter, than the condition on line 53 will be <span class=Literal>True</span>
instead and line 54 will append the lowercase form of <span class=Literal>LETTERS[num]</span>
to <span class=Literal>translated</span> instead. This is how we can get the
encrypted (or decrypted) message to match the casing of the original message.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>56.</span>            
keyIndex += 1 <span class=SourceCodeComment># move to the next letter in the
key</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>57.</span>            
if keyIndex == len(key):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>58.</span>                
keyIndex = 0</p>

</div>

<p class=MsoNormal>Now that we have translated the symbol, we want to make sure
that on the next iteration of the <span class=Literal>for</span> loop we use
the next subkey. Line 56 increments <span class=Literal>keyIndex</span> by one.
This way when the next iteration uses <span class=Literal>key[keyIndex]</span>
to get the subkey, it will be the index to the next subkey.</p>

<p class=MsoNormal>However, if we were on the last subkey in the key, then <span
class=Literal>keyIndex</span> would be equal to the length of key. Line 57
checks for this condition, and resets <span class=Literal>keyIndex</span> back
to <span class=Literal>0</span> on line 58. That way <span class=Literal>key[keyIndex]</span>
will point back to the first subkey.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>59.</span>        
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>60.</span>            
<span class=SourceCodeComment># The symbol was not in LETTERS, so add it to
translated as is.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>61.</span>            
translated.append(symbol)</p>

</div>

<p class=MsoNormal>From the indentation you can tell that the <span
class=Literal>else</span> statement on line 59 is paired with the <span
class=Literal>if</span> statement on line 42. The code on line 61 executes if
the symbol was not found in the <span class=Literal>LETTERS</span> string. This
happens if <span class=Literal>symbol</span> is a number or punctuation mark
such as <span class=Literal>'5'</span> or <span class=Literal>'?'</span>. In
this case, line 61 will just append the symbol untranslated.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>63.</span>     return
''.join(translated)</p>

</div>

<p class=MsoNormal>Now that we are done building the string in <span
class=Literal>translated</span>, we call the <span class=Literal>join()</span>
method on the blank string to join together all the strings in <span
class=Literal>translated</span> (with a blank in between them).</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereCipher.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>66.</span> <span
class=SourceCodeComment># If vigenereCipher.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>67.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>68.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>69.</span>    
main()</p>

</div>

<p class=MsoNormal>Lines 68 and 69 call the <span class=Literal>main()</span>
function if this program was run by itself, rather than imported by another
program that wants to use its <span class=Literal>encryptMessage()</span> and <span
class=Literal>decryptMessage()</span> functions.</p>

<h2><a name="_Toc353630885">Summary</a></h2>

<p class=MsoNormal>We are close to the end of the book, but notice how the
Vigenère cipher isn’t that much more complicated than the second cipher program
in this book, the Caesar cipher. With just a few changes, we can create a
cipher that has exponentially many more possible keys than can be brute-forced.</p>

<p class=MsoNormal>The Vigenère cipher is not vulnerable to the dictionary word
pattern attack that our Simple Substitution hacker program uses. The
“indecipherable cipher” kept secret messages secret for hundreds of years. The
attack on the Vigenère cipher was not widely known until the early 20<sup>th</sup>
century. But of course, this cipher too eventually fell. In the next couple of
chapters, we will learn new “frequency analysis” techniques to hack the Vigenère
cipher.</p>

</div>

</body>

</html>
